<!DOCTYPE html>

<HTML><head><TITLE>Manpage of SUDOERS</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux manpages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content"><div class="wrap">
<H1>SUDOERS</H1>
Section: MAINTENANCE COMMANDS (5)<BR>Updated: January 12, 2011<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>











<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>


sudoers - list of which users may execute what
<A NAME="lbAC">&nbsp;</A>
<H2>DESCRIPTION</H2>


<A NAME="ixAAC"></A>

The <I>sudoers</I> file is composed of two types of entries: aliases
(basically variables) and user specifications (which specify who
may run what).
<P>


When multiple entries match for a user, they are applied in order.
Where there are multiple matches, the last match is used (which is
not necessarily the most specific match).
<P>


The <I>sudoers</I> grammar will be described below in Extended Backus-Naur
Form (<FONT SIZE="-1">EBNF</FONT>).  Don't despair if you don't know what <FONT SIZE="-1">EBNF</FONT> is; it is
fairly simple, and the definitions below are annotated.
<A NAME="lbAD">&nbsp;</A>
<H3>Quick guide to <FONT SIZE="-1">EBNF</FONT></H3>


<A NAME="ixAAD"></A>

<FONT SIZE="-1">EBNF</FONT> is a concise and exact way of describing the grammar of a language.
Each <FONT SIZE="-1">EBNF</FONT> definition is made up of <I>production rules</I>.  E.g.,
<P>




<PRE>

 symbol ::= definition | alternate1 | alternate2 ...

</PRE>



<P>


Each <I>production rule</I> references others and thus makes up a
grammar for the language.  <FONT SIZE="-1">EBNF</FONT> also contains the following
operators, which many readers will recognize from regular
expressions.  Do not, however, confuse them with ``wildcard''
characters, which have different meanings.
<DL COMPACT>
<DT>
?<BR>

<DD>




<A NAME="ixAAE"></A>

Means that the preceding symbol (or group of symbols) is optional.
That is, it may appear once or not at all.
<DT>
*<BR>

<DD>




<A NAME="ixAAF"></A>

Means that the preceding symbol (or group of symbols) may appear
zero or more times.
<DT>
+<BR>

<DD>




<A NAME="ixAAG"></A>

Means that the preceding symbol (or group of symbols) may appear
one or more times.
</DL>
<P>


Parentheses may be used to group symbols together.  For clarity,
we will use single quotes ('') to designate what is a verbatim character
string (as opposed to a symbol name).
<A NAME="lbAE">&nbsp;</A>
<H3>Aliases</H3>


<A NAME="ixAAH"></A>

There are four kinds of aliases: <TT>
User_Alias<BR>

</TT>, <TT>
Runas_Alias<BR>

</TT>,
<TT>
Host_Alias<BR>

</TT> and <TT>
Cmnd_Alias<BR>

</TT>.
<P>




<PRE>

 Alias ::= 'User_Alias'  User_Alias (':' User_Alias)* |
           'Runas_Alias' Runas_Alias (':' Runas_Alias)* |
           'Host_Alias'  Host_Alias (':' Host_Alias)* |
           'Cmnd_Alias'  Cmnd_Alias (':' Cmnd_Alias)*

 User_Alias ::= NAME '=' User_List

 Runas_Alias ::= NAME '=' Runas_List

 Host_Alias ::= NAME '=' Host_List

 Cmnd_Alias ::= NAME '=' Cmnd_List

 NAME ::= [A-Z]([A-Z][0-9]_)*

</PRE>



<P>


Each <I>alias</I> definition is of the form
<P>




<PRE>

 Alias_Type NAME = item1, item2, ...

</PRE>



<P>


where <I>Alias_Type</I> is one of <TT>
User_Alias<BR>

</TT>, <TT>
Runas_Alias<BR>

</TT>, <TT>
Host_Alias<BR>

</TT>,
or <TT>
Cmnd_Alias<BR>

</TT>.  A <TT>
NAME<BR>

</TT> is a string of uppercase letters, numbers,
and underscore characters ('_').  A <TT>
NAME<BR>

</TT> <B>must</B> start with an
uppercase letter.  It is possible to put several alias definitions
of the same type on a single line, joined by a colon (':').  E.g.,
<P>




<PRE>

 Alias_Type NAME = item1, item2, item3 : NAME = item4, item5

</PRE>



<P>


The definitions of what constitutes a valid <I>alias</I> member follow.
<P>




<PRE>

 User_List ::= User |
               User ',' User_List

 User ::= '!'* user name |
          '!'* '#'uid |
          '!'* '%'group |
          '!'* '+'netgroup |
          '!'* '%:'nonunix_group |
          '!'* User_Alias

</PRE>



<P>


A <TT>
User_List<BR>

</TT> is made up of one or more user names, uids (prefixed
with '#'), system groups (prefixed with '%'), netgroups (prefixed
with '+') and <TT>
User_Alias<BR>

</TT>es.  Each list item may be prefixed with
zero or more '!' operators.  An odd number of '!' operators negate
the value of the item; an even number just cancel each other out.
<P>


A <TT>
user name<BR>

</TT>, <TT>
group<BR>

</TT>, <TT>
netgroup<BR>

</TT> or <TT>
nonunix_group<BR>

</TT> may
be enclosed in double quotes to avoid the need for escaping special
characters.  Alternately, special characters may be specified in
escaped hex mode, e.g. \x20 for space.
<P>


The <TT>
nonunix_group<BR>

</TT> syntax depends on the underlying implementation.
For instance, the <FONT SIZE="-1">QAS</FONT> <FONT SIZE="-1">AD</FONT> backend supports the following formats:
<DL COMPACT>
<DT>*<DD>

Group in the same domain: ``Group Name''
<DT>*<DD>

Group in any domain: ``Group <A HREF="mailto:Name@FULLY.QUALIFIED.DOMAIN">Name@FULLY.QUALIFIED.DOMAIN</A>''
<DT>*<DD>

Group <FONT SIZE="-1">SID:</FONT> ``S-1-2-34-5678901234-5678901234-5678901234-567''
</DL>
<P>


Note that quotes around group names are optional.  Unquoted strings must
use a backslash (\) to escape spaces and the '@' symbol.
<P>




<PRE>

 Runas_List ::= Runas_Member |
                Runas_Member ',' Runas_List

 Runas_Member ::= '!'* user name |
                  '!'* '#'uid |
                  '!'* '%'group |
                  '!'* +netgroup |
                  '!'* Runas_Alias

</PRE>



<P>


A <TT>
Runas_List<BR>

</TT> is similar to a <TT>
User_List<BR>

</TT> except that instead
of <TT>
User_Alias<BR>

</TT>es it can contain <TT>
Runas_Alias<BR>

</TT>es.  Note that
user names and groups are matched as strings.  In other words, two
users (groups) with the same uid (gid) are considered to be distinct.
If you wish to match all user names with the same uid (e.g.&nbsp;root
and toor), you can use a uid instead (#0 in the example given).
<P>




<PRE>

 Host_List ::= Host |
               Host ',' Host_List

 Host ::= '!'* host name |
          '!'* ip_addr |
          '!'* network(/netmask)? |
          '!'* '+'netgroup |
          '!'* Host_Alias

</PRE>



<P>


A <TT>
Host_List<BR>

</TT> is made up of one or more host names, <FONT SIZE="-1">IP</FONT> addresses,
network numbers, netgroups (prefixed with '+') and other aliases.
Again, the value of an item may be negated with the '!' operator.
If you do not specify a netmask along with the network number,
<B>sudo</B> will query each of the local host's network interfaces and,
if the network number corresponds to one of the hosts's network
interfaces, the corresponding netmask will be used.  The netmask
may be specified either in standard <FONT SIZE="-1">IP</FONT> address notation
(e.g.&nbsp;255.255.255.0 or ffff:ffff:ffff:ffff::),
or <FONT SIZE="-1">CIDR</FONT> notation (number of bits, e.g.&nbsp;24 or 64).  A host name may
include shell-style wildcards (see the Wildcards section below),
but unless the <TT>
host name<BR>

</TT> command on your machine returns the fully
qualified host name, you'll need to use the <I>fqdn</I> option for
wildcards to be useful.  Note <B>sudo</B> only inspects actual network
interfaces; this means that <FONT SIZE="-1">IP</FONT> address 127.0.0.1 (localhost) will
never match.  Also, the host name ``localhost'' will only match if
that is the actual host name, which is usually only the case for
non-networked systems.
<P>




<PRE>

 Cmnd_List ::= Cmnd |
               Cmnd ',' Cmnd_List

 commandname ::= file name |
                 file name args |
                 file name '&quot;&quot;'

 Cmnd ::= '!'* commandname |
          '!'* directory |
          '!'* &quot;sudoedit&quot; |
          '!'* Cmnd_Alias

</PRE>



<P>


A <TT>
Cmnd_List<BR>

</TT> is a list of one or more commandnames, directories, and other
aliases.  A commandname is a fully qualified file name which may include
shell-style wildcards (see the Wildcards section below).  A simple
file name allows the user to run the command with any arguments he/she
wishes.  However, you may also specify command line arguments (including
wildcards).  Alternately, you can specify <TT>&quot;&quot;</TT> to indicate that the command
may only be run <B>without</B> command line arguments.  A directory is a
fully qualified path name ending in a '/'.  When you specify a directory
in a <TT>
Cmnd_List<BR>

</TT>, the user will be able to run any file within that directory
(but not in any subdirectories therein).
<P>


If a <TT>
Cmnd<BR>

</TT> has associated command line arguments, then the arguments
in the <TT>
Cmnd<BR>

</TT> must match exactly those given by the user on the command line
(or match the wildcards if there are any).  Note that the following
characters must be escaped with a '\' if they are used in command
arguments: ',', ':', '=', '\'.  The special command <TT>&quot;sudoedit&quot;</TT>
is used to permit a user to run <B>sudo</B> with the <B>-e</B> option (or
as <B>sudoedit</B>).  It may take command line arguments just as
a normal command does.
<A NAME="lbAF">&nbsp;</A>
<H3>Defaults</H3>


<A NAME="ixAAI"></A>

Certain configuration options may be changed from their default
values at runtime via one or more <TT>
Default_Entry<BR>

</TT> lines.  These
may affect all users on any host, all users on a specific host, a
specific user, a specific command, or commands being run as a specific user.
Note that per-command entries may not include command line arguments.
If you need to specify arguments, define a <TT>
Cmnd_Alias<BR>

</TT> and reference
that instead.
<P>




<PRE>

 Default_Type ::= 'Defaults' |
                  'Defaults' '@' Host_List |
                  'Defaults' ':' User_List |
                  'Defaults' '!' Cmnd_List |
                  'Defaults' '&gt;' Runas_List

 Default_Entry ::= Default_Type Parameter_List

 Parameter_List ::= Parameter |
                    Parameter ',' Parameter_List

 Parameter ::= Parameter '=' Value |
               Parameter '+=' Value |
               Parameter '-=' Value |
               '!'* Parameter

</PRE>



<P>


Parameters may be <B>flags</B>, <B>integer</B> values, <B>strings</B>, or <B>lists</B>.
Flags are implicitly boolean and can be turned off via the '!'
operator.  Some integer, string and list parameters may also be
used in a boolean context to disable them.  Values may be enclosed
in double quotes (<TT>
&quot;<BR>

</TT>) when they contain multiple words.  Special
characters may be escaped with a backslash (<TT>
\<BR>

</TT>).
<P>


Lists have two additional assignment operators, <TT>
+=<BR>

</TT> and <TT>
-=<BR>

</TT>.
These operators are used to add to and delete from a list respectively.
It is not an error to use the <TT>
-=<BR>

</TT> operator to remove an element
that does not exist in a list.
<P>


Defaults entries are parsed in the following order: generic, host
and user Defaults first, then runas Defaults and finally command
defaults.
<P>


See ``<FONT SIZE="-1">SUDOERS</FONT> <FONT SIZE="-1">OPTIONS</FONT>'' for a list of supported Defaults parameters.
<A NAME="lbAG">&nbsp;</A>
<H3>User Specification</H3>


<A NAME="ixAAJ"></A>



<PRE>

 User_Spec ::= User_List Host_List '=' Cmnd_Spec_List \
               (':' Host_List '=' Cmnd_Spec_List)*

 Cmnd_Spec_List ::= Cmnd_Spec |
                    Cmnd_Spec ',' Cmnd_Spec_List

 Cmnd_Spec ::= Runas_Spec? SELinux_Spec? Tag_Spec* Cmnd


 Runas_Spec ::= '(' Runas_List? (':' Runas_List)? ')'

 SELinux_Spec ::= ('ROLE=role' | 'TYPE=type')


 Tag_Spec ::= ('NOPASSWD:' | 'PASSWD:' | 'NOEXEC:' | 'EXEC:' |
               'SETENV:' | 'NOSETENV:' | 'LOG_INPUT:' | 'NOLOG_INPUT:' |
               'LOG_OUTPUT:' | 'NOLOG_OUTPUT:')

</PRE>



<P>


A <B>user specification</B> determines which commands a user may run
(and as what user) on specified hosts.  By default, commands are
run as <B>root</B>, but this can be changed on a per-command basis.
<P>


The basic structure of a user specification is `who = where (as_whom)
what'.  Let's break that down into its constituent parts:
<A NAME="lbAH">&nbsp;</A>
<H3>Runas_Spec</H3>


<A NAME="ixAAK"></A>

A <TT>
Runas_Spec<BR>

</TT> determines the user and/or the group that a command
may be run as.  A fully-specified <TT>
Runas_Spec<BR>

</TT> consists of two
<TT>
Runas_List<BR>

</TT>s (as defined above) separated by a colon (':') and
enclosed in a set of parentheses.  The first <TT>
Runas_List<BR>

</TT> indicates
which users the command may be run as via <B>sudo</B>'s <B>-u</B> option.
The second defines a list of groups that can be specified via
<B>sudo</B>'s <B>-g</B> option.  If both <TT>
Runas_List<BR>

</TT>s are specified, the
command may be run with any combination of users and groups listed
in their respective <TT>
Runas_List<BR>

</TT>s.  If only the first is specified,
the command may be run as any user in the list but no <B>-g</B> option
may be specified.  If the first <TT>
Runas_List<BR>

</TT> is empty but the
second is specified, the command may be run as the invoking user
with the group set to any listed in the <TT>
Runas_List<BR>

</TT>.  If no
<TT>
Runas_Spec<BR>

</TT> is specified the command may be run as <B>root</B> and
no group may be specified.
<P>


A <TT>
Runas_Spec<BR>

</TT> sets the default for the commands that follow it.
What this means is that for the entry:
<P>




<PRE>

 dgb    boulder = (operator) /bin/ls, /bin/kill, /usr/bin/lprm

</PRE>



<P>


The user <B>dgb</B> may run <I>/bin/ls</I>, <I>/bin/kill</I>, and
<I>/usr/bin/lprm</I> --- but only as <B>operator</B>.  E.g.,
<P>




<PRE>

 $ sudo -u operator /bin/ls.

</PRE>



<P>


It is also possible to override a <TT>
Runas_Spec<BR>

</TT> later on in an
entry.  If we modify the entry like so:
<P>




<PRE>

 dgb    boulder = (operator) /bin/ls, (root) /bin/kill, /usr/bin/lprm

</PRE>



<P>


Then user <B>dgb</B> is now allowed to run <I>/bin/ls</I> as <B>operator</B>,
but  <I>/bin/kill</I> and <I>/usr/bin/lprm</I> as <B>root</B>.
<P>


We can extend this to allow <B>dgb</B> to run <TT>
/bin/ls<BR>

</TT> with either
the user or group set to <B>operator</B>:
<P>




<PRE>

 dgb    boulder = (operator : operator) /bin/ls, (root) /bin/kill, \
        /usr/bin/lprm

</PRE>



<P>


In the following example, user <B>tcm</B> may run commands that access
a modem device file with the dialer group.  Note that in this example
only the group will be set, the command still runs as user <B>tcm</B>.
<P>




<PRE>

 tcm    boulder = (:dialer) /usr/bin/tip, /usr/bin/cu, \
        /usr/local/bin/minicom

</PRE>



<A NAME="lbAI">&nbsp;</A>
<H3>SELinux_Spec</H3>


<A NAME="ixAAL"></A>

On systems with SELinux support, <I>sudoers</I> entries may optionally have
an SELinux role and/or type associated with a command.  If a role or
type is specified with the command it will override any default values
specified in <I>sudoers</I>.  A role or type specified on the command line,
however, will supercede the values in <I>sudoers</I>.


<A NAME="lbAJ">&nbsp;</A>
<H3>Tag_Spec</H3>


<A NAME="ixAAM"></A>

A command may have zero or more tags associated with it.  There are
eight possible tag values, <TT>
NOPASSWD<BR>

</TT>, <TT>
PASSWD<BR>

</TT>, <TT>
NOEXEC<BR>

</TT>,
<TT>
EXEC<BR>

</TT>, <TT>
SETENV<BR>

</TT>, <TT>
NOSETENV<BR>

</TT>, <TT>
LOG_INPUT<BR>

</TT>, <TT>
NOLOG_INPUT<BR>

</TT>,
<TT>
LOG_OUTPUT<BR>

</TT> and <TT>
NOLOG_OUTPUT<BR>

</TT>.  Once a tag is set on a <TT>
Cmnd<BR>

</TT>,
subsequent <TT>
Cmnd<BR>

</TT>s in the <TT>
Cmnd_Spec_List<BR>

</TT>, inherit the tag unless
it is overridden by the opposite tag (i.e.: <TT>
PASSWD<BR>

</TT> overrides
<TT>
NOPASSWD<BR>

</TT> and <TT>
NOEXEC<BR>

</TT> overrides <TT>
EXEC<BR>

</TT>).
<P>


<I></I><FONT SIZE="-1"><I>NOPASSWD</I></FONT><I> and </I><FONT SIZE="-1"><I>PASSWD</I></FONT><I></I>
<A NAME="ixAAN"></A>

<P>


By default, <B>sudo</B> requires that a user authenticate him or herself
before running a command.  This behavior can be modified via the
<TT>
NOPASSWD<BR>

</TT> tag.  Like a <TT>
Runas_Spec<BR>

</TT>, the <TT>
NOPASSWD<BR>

</TT> tag sets
a default for the commands that follow it in the <TT>
Cmnd_Spec_List<BR>

</TT>.
Conversely, the <TT>
PASSWD<BR>

</TT> tag can be used to reverse things.
For example:
<P>




<PRE>

 ray    rushmore = NOPASSWD: /bin/kill, /bin/ls, /usr/bin/lprm

</PRE>



<P>


would allow the user <B>ray</B> to run <I>/bin/kill</I>, <I>/bin/ls</I>, and
<I>/usr/bin/lprm</I> as <B>root</B> on the machine rushmore without
authenticating himself.  If we only want <B>ray</B> to be able to
run <I>/bin/kill</I> without a password the entry would be:
<P>




<PRE>

 ray    rushmore = NOPASSWD: /bin/kill, PASSWD: /bin/ls, /usr/bin/lprm

</PRE>



<P>


Note, however, that the <TT>
PASSWD<BR>

</TT> tag has no effect on users who are
in the group specified by the <I>exempt_group</I> option.
<P>


By default, if the <TT>
NOPASSWD<BR>

</TT> tag is applied to any of the entries
for a user on the current host, he or she will be able to run
<TT>
sudo -l<BR>

</TT> without a password.  Additionally, a user may only run
<TT>
sudo -v<BR>

</TT> without a password if the <TT>
NOPASSWD<BR>

</TT> tag is present
for all a user's entries that pertain to the current host.
This behavior may be overridden via the verifypw and listpw options.
<P>


<I></I><FONT SIZE="-1"><I>NOEXEC</I></FONT><I> and </I><FONT SIZE="-1"><I>EXEC</I></FONT><I></I>
<A NAME="ixAAO"></A>

<P>


If <B>sudo</B> has been compiled with <I>noexec</I> support and the underlying
operating system supports it, the <TT>
NOEXEC<BR>

</TT> tag can be used to prevent
a dynamically-linked executable from running further commands itself.
<P>


In the following example, user <B>aaron</B> may run <I>/usr/bin/more</I>
and <I>/usr/bin/vi</I> but shell escapes will be disabled.
<P>




<PRE>

 aaron  shanty = NOEXEC: /usr/bin/more, /usr/bin/vi

</PRE>



<P>


See the ``<FONT SIZE="-1">PREVENTING</FONT> <FONT SIZE="-1">SHELL</FONT> <FONT SIZE="-1">ESCAPES</FONT>'' section below for more details
on how <TT>
NOEXEC<BR>

</TT> works and whether or not it will work on your system.
<P>


<I></I><FONT SIZE="-1"><I>SETENV</I></FONT><I> and </I><FONT SIZE="-1"><I>NOSETENV</I></FONT><I></I>
<A NAME="ixAAP"></A>

<P>


These tags override the value of the <I>setenv</I> option on a per-command
basis.  Note that if <TT>
SETENV<BR>

</TT> has been set for a command, any
environment variables set on the command line way are not subject
to the restrictions imposed by <I>env_check</I>, <I>env_delete</I>, or
<I>env_keep</I>.  As such, only trusted users should be allowed to set
variables in this manner.  If the command matched is <B></B><FONT SIZE="-1"><B>ALL</B></FONT><B></B>, the
<TT>
SETENV<BR>

</TT> tag is implied for that command; this default may
be overridden by use of the <TT>
NOSETENV<BR>

</TT> tag.
<P>


<I></I><FONT SIZE="-1"><I>LOG_INPUT</I></FONT><I> and </I><FONT SIZE="-1"><I>NOLOG_INPUT</I></FONT><I></I>
<A NAME="ixAAQ"></A>

<P>


These tags override the value of the <I>log_input</I> option on a
per-command basis.  For more information, see the description of
<I>log_input</I> in the ``<FONT SIZE="-1">SUDOERS</FONT> <FONT SIZE="-1">OPTIONS</FONT>'' section below.
<P>


<I></I><FONT SIZE="-1"><I>LOG_OUTPUT</I></FONT><I> and </I><FONT SIZE="-1"><I>NOLOG_OUTPUT</I></FONT><I></I>
<A NAME="ixAAR"></A>

<P>


These tags override the value of the <I>log_output</I> option on a
per-command basis.  For more information, see the description of
<I>log_output</I> in the ``<FONT SIZE="-1">SUDOERS</FONT> <FONT SIZE="-1">OPTIONS</FONT>'' section below.
<A NAME="lbAK">&nbsp;</A>
<H3>Wildcards</H3>


<A NAME="ixAAS"></A>

<B>sudo</B> allows shell-style <I>wildcards</I> (aka meta or glob characters)
to be used in host names, path names and command line arguments in
the <I>sudoers</I> file.  Wildcard matching is done via the <B></B><FONT SIZE="-1"><B>POSIX</B></FONT><B></B>
<I><A HREF="/manpages/index.html?3+glob">glob</A></I>(3) and <I><A HREF="http://localhost/cgi-bin/man/man2html?3+fnmatch">fnmatch</A></I>(3) routines.  Note that these are <I>not</I>
regular expressions.
<DL COMPACT>
<DT>
*<BR>

<DD>




<A NAME="ixAAT"></A>

Matches any set of zero or more characters.
<DT>
?<BR>

<DD>




<A NAME="ixAAU"></A>

Matches any single character.
<DT>
[...]<BR>

<DD>




<A NAME="ixAAV"></A>

Matches any character in the specified range.
<DT>
[!...]<BR>

<DD>




<A NAME="ixAAW"></A>

Matches any character <B>not</B> in the specified range.
<DT>
\x<BR>

<DD>




<A NAME="ixAAX"></A>

For any character ``x'', evaluates to ``x''.  This is used to
escape special characters such as: ``*'', ``?'', ``['', and ``}''.
</DL>
<P>


<FONT SIZE="-1">POSIX</FONT> character classes may also be used if your system's <I><A HREF="/manpages/index.html?3+glob">glob</A></I>(3)
and <I><A HREF="/manpages/index.html?3+fnmatch">fnmatch</A></I>(3) functions support them.  However, because the
<TT>':'</TT> character has special meaning in <I>sudoers</I>, it must be
escaped.  For example:
<P>




<PRE>

    /bin/ls [[\:alpha\:]]*

</PRE>



<P>


Would match any file name beginning with a letter.
<P>


Note that a forward slash ('/') will <B>not</B> be matched by
wildcards used in the path name.  When matching the command
line arguments, however, a slash <B>does</B> get matched by
wildcards.  This is to make a path like:
<P>




<PRE>

    /usr/bin/*

</PRE>



<P>


match <I>/usr/bin/who</I> but not <I>/usr/bin/X11/xterm</I>.
<A NAME="lbAL">&nbsp;</A>
<H3>Exceptions to wildcard rules</H3>


<A NAME="ixAAY"></A>

The following exceptions apply to the above rules:
<DL COMPACT>
<DT><DD>




<A NAME="ixAAZ"></A>

If the empty string <TT>&quot;&quot;</TT> is the only command line argument in the
<I>sudoers</I> entry it means that command is not allowed to be run
with <B>any</B> arguments.
</DL>
<A NAME="lbAM">&nbsp;</A>
<H3>Including other files from within sudoers</H3>


<A NAME="ixABA"></A>

It is possible to include other <I>sudoers</I> files from within the
<I>sudoers</I> file currently being parsed using the <TT>
#include<BR>

</TT> and
<TT>
#includedir<BR>

</TT> directives.
<P>


This can be used, for example, to keep a site-wide <I>sudoers</I> file
in addition to a local, per-machine file.  For the sake of this
example the site-wide <I>sudoers</I> will be <I>/etc/sudoers</I> and the
per-machine one will be <I>/etc/sudoers.local</I>.  To include
<I>/etc/sudoers.local</I> from within <I>/etc/sudoers</I> we would use the
following line in <I>/etc/sudoers</I>:


<P>



<DL COMPACT><DT><DD>

<TT>
#include /etc/sudoers.local<BR>

</TT>
</DL>


<P>


When <B>sudo</B> reaches this line it will suspend processing of the
current file (<I>/etc/sudoers</I>) and switch to <I>/etc/sudoers.local</I>.
Upon reaching the end of <I>/etc/sudoers.local</I>, the rest of
<I>/etc/sudoers</I> will be processed.  Files that are included may
themselves include other files.  A hard limit of 128 nested include
files is enforced to prevent include file loops.
<P>


The file name may include the <TT>%h</TT> escape, signifying the short form
of the host name.  I.e., if the machine's host name is ``xerxes'', then
<P>


<TT>
#include /etc/sudoers.%h<BR>

</TT>
<P>


will cause <B>sudo</B> to include the file <I>/etc/sudoers.xerxes</I>.
<P>


The <TT>
#includedir<BR>

</TT> directive can be used to create a <I>sudoers.d</I>
directory that the system package manager can drop <I>sudoers</I> rules
into as part of package installation.  For example, given:
<P>


<TT>
#includedir /etc/sudoers.d<BR>

</TT>
<P>


<B>sudo</B> will read each file in <I>/etc/sudoers.d</I>, skipping file
names that end in <TT>
~<BR>

</TT> or contain a <TT>
.<BR>

</TT> character to avoid causing
problems with package manager or editor temporary/backup files.
Files are parsed in sorted lexical order.  That is,
<I>/etc/sudoers.d/01_first</I> will be parsed before
<I>/etc/sudoers.d/10_second</I>.  Be aware that because the sorting is
lexical, not numeric, <I>/etc/sudoers.d/1_whoops</I> would be loaded
<B>after</B> <I>/etc/sudoers.d/10_second</I>.  Using a consistent number
of leading zeroes in the file names can be used to avoid such
problems.
<P>


Note that unlike files included via <TT>
#include<BR>

</TT>, <B>visudo</B> will not
edit the files in a <TT>
#includedir<BR>

</TT> directory unless one of them
contains a syntax error.  It is still possible to run <B>visudo</B>
with the <TT>
-f<BR>

</TT> flag to edit the files directly.
<A NAME="lbAN">&nbsp;</A>
<H3>Other special characters and reserved words</H3>


<A NAME="ixABB"></A>

The pound sign ('#') is used to indicate a comment (unless it is
part of a #include directive or unless it occurs in the context of
a user name and is followed by one or more digits, in which case
it is treated as a uid).  Both the comment character and any text
after it, up to the end of the line, are ignored.
<P>


The reserved word <B></B><FONT SIZE="-1"><B>ALL</B></FONT><B></B> is a built-in <I>alias</I> that always causes
a match to succeed.  It can be used wherever one might otherwise
use a <TT>
Cmnd_Alias<BR>

</TT>, <TT>
User_Alias<BR>

</TT>, <TT>
Runas_Alias<BR>

</TT>, or <TT>
Host_Alias<BR>

</TT>.
You should not try to define your own <I>alias</I> called <B></B><FONT SIZE="-1"><B>ALL</B></FONT><B></B> as the
built-in alias will be used in preference to your own.  Please note
that using <B></B><FONT SIZE="-1"><B>ALL</B></FONT><B></B> can be dangerous since in a command context, it
allows the user to run <B>any</B> command on the system.
<P>


An exclamation point ('!') can be used as a logical <I>not</I> operator
both in an <I>alias</I> and in front of a <TT>
Cmnd<BR>

</TT>.  This allows one to
exclude certain values.  Note, however, that using a <TT>
!<BR>

</TT> in
conjunction with the built-in <TT>
ALL<BR>

</TT> alias to allow a user to
run ``all but a few'' commands rarely works as intended (see <FONT SIZE="-1">SECURITY</FONT>
<FONT SIZE="-1">NOTES</FONT> below).
<P>


Long lines can be continued with a backslash ('\') as the last
character on the line.
<P>


Whitespace between elements in a list as well as special syntactic
characters in a <I>User Specification</I> ('=', ':', '(', ')') is optional.
<P>


The following characters must be escaped with a backslash ('\') when
used as part of a word (e.g.&nbsp;a user name or host name):
'@', '!', '=', ':', ',', '(', ')', '\'.
<A NAME="lbAO">&nbsp;</A>
<H2>SUDOERS OPTIONS</H2>


<A NAME="ixABC"></A>

<B>sudo</B>'s behavior can be modified by <TT>
Default_Entry<BR>

</TT> lines, as
explained earlier.  A list of all supported Defaults parameters,
grouped by type, are listed below.
<P>


<B>Boolean Flags</B>:
<DL COMPACT>
<DT>always_set_home<DD>

<A NAME="ixABD"></A>

If enabled, <B>sudo</B> will set the <TT>
HOME<BR>

</TT> environment variable to the
home directory of the target user (which is root unless the <B>-u</B>
option is used).  This effectively means that the <B>-H</B> option is
always implied.  Note that <TT>
HOME<BR>

</TT> is already set when the the
<I>env_reset</I> option is enabled, so <I>always_set_home</I> is only
effective for configurations where <I>env_reset</I> is disabled.
This flag is <I>off</I> by default.
<DT>authenticate<DD>

<A NAME="ixABE"></A>

If set, users must authenticate themselves via a password (or other
means of authentication) before they may run commands.  This default
may be overridden via the <TT>
PASSWD<BR>

</TT> and <TT>
NOPASSWD<BR>

</TT> tags.
This flag is <I>on</I> by default.
<DT>closefrom_override<DD>

<A NAME="ixABF"></A>

If set, the user may use <B>sudo</B>'s <B>-C</B> option which
overrides the default starting point at which <B>sudo</B> begins
closing open file descriptors.  This flag is <I>off</I> by default.
<DT>compress_io<DD>

<A NAME="ixABG"></A>

If set, and <B>sudo</B> is configured to log a command's input or output,
the I/O logs will be compressed using <B>zlib</B>.  This flag is <I>on</I>
by default when <B>sudo</B> is compiled with <B>zlib</B> support.
<DT>env_editor<DD>

<A NAME="ixABH"></A>

If set, <B>visudo</B> will use the value of the <FONT SIZE="-1">EDITOR</FONT> or <FONT SIZE="-1">VISUAL</FONT>
environment variables before falling back on the default editor list.
Note that this may create a security hole as it allows the user to
run any arbitrary command as root without logging.  A safer alternative
is to place a colon-separated list of editors in the <TT>
editor<BR>

</TT>
variable.  <B>visudo</B> will then only use the <FONT SIZE="-1">EDITOR</FONT> or <FONT SIZE="-1">VISUAL</FONT> if
they match a value specified in <TT>
editor<BR>

</TT>.  This flag is <I>on</I> by
default.
<DT>env_reset<DD>

<A NAME="ixABI"></A>

If set, <B>sudo</B> will reset the environment to only contain the
<FONT SIZE="-1">LOGNAME</FONT>, <FONT SIZE="-1">MAIL</FONT>, <FONT SIZE="-1">SHELL</FONT>, <FONT SIZE="-1">USER</FONT>, <FONT SIZE="-1">USERNAME</FONT> and the <TT>
SUDO_*<BR>

</TT> variables.  Any
variables in the caller's environment that match the <TT>
env_keep<BR>

</TT>
and <TT>
env_check<BR>

</TT> lists are then added.  The default contents of the
<TT>
env_keep<BR>

</TT> and <TT>
env_check<BR>

</TT> lists are displayed when <B>sudo</B> is
run by root with the <I>-V</I> option.  If the <I>secure_path</I> option
is set, its value will be used for the <TT>
PATH<BR>

</TT> environment variable.
This flag is <I>on</I> by default.
<DT>fast_glob<DD>

<A NAME="ixABJ"></A>

Normally, <B>sudo</B> uses the <I><A HREF="/manpages/index.html?3+glob">glob</A></I>(3) function to do shell-style
globbing when matching path names.  However, since it accesses the
file system, <I><A HREF="/manpages/index.html?3+glob">glob</A></I>(3) can take a long time to complete for some
patterns, especially when the pattern references a network file
system that is mounted on demand (automounted).  The <I>fast_glob</I>
option causes <B>sudo</B> to use the <I><A HREF="/manpages/index.html?3+fnmatch">fnmatch</A></I>(3) function, which does
not access the file system to do its matching.  The disadvantage
of <I>fast_glob</I> is that it is unable to match relative path names
such as <I>./ls</I> or <I>../bin/ls</I>.  This has security implications
when path names that include globbing characters are used with the
negation operator, <TT>'!'</TT>, as such rules can be trivially bypassed.
As such, this option should not be used when <I>sudoers</I> contains rules 
that contain negated path names which include globbing characters.
This flag is <I>off</I> by default.
<DT>fqdn<DD>

<A NAME="ixABK"></A>

Set this flag if you want to put fully qualified host names in the
<I>sudoers</I> file.  I.e., instead of myhost you would use myhost.mydomain.edu.
You may still use the short form if you wish (and even mix the two).
Beware that turning on <I>fqdn</I> requires <B>sudo</B> to make <FONT SIZE="-1">DNS</FONT> lookups
which may make <B>sudo</B> unusable if <FONT SIZE="-1">DNS</FONT> stops working (for example
if the machine is not plugged into the network).  Also note that
you must use the host's official name as <FONT SIZE="-1">DNS</FONT> knows it.  That is,
you may not use a host alias (<TT>
CNAME<BR>

</TT> entry) due to performance
issues and the fact that there is no way to get all aliases from
<FONT SIZE="-1">DNS</FONT>.  If your machine's host name (as returned by the <TT>
hostname<BR>

</TT>
command) is already fully qualified you shouldn't need to set
<I>fqdn</I>.  This flag is <I>off</I> by default.
<DT>ignore_dot<DD>

<A NAME="ixABL"></A>

If set, <B>sudo</B> will ignore '.' or '' (current dir) in the <TT>
PATH<BR>

</TT>
environment variable; the <TT>
PATH<BR>

</TT> itself is not modified.  This
flag is <I>on</I> by default.
<DT>ignore_local_sudoers<DD>

<A NAME="ixABM"></A>

If set via <FONT SIZE="-1">LDAP</FONT>, parsing of <I>/etc/sudoers</I> will be skipped.
This is intended for Enterprises that wish to prevent the usage of local
sudoers files so that only <FONT SIZE="-1">LDAP</FONT> is used.  This thwarts the efforts of
rogue operators who would attempt to add roles to <I>/etc/sudoers</I>.
When this option is present, <I>/etc/sudoers</I> does not even need to
exist. Since this option tells <B>sudo</B> how to behave when no specific <FONT SIZE="-1">LDAP</FONT>
entries have been matched, this sudoOption is only meaningful for the
<TT>
cn=defaults<BR>

</TT> section.  This flag is <I>off</I> by default.
<DT>insults<DD>

<A NAME="ixABN"></A>

If set, <B>sudo</B> will insult users when they enter an incorrect
password.  This flag is <I>off</I> by default.
<DT>log_host<DD>

<A NAME="ixABO"></A>

If set, the host name will be logged in the (non-syslog) <B>sudo</B> log file.
This flag is <I>off</I> by default.
<DT>log_year<DD>

<A NAME="ixABP"></A>

If set, the four-digit year will be logged in the (non-syslog) <B>sudo</B> log file.
This flag is <I>off</I> by default.
<DT>long_otp_prompt<DD>

<A NAME="ixABQ"></A>

When validating with a One Time Password (<FONT SIZE="-1">OPT</FONT>) scheme such as
<B>S/Key</B> or <B></B><FONT SIZE="-1"><B>OPIE</B></FONT><B></B>, a two-line prompt is used to make it easier
to cut and paste the challenge to a local window.  It's not as
pretty as the default but some people find it more convenient.  This
flag is <I>off</I> by default.
<DT>mail_always<DD>

<A NAME="ixABR"></A>

Send mail to the <I>mailto</I> user every time a users runs <B>sudo</B>.
This flag is <I>off</I> by default.
<DT>mail_badpass<DD>

<A NAME="ixABS"></A>

Send mail to the <I>mailto</I> user if the user running <B>sudo</B> does not
enter the correct password.  This flag is <I>off</I> by default.
<DT>mail_no_host<DD>

<A NAME="ixABT"></A>

If set, mail will be sent to the <I>mailto</I> user if the invoking
user exists in the <I>sudoers</I> file, but is not allowed to run
commands on the current host.  This flag is <I>off</I> by default.
<DT>mail_no_perms<DD>

<A NAME="ixABU"></A>

If set, mail will be sent to the <I>mailto</I> user if the invoking
user is allowed to use <B>sudo</B> but the command they are trying is not
listed in their <I>sudoers</I> file entry or is explicitly denied.
This flag is <I>off</I> by default.
<DT>mail_no_user<DD>

<A NAME="ixABV"></A>

If set, mail will be sent to the <I>mailto</I> user if the invoking
user is not in the <I>sudoers</I> file.  This flag is <I>on</I>
by default.
<DT>noexec<DD>

<A NAME="ixABW"></A>

If set, all commands run via <B>sudo</B> will behave as if the <TT>
NOEXEC<BR>

</TT>
tag has been set, unless overridden by a <TT>
EXEC<BR>

</TT> tag.  See the
description of <I></I><FONT SIZE="-1"><I>NOEXEC</I></FONT><I> and </I><FONT SIZE="-1"><I>EXEC</I></FONT><I></I> below as well as the ``<FONT SIZE="-1">PREVENTING</FONT> <FONT SIZE="-1">SHELL</FONT>
<FONT SIZE="-1">ESCAPES</FONT>'' section at the end of this manual.  This flag is <I>off</I> by default.
<DT>path_info<DD>

<A NAME="ixABX"></A>

Normally, <B>sudo</B> will tell the user when a command could not be
found in their <TT>
PATH<BR>

</TT> environment variable.  Some sites may wish
to disable this as it could be used to gather information on the
location of executables that the normal user does not have access
to.  The disadvantage is that if the executable is simply not in
the user's <TT>
PATH<BR>

</TT>, <B>sudo</B> will tell the user that they are not
allowed to run it, which can be confusing.  This flag is <I>on</I>
by default.
<DT>passprompt_override<DD>

<A NAME="ixABY"></A>

The password prompt specified by <I>passprompt</I> will normally only
be used if the password prompt provided by systems such as <FONT SIZE="-1">PAM</FONT> matches
the string ``Password:''.  If <I>passprompt_override</I> is set, <I>passprompt</I>
will always be used.  This flag is <I>off</I> by default.
<DT>preserve_groups<DD>

<A NAME="ixABZ"></A>

By default, <B>sudo</B> will initialize the group vector to the list of
groups the target user is in.  When <I>preserve_groups</I> is set, the
user's existing group vector is left unaltered.  The real and
effective group IDs, however, are still set to match the target
user.  This flag is <I>off</I> by default.
<DT>pwfeedback<DD>

<A NAME="ixACA"></A>

By default, <B>sudo</B> reads the password like most other Unix programs,
by turning off echo until the user hits the return (or enter) key.
Some users become confused by this as it appears to them that <B>sudo</B>
has hung at this point.  When <I>pwfeedback</I> is set, <B>sudo</B> will
provide visual feedback when the user presses a key.  Note that
this does have a security impact as an onlooker may be able to
determine the length of the password being entered.
This flag is <I>off</I> by default.
<DT>requiretty<DD>

<A NAME="ixACB"></A>

If set, <B>sudo</B> will only run when the user is logged in to a real
tty.  When this flag is set, <B>sudo</B> can only be run from a login
session and not via other means such as <I><A HREF="/manpages/index.html?8+cron">cron</A></I>(8) or cgi-bin scripts.
This flag is <I>off</I> by default.
<DT>root_sudo<DD>

<A NAME="ixACC"></A>

If set, root is allowed to run <B>sudo</B> too.  Disabling this prevents users
from ``chaining'' <B>sudo</B> commands to get a root shell by doing something
like <TT>&quot;sudo sudo /bin/sh&quot;</TT>.  Note, however, that turning off <I>root_sudo</I>
will also prevent root from running <B>sudoedit</B>.
Disabling <I>root_sudo</I> provides no real additional security; it
exists purely for historical reasons.
This flag is <I>on</I> by default.
<DT>rootpw<DD>

<A NAME="ixACD"></A>

If set, <B>sudo</B> will prompt for the root password instead of the password
of the invoking user.  This flag is <I>off</I> by default.
<DT>runaspw<DD>

<A NAME="ixACE"></A>

If set, <B>sudo</B> will prompt for the password of the user defined by the
<I>runas_default</I> option (defaults to <TT>
root<BR>

</TT>) instead of the
password of the invoking user.  This flag is <I>off</I> by default.
<DT>set_home<DD>

<A NAME="ixACF"></A>

If enabled and <B>sudo</B> is invoked with the <B>-s</B> option the <TT>
HOME<BR>

</TT>
environment variable will be set to the home directory of the target
user (which is root unless the <B>-u</B> option is used).  This effectively
makes the <B>-s</B> option imply <B>-H</B>.  Note that <TT>
HOME<BR>

</TT> is already
set when the the <I>env_reset</I> option is enabled, so <I>set_home</I> is
only effective for configurations where <I>env_reset</I> is disabled.
This flag is <I>off</I> by default.
<DT>set_logname<DD>

<A NAME="ixACG"></A>

Normally, <B>sudo</B> will set the <TT>
LOGNAME<BR>

</TT>, <TT>
USER<BR>

</TT> and <TT>
USERNAME<BR>

</TT>
environment variables to the name of the target user (usually root
unless the <B>-u</B> option is given).  However, since some programs
(including the <FONT SIZE="-1">RCS</FONT> revision control system) use <TT>
LOGNAME<BR>

</TT> to
determine the real identity of the user, it may be desirable to
change this behavior.  This can be done by negating the set_logname
option.  Note that if the <I>env_reset</I> option has not been disabled,
entries in the <I>env_keep</I> list will override the value of
<I>set_logname</I>.  This flag is <I>on</I> by default.
<DT>setenv<DD>

<A NAME="ixACH"></A>

Allow the user to disable the <I>env_reset</I> option from the command
line.  Additionally, environment variables set via the command line
are not subject to the restrictions imposed by <I>env_check</I>,
<I>env_delete</I>, or <I>env_keep</I>.  As such, only trusted users should
be allowed to set variables in this manner.  This flag is <I>off</I>
by default.
<DT>shell_noargs<DD>

<A NAME="ixACI"></A>

If set and <B>sudo</B> is invoked with no arguments it acts as if the
<B>-s</B> option had been given.  That is, it runs a shell as root (the
shell is determined by the <TT>
SHELL<BR>

</TT> environment variable if it is
set, falling back on the shell listed in the invoking user's
/etc/passwd entry if not).  This flag is <I>off</I> by default.
<DT>stay_setuid<DD>

<A NAME="ixACJ"></A>

Normally, when <B>sudo</B> executes a command the real and effective
UIDs are set to the target user (root by default).  This option
changes that behavior such that the real <FONT SIZE="-1">UID</FONT> is left as the invoking
user's <FONT SIZE="-1">UID</FONT>.  In other words, this makes <B>sudo</B> act as a setuid
wrapper.  This can be useful on systems that disable some potentially
dangerous functionality when a program is run setuid.  This option
is only effective on systems with either the <I>setreuid()</I> or <I>setresuid()</I>
function.  This flag is <I>off</I> by default.
<DT>targetpw<DD>

<A NAME="ixACK"></A>

If set, <B>sudo</B> will prompt for the password of the user specified
by the <B>-u</B> option (defaults to <TT>
root<BR>

</TT>) instead of the password
of the invoking user.  In addition, the timestamp file name will
include the target user's name.  Note that this flag precludes the
use of a uid not listed in the passwd database as an argument to
the <B>-u</B> option.  This flag is <I>off</I> by default.
<DT>log_input<DD>

<A NAME="ixACL"></A>

If set, <B>sudo</B> will run the command in a <I>pseudo tty</I> and log all
user input.
If the standard input is not connected to the user's tty, due to
I/O redirection or because the command is part of a pipeline, that
input is also captured and stored in a separate log file.


<P>



Input is logged to the <I>/var/log/sudo-io</I> directory using a unique
session <FONT SIZE="-1">ID</FONT> that is included in the normal <B>sudo</B> log line, prefixed
with <I>TSID=</I>.
<DT>log_output<DD>

<A NAME="ixACM"></A>

If set, <B>sudo</B> will run the command in a <I>pseudo tty</I> and log all
output that is sent to the screen, similar to the <I><A HREF="/manpages/index.html?1+script">script</A></I>(1) command.
If the standard output or standard error is not connected to the
user's tty, due to I/O redirection or because the command is part
of a pipeline, that output is also captured and stored in separate
log files.


<P>



Output is logged to the
<I>/var/log/sudo-io</I> directory using a unique session <FONT SIZE="-1">ID</FONT> that is
included in the normal <B>sudo</B> log line, prefixed with <I>TSID=</I>.


<P>



Output logs may be viewed with the <I><A HREF="/manpages/index.html?8+sudoreplay">sudoreplay</A></I>(8) utility, which
can also be used to list or search the available logs.
<DT>tty_tickets<DD>

<A NAME="ixACN"></A>

If set, users must authenticate on a per-tty basis.  With this flag
enabled, <B>sudo</B> will use a file named for the tty the user is
logged in on in the user's time stamp directory.  If disabled, the
time stamp of the directory is used instead.  This flag is
<I>on</I> by default.
<DT>umask_override<DD>

<A NAME="ixACO"></A>

If set, <B>sudo</B> will set the umask as specified by <I>sudoers</I> without
modification.  This makes it possible to specify a more permissive
umask in <I>sudoers</I> than the user's own umask and matches historical
behavior.  If <I>umask_override</I> is not set, <B>sudo</B> will set the
umask to be the union of the user's umask and what is specified in
<I>sudoers</I>.  This flag is <I>off</I> by default.


<DT>use_pty<DD>

<A NAME="ixACP"></A>

If set, <B>sudo</B> will run the command in a pseudo-pty even if no I/O
logging is being gone.  A malicious program run under <B>sudo</B> could
conceivably fork a background process that retains to the user's
terminal device after the main program has finished executing.  Use
of this option will make that impossible.
<DT>visiblepw<DD>

<A NAME="ixACQ"></A>

By default, <B>sudo</B> will refuse to run if the user must enter a
password but it is not possible to disable echo on the terminal.
If the <I>visiblepw</I> flag is set, <B>sudo</B> will prompt for a password
even when it would be visible on the screen.  This makes it possible
to run things like <TT>&quot;rsh somehost sudo ls&quot;</TT> since <I><A HREF="/manpages/index.html?1+rsh">rsh</A></I>(1) does
not allocate a tty.  This flag is <I>off</I> by default.
</DL>
<P>


<B>Integers</B>:
<DL COMPACT>
<DT>closefrom<DD>

<A NAME="ixACR"></A>

Before it executes a command, <B>sudo</B> will close all open file
descriptors other than standard input, standard output and standard
error (ie: file descriptors 0-2).  The <I>closefrom</I> option can be used
to specify a different file descriptor at which to start closing.
The default is <TT>3</TT>.
<DT>passwd_tries<DD>

<A NAME="ixACS"></A>

The number of tries a user gets to enter his/her password before
<B>sudo</B> logs the failure and exits.  The default is <TT>
3<BR>

</TT>.
</DL>
<P>


<B>Integers that can be used in a boolean context</B>:
<DL COMPACT>
<DT>loglinelen<DD>

<A NAME="ixACT"></A>

Number of characters per line for the file log.  This value is used
to decide when to wrap lines for nicer log files.  This has no
effect on the syslog log file, only the file log.  The default is
<TT>
80<BR>

</TT> (use 0 or negate the option to disable word wrap).
<DT>passwd_timeout<DD>

<A NAME="ixACU"></A>

Number of minutes before the <B>sudo</B> password prompt times out, or
<TT>0</TT> for no timeout.  The timeout may include a fractional component
if minute granularity is insufficient, for example <TT>2.5</TT>.  The
default is <TT>
5<BR>

</TT>.
<DT>timestamp_timeout<DD>

<A NAME="ixACV"></A>

Number of minutes that can elapse before <B>sudo</B> will ask for a
passwd again.  The timeout may include a fractional component if
minute granularity is insufficient, for example <TT>2.5</TT>.  The default
is <TT>
5<BR>

</TT>.  Set this to <TT>0</TT> to always prompt for a password.
If set to a value less than <TT>0</TT> the user's timestamp will never
expire.  This can be used to allow users to create or delete their
own timestamps via <TT>
sudo -v<BR>

</TT> and <TT>
sudo -k<BR>

</TT> respectively.
<DT>umask<DD>

<A NAME="ixACW"></A>

Umask to use when running the command.  Negate this option or set
it to 0777 to preserve the user's umask.  The actual umask that is
used will be the union of the user's umask and the value of the
<I>umask</I> option, which defaults to <TT>
0022<BR>

</TT>.  This guarantees
that <B>sudo</B> never lowers the umask when running a command.  Note
on systems that use <FONT SIZE="-1">PAM</FONT>, the default <FONT SIZE="-1">PAM</FONT> configuration may specify
its own umask which will override the value set in <I>sudoers</I>.
</DL>
<P>


<B>Strings</B>:
<DL COMPACT>
<DT>badpass_message<DD>

<A NAME="ixACX"></A>

Message that is displayed if a user enters an incorrect password.
The default is <TT>
Sorry, try again.<BR>

</TT> unless insults are enabled.
<DT>editor<DD>

<A NAME="ixACY"></A>

A colon (':') separated list of editors allowed to be used with
<B>visudo</B>.  <B>visudo</B> will choose the editor that matches the user's
<FONT SIZE="-1">EDITOR</FONT> environment variable if possible, or the first editor in the
list that exists and is executable.  The default is <TT>&quot;/bin/vi&quot;</TT>.
<DT>mailsub<DD>

<A NAME="ixACZ"></A>

Subject of the mail sent to the <I>mailto</I> user. The escape <TT>%h</TT>
will expand to the host name of the machine.
Default is <TT>
*** SECURITY information for %h ***<BR>

</TT>.
<DT>noexec_file<DD>

<A NAME="ixADA"></A>

Path to a shared library containing dummy versions of the <I>execv()</I>,
<I>execve()</I> and <I>fexecve()</I> library functions that just return an error.
This is used to implement the <I>noexec</I> functionality on systems that
support <TT>
LD_PRELOAD<BR>

</TT> or its equivalent.  Defaults to <I>/usr/libexec/sudo_noexec.so</I>.
<DT>passprompt<DD>

<A NAME="ixADB"></A>

The default prompt to use when asking for a password; can be overridden
via the <B>-p</B> option or the <TT>
SUDO_PROMPT<BR>

</TT> environment variable.
The following percent (`<TT>
%<BR>

</TT>') escapes are supported:
<DL COMPACT><DT><DD>

<DL COMPACT>
<DT>%H<DD>




<A NAME="ixADC"></A>

expanded to the local host name including the domain name
(on if the machine's host name is fully qualified or the <I>fqdn</I>
option is set)
<DT>%h<DD>




<A NAME="ixADD"></A>

expanded to the local host name without the domain name
<DT>%p<DD>




<A NAME="ixADE"></A>

expanded to the user whose password is being asked for (respects the 
<I>rootpw</I>, <I>targetpw</I> and <I>runaspw</I> flags in <I>sudoers</I>)
<DT>%U<DD>




<A NAME="ixADF"></A>

expanded to the login name of the user the command will
be run as (defaults to root)
<DT>%u<DD>




<A NAME="ixADG"></A>

expanded to the invoking user's login name
<DT>
%%<BR>

<DD>




<A NAME="ixADH"></A>

two consecutive <TT>
%<BR>

</TT> characters are collapsed into a single <TT>
%<BR>

</TT> character
</DL>
</DL>


<DL COMPACT><DT><DD>



<P>



The default value is <TT>
[sudo] password for %p: <BR>

</TT>.
</DL>


<DT>role<DD>

<A NAME="ixADI"></A>

The default SELinux role to use when constructing a new security
context to run the command.  The default role may be overridden on
a per-command basis in <I>sudoers</I> or via command line options.
This option is only available whe <B>sudo</B> is built with SELinux support.


<DT>runas_default<DD>

<A NAME="ixADJ"></A>

The default user to run commands as if the <B>-u</B> option is not specified
on the command line.  This defaults to <TT>
root<BR>

</TT>.
Note that if <I>runas_default</I> is set it <B>must</B> occur before
any <TT>
Runas_Alias<BR>

</TT> specifications.
<DT>syslog_badpri<DD>

<A NAME="ixADK"></A>

Syslog priority to use when user authenticates unsuccessfully.
Defaults to <TT>
alert<BR>

</TT>.
<DT>syslog_goodpri<DD>

<A NAME="ixADL"></A>

Syslog priority to use when user authenticates successfully.
Defaults to <TT>
notice<BR>

</TT>.
<DT>sudoers_locale<DD>

<A NAME="ixADM"></A>

Locale to use when parsing the sudoers file.  Note that changing
the locale may affect how sudoers is interpreted.
Defaults to <TT>&quot;C&quot;</TT>.
<DT>timestampdir<DD>

<A NAME="ixADN"></A>

The directory in which <B>sudo</B> stores its timestamp files.
The default is <I>/var/db/sudo</I>.
<DT>timestampowner<DD>

<A NAME="ixADO"></A>

The owner of the timestamp directory and the timestamps stored therein.
The default is <TT>
root<BR>

</TT>.
<DT>type<DD>

<A NAME="ixADP"></A>

The default SELinux type to use when constructing a new security
context to run the command.  The default type may be overridden on
a per-command basis in <I>sudoers</I> or via command line options.
This option is only available whe <B>sudo</B> is built with SELinux support.


</DL>
<P>


<B>Strings that can be used in a boolean context</B>:
<DL COMPACT>
<DT>askpass<DD>

<A NAME="ixADQ"></A>

The <I>askpass</I> option specifies the fully qualified path to a helper
program used to read the user's password when no terminal is
available.  This may be the case when <B>sudo</B> is executed from a
graphical (as opposed to text-based) application.  The program
specified by <I>askpass</I> should display the argument passed to it
as the prompt and write the user's password to the standard output.
The value of <I>askpass</I> may be overridden by the <TT>
SUDO_ASKPASS<BR>

</TT>
environment variable.
<DT>env_file<DD>

<A NAME="ixADR"></A>

The <I>env_file</I> options specifies the fully qualified path to a
file containing variables to be set in the environment of the program
being run.  Entries in this file should either be of the form
<TT>
VARIABLE=value<BR>

</TT> or <TT>
export VARIABLE=value<BR>

</TT>.  The value may
optionally be surrounded by single or double quotes.  Variables in
this file are subject to other <B>sudo</B> environment settings such
as <I>env_keep</I> and <I>env_check</I>.
<DT>exempt_group<DD>

<A NAME="ixADS"></A>

Users in this group are exempt from password and <FONT SIZE="-1">PATH</FONT> requirements.
This is not set by default.
<DT>lecture<DD>

<A NAME="ixADT"></A>

This option controls when a short lecture will be printed along with
the password prompt.  It has the following possible values:
<DL COMPACT><DT><DD>

<DL COMPACT>
<DT>always<DD>

<A NAME="ixADU"></A>

Always lecture the user.
<DT>never<DD>

<A NAME="ixADV"></A>

Never lecture the user.
<DT>once<DD>

<A NAME="ixADW"></A>

Only lecture the user the first time they run <B>sudo</B>.
</DL>
</DL>


<DL COMPACT><DT><DD>



<P>



If no value is specified, a value of <I>once</I> is implied.
Negating the option results in a value of <I>never</I> being used.
The default value is <I>once</I>.
</DL>


<DT>lecture_file<DD>

<A NAME="ixADX"></A>

Path to a file containing an alternate <B>sudo</B> lecture that will
be used in place of the standard lecture if the named file exists.
By default, <B>sudo</B> uses a built-in lecture.
<DT>listpw<DD>

<A NAME="ixADY"></A>

This option controls when a password will be required when a
user runs <B>sudo</B> with the <B>-l</B> option.  It has the following possible values:
<DL COMPACT><DT><DD>

<DL COMPACT>
<DT>all<DD>

<A NAME="ixADZ"></A>

All the user's <I>sudoers</I> entries for the current host must have
the <TT>
NOPASSWD<BR>

</TT> flag set to avoid entering a password.
<DT>always<DD>

<A NAME="ixAEA"></A>

The user must always enter a password to use the <B>-l</B> option.
<DT>any<DD>

<A NAME="ixAEB"></A>

At least one of the user's <I>sudoers</I> entries for the current host
must have the <TT>
NOPASSWD<BR>

</TT> flag set to avoid entering a password.
<DT>never<DD>

<A NAME="ixAEC"></A>

The user need never enter a password to use the <B>-l</B> option.
</DL>
</DL>


<DL COMPACT><DT><DD>



<P>



If no value is specified, a value of <I>any</I> is implied.
Negating the option results in a value of <I>never</I> being used.
The default value is <I>any</I>.
</DL>


<DT>logfile<DD>

<A NAME="ixAED"></A>

Path to the <B>sudo</B> log file (not the syslog log file).  Setting a path
turns on logging to a file; negating this option turns it off.
By default, <B>sudo</B> logs via syslog.
<DT>mailerflags<DD>

<A NAME="ixAEE"></A>

Flags to use when invoking mailer. Defaults to <B>-t</B>.
<DT>mailerpath<DD>

<A NAME="ixAEF"></A>

Path to mail program used to send warning mail.
Defaults to the path to sendmail found at configure time.
<DT>mailfrom<DD>

<A NAME="ixAEG"></A>

Address to use for the ``from'' address when sending warning and error
mail.  The address should be enclosed in double quotes (<TT>
&quot;<BR>

</TT>) to
protect against <B>sudo</B> interpreting the <TT>
@<BR>

</TT> sign.  Defaults to
the name of the user running <B>sudo</B>.
<DT>mailto<DD>

<A NAME="ixAEH"></A>

Address to send warning and error mail to.  The address should
be enclosed in double quotes (<TT>
&quot;<BR>

</TT>) to protect against <B>sudo</B>
interpreting the <TT>
@<BR>

</TT> sign.  Defaults to <TT>
root<BR>

</TT>.
<DT>secure_path<DD>

<A NAME="ixAEI"></A>

Path used for every command run from <B>sudo</B>.  If you don't trust the
people running <B>sudo</B> to have a sane <TT>
PATH<BR>

</TT> environment variable you may
want to use this.  Another use is if you want to have the ``root path''
be separate from the ``user path.''  Users in the group specified by the
<I>exempt_group</I> option are not affected by <I>secure_path</I>.
This option is not set by default.
<DT>syslog<DD>

<A NAME="ixAEJ"></A>

Syslog facility if syslog is being used for logging (negate to
disable syslog logging).  Defaults to <TT>
authpriv<BR>

</TT>.
<DT>verifypw<DD>

<A NAME="ixAEK"></A>

This option controls when a password will be required when a user runs
<B>sudo</B> with the <B>-v</B> option.  It has the following possible values:
<DL COMPACT><DT><DD>

<DL COMPACT>
<DT>all<DD>

<A NAME="ixAEL"></A>

All the user's <I>sudoers</I> entries for the current host must have
the <TT>
NOPASSWD<BR>

</TT> flag set to avoid entering a password.
<DT>always<DD>

<A NAME="ixAEM"></A>

The user must always enter a password to use the <B>-v</B> option.
<DT>any<DD>

<A NAME="ixAEN"></A>

At least one of the user's <I>sudoers</I> entries for the current host
must have the <TT>
NOPASSWD<BR>

</TT> flag set to avoid entering a password.
<DT>never<DD>

<A NAME="ixAEO"></A>

The user need never enter a password to use the <B>-v</B> option.
</DL>
</DL>


<DL COMPACT><DT><DD>



<P>



If no value is specified, a value of <I>all</I> is implied.
Negating the option results in a value of <I>never</I> being used.
The default value is <I>all</I>.
</DL>


</DL>
<P>


<B>Lists that can be used in a boolean context</B>:
<DL COMPACT>
<DT>env_check<DD>

<A NAME="ixAEP"></A>

Environment variables to be removed from the user's environment if
the variable's value contains <TT>
%<BR>

</TT> or <TT>
/<BR>

</TT> characters.  This can
be used to guard against printf-style format vulnerabilities in
poorly-written programs.  The argument may be a double-quoted,
space-separated list or a single value without double-quotes.  The
list can be replaced, added to, deleted from, or disabled by using
the <TT>
=<BR>

</TT>, <TT>
+=<BR>

</TT>, <TT>
-=<BR>

</TT>, and <TT>
!<BR>

</TT> operators respectively.  Regardless
of whether the <TT>
env_reset<BR>

</TT> option is enabled or disabled, variables
specified by <TT>
env_check<BR>

</TT> will be preserved in the environment if
they pass the aforementioned check.  The default list of environment
variables to check is displayed when <B>sudo</B> is run by root with
the <I>-V</I> option.
<DT>env_delete<DD>

<A NAME="ixAEQ"></A>

Environment variables to be removed from the user's environment
when the <I>env_reset</I> option is not in effect.  The argument may
be a double-quoted, space-separated list or a single value without
double-quotes.  The list can be replaced, added to, deleted from,
or disabled by using the <TT>
=<BR>

</TT>, <TT>
+=<BR>

</TT>, <TT>
-=<BR>

</TT>, and <TT>
!<BR>

</TT> operators
respectively.  The default list of environment variables to remove
is displayed when <B>sudo</B> is run by root with the <I>-V</I> option.
Note that many operating systems will remove potentially dangerous
variables from the environment of any setuid process (such as
<B>sudo</B>).
<DT>env_keep<DD>

<A NAME="ixAER"></A>

Environment variables to be preserved in the user's environment
when the <I>env_reset</I> option is in effect.  This allows fine-grained
control over the environment <B>sudo</B>-spawned processes will receive.
The argument may be a double-quoted, space-separated list or a
single value without double-quotes.  The list can be replaced, added
to, deleted from, or disabled by using the <TT>
=<BR>

</TT>, <TT>
+=<BR>

</TT>, <TT>
-=<BR>

</TT>, and
<TT>
!<BR>

</TT> operators respectively.  The default list of variables to keep
is displayed when <B>sudo</B> is run by root with the <I>-V</I> option.
</DL>
<P>


When logging via <I><A HREF="/manpages/index.html?3+syslog">syslog</A></I>(3), <B>sudo</B> accepts the following values
for the syslog facility (the value of the <B>syslog</B> Parameter):
<B>authpriv</B> (if your <FONT SIZE="-1">OS</FONT> supports it), <B>auth</B>, <B>daemon</B>, <B>user</B>,
<B>local0</B>, <B>local1</B>, <B>local2</B>, <B>local3</B>, <B>local4</B>, <B>local5</B>,
<B>local6</B>, and <B>local7</B>.  The following syslog priorities are
supported: <B>alert</B>, <B>crit</B>, <B>debug</B>, <B>emerg</B>, <B>err</B>, <B>info</B>,
<B>notice</B>, and <B>warning</B>.
<A NAME="lbAP">&nbsp;</A>
<H2>FILES</H2>


<A NAME="ixAES"></A>

<DL COMPACT>
<DT><I>/etc/sudoers</I><DD>




<A NAME="ixAET"></A>

List of who can run what
<DT><I>/etc/group</I><DD>

<A NAME="ixAEU"></A>

Local groups file
<DT><I>/etc/netgroup</I><DD>

<A NAME="ixAEV"></A>

List of network groups
<DT><I>/var/log/sudo-io</I><DD>

<A NAME="ixAEW"></A>

I/O log files
</DL>
<A NAME="lbAQ">&nbsp;</A>
<H2>EXAMPLES</H2>


<A NAME="ixAEX"></A>

Below are example <I>sudoers</I> entries.  Admittedly, some of
these are a bit contrived.  First, we allow a few environment
variables to pass and then define our <I>aliases</I>:
<P>




<PRE>

 # Run X applications through sudo; HOME is used to find the
 # .Xauthority file.  Note that other programs use HOME to find
 # configuration files and this may lead to privilege escalation!
 Defaults env_keep += &quot;DISPLAY HOME&quot;

 # User alias specification
 User_Alias     FULLTIMERS = millert, mikef, dowdy
 User_Alias     PARTTIMERS = bostley, jwfox, crawl
 User_Alias     WEBMASTERS = will, wendy, wim

 # Runas alias specification
 Runas_Alias    OP = root, operator
 Runas_Alias    DB = oracle, sybase
 Runas_Alias    ADMINGRP = adm, oper

 # Host alias specification
 Host_Alias     SPARC = bigtime, eclipse, moet, anchor :\
                SGI = grolsch, dandelion, black :\
                ALPHA = widget, thalamus, foobar :\
                HPPA = boa, nag, python
 Host_Alias     CUNETS = 128.138.0.0/255.255.0.0
 Host_Alias     CSNETS = 128.138.243.0, 128.138.204.0/24, 128.138.242.0
 Host_Alias     SERVERS = master, mail, www, ns
 Host_Alias     CDROM = orion, perseus, hercules

 # Cmnd alias specification
 Cmnd_Alias     DUMPS = /usr/bin/mt, /usr/sbin/dump, /usr/sbin/rdump,\
                        /usr/sbin/restore, /usr/sbin/rrestore
 Cmnd_Alias     KILL = /usr/bin/kill
 Cmnd_Alias     PRINTING = /usr/sbin/lpc, /usr/bin/lprm
 Cmnd_Alias     SHUTDOWN = /usr/sbin/shutdown
 Cmnd_Alias     HALT = /usr/sbin/halt
 Cmnd_Alias     REBOOT = /usr/sbin/reboot
 Cmnd_Alias     SHELLS = /usr/bin/sh, /usr/bin/csh, /usr/bin/ksh, \
                         /usr/local/bin/tcsh, /usr/bin/rsh, \
                         /usr/local/bin/zsh
 Cmnd_Alias     SU = /usr/bin/su
 Cmnd_Alias     PAGERS = /usr/bin/more, /usr/bin/pg, /usr/bin/less

</PRE>



<P>


Here we override some of the compiled in default values.  We want
<B>sudo</B> to log via <I><A HREF="/manpages/index.html?3+syslog">syslog</A></I>(3) using the <I>auth</I> facility in all
cases.  We don't want to subject the full time staff to the <B>sudo</B>
lecture, user <B>millert</B> need not give a password, and we don't
want to reset the <TT>
LOGNAME<BR>

</TT>, <TT>
USER<BR>

</TT> or <TT>
USERNAME<BR>

</TT> environment
variables when running commands as root.  Additionally, on the
machines in the <I></I><FONT SIZE="-1"><I>SERVERS</I></FONT><I></I> <TT>
Host_Alias<BR>

</TT>, we keep an additional
local log file and make sure we log the year in each log line since
the log entries will be kept around for several years.  Lastly, we
disable shell escapes for the commands in the <FONT SIZE="-1">PAGERS</FONT> <TT>
Cmnd_Alias<BR>

</TT>
(<I>/usr/bin/more</I>, <I>/usr/bin/pg</I> and <I>/usr/bin/less</I>).
<P>




<PRE>

 # Override built-in defaults
 Defaults               syslog=auth
 Defaults&gt;root          !set_logname
 Defaults:FULLTIMERS    !lecture
 Defaults:millert       !authenticate
 <A HREF="mailto:Defaults@SERVERS">Defaults@SERVERS</A>       log_year, logfile=/var/log/sudo.log
 Defaults!PAGERS        noexec

</PRE>



<P>


The <I>User specification</I> is the part that actually determines who may
run what.
<P>




<PRE>

 root           ALL = (ALL) ALL
 %wheel         ALL = (ALL) ALL

</PRE>



<P>


We let <B>root</B> and any user in group <B>wheel</B> run any command on any
host as any user.
<P>




<PRE>

 FULLTIMERS     ALL = NOPASSWD: ALL

</PRE>



<P>


Full time sysadmins (<B>millert</B>, <B>mikef</B>, and <B>dowdy</B>) may run any
command on any host without authenticating themselves.
<P>




<PRE>

 PARTTIMERS     ALL = ALL

</PRE>



<P>


Part time sysadmins (<B>bostley</B>, <B>jwfox</B>, and <B>crawl</B>) may run any
command on any host but they must authenticate themselves first
(since the entry lacks the <TT>
NOPASSWD<BR>

</TT> tag).
<P>




<PRE>

 jack           CSNETS = ALL

</PRE>



<P>


The user <B>jack</B> may run any command on the machines in the <I></I><FONT SIZE="-1"><I>CSNETS</I></FONT><I></I> alias
(the networks <TT>128.138.243.0</TT>, <TT>128.138.204.0</TT>, and <TT>128.138.242.0</TT>).
Of those networks, only <TT>128.138.204.0</TT> has an explicit netmask (in
<FONT SIZE="-1">CIDR</FONT> notation) indicating it is a class C network.  For the other
networks in <I></I><FONT SIZE="-1"><I>CSNETS</I></FONT><I></I>, the local machine's netmask will be used
during matching.
<P>




<PRE>

 lisa           CUNETS = ALL

</PRE>



<P>


The user <B>lisa</B> may run any command on any host in the <I></I><FONT SIZE="-1"><I>CUNETS</I></FONT><I></I> alias
(the class B network <TT>128.138.0.0</TT>).
<P>




<PRE>

 operator       ALL = DUMPS, KILL, SHUTDOWN, HALT, REBOOT, PRINTING,\
                sudoedit /etc/printcap, /usr/oper/bin/

</PRE>



<P>


The <B>operator</B> user may run commands limited to simple maintenance.
Here, those are commands related to backups, killing processes, the
printing system, shutting down the system, and any commands in the
directory <I>/usr/oper/bin/</I>.
<P>




<PRE>

 joe            ALL = /usr/bin/su operator

</PRE>



<P>


The user <B>joe</B> may only <I><A HREF="/manpages/index.html?1+su">su</A></I>(1) to operator.
<P>




<PRE>

 pete           HPPA = /usr/bin/passwd [A-Za-z]*, !/usr/bin/passwd root

 %opers         ALL = (: ADMINGRP) /usr/sbin/

</PRE>



<P>


Users in the <B>opers</B> group may run commands in <I>/usr/sbin/</I> as themselves
with any group in the <I></I><FONT SIZE="-1"><I>ADMINGRP</I></FONT><I></I> <TT>
Runas_Alias<BR>

</TT> (the <B>adm</B> and <B>oper</B>
groups).
<P>


The user <B>pete</B> is allowed to change anyone's password except for
root on the <I></I><FONT SIZE="-1"><I>HPPA</I></FONT><I></I> machines.  Note that this assumes <I><A HREF="/manpages/index.html?1+passwd">passwd</A></I>(1)
does not take multiple user names on the command line.
<P>




<PRE>

 bob            SPARC = (OP) ALL : SGI = (OP) ALL

</PRE>



<P>


The user <B>bob</B> may run anything on the <I></I><FONT SIZE="-1"><I>SPARC</I></FONT><I></I> and <I></I><FONT SIZE="-1"><I>SGI</I></FONT><I></I> machines
as any user listed in the <I></I><FONT SIZE="-1"><I>OP</I></FONT><I></I> <TT>
Runas_Alias<BR>

</TT> (<B>root</B> and <B>operator</B>).
<P>




<PRE>

 jim            +biglab = ALL

</PRE>



<P>


The user <B>jim</B> may run any command on machines in the <I>biglab</I> netgroup.
<B>sudo</B> knows that ``biglab'' is a netgroup due to the '+' prefix.
<P>




<PRE>

 +secretaries   ALL = PRINTING, /usr/bin/adduser, /usr/bin/rmuser

</PRE>



<P>


Users in the <B>secretaries</B> netgroup need to help manage the printers
as well as add and remove users, so they are allowed to run those
commands on all machines.
<P>




<PRE>

 fred           ALL = (DB) NOPASSWD: ALL

</PRE>



<P>


The user <B>fred</B> can run commands as any user in the <I></I><FONT SIZE="-1"><I>DB</I></FONT><I></I> <TT>
Runas_Alias<BR>

</TT>
(<B>oracle</B> or <B>sybase</B>) without giving a password.
<P>




<PRE>

 john           ALPHA = /usr/bin/su [!-]*, !/usr/bin/su *root*

</PRE>



<P>


On the <I></I><FONT SIZE="-1"><I>ALPHA</I></FONT><I></I> machines, user <B>john</B> may su to anyone except root
but he is not allowed to specify any options to the <I><A HREF="/manpages/index.html?1+su">su</A></I>(1) command.
<P>




<PRE>

 jen            ALL, !SERVERS = ALL

</PRE>



<P>


The user <B>jen</B> may run any command on any machine except for those
in the <I></I><FONT SIZE="-1"><I>SERVERS</I></FONT><I></I> <TT>
Host_Alias<BR>

</TT> (master, mail, www and ns).
<P>




<PRE>

 jill           SERVERS = /usr/bin/, !SU, !SHELLS

</PRE>



<P>


For any machine in the <I></I><FONT SIZE="-1"><I>SERVERS</I></FONT><I></I> <TT>
Host_Alias<BR>

</TT>, <B>jill</B> may run
any commands in the directory <I>/usr/bin/</I> except for those commands
belonging to the <I></I><FONT SIZE="-1"><I>SU</I></FONT><I></I> and <I></I><FONT SIZE="-1"><I>SHELLS</I></FONT><I></I> <TT>
Cmnd_Aliases<BR>

</TT>.
<P>




<PRE>

 steve          CSNETS = (operator) /usr/local/op_commands/

</PRE>



<P>


The user <B>steve</B> may run any command in the directory /usr/local/op_commands/
but only as user operator.
<P>




<PRE>

 matt           valkyrie = KILL

</PRE>



<P>


On his personal workstation, valkyrie, <B>matt</B> needs to be able to
kill hung processes.
<P>




<PRE>

 WEBMASTERS     www = (www) ALL, (root) /usr/bin/su www

</PRE>



<P>


On the host www, any user in the <I></I><FONT SIZE="-1"><I>WEBMASTERS</I></FONT><I></I> <TT>
User_Alias<BR>

</TT> (will,
wendy, and wim), may run any command as user www (which owns the
web pages) or simply <I><A HREF="/manpages/index.html?1+su">su</A></I>(1) to www.
<P>




<PRE>

 ALL            CDROM = NOPASSWD: /sbin/umount /CDROM,\
                /sbin/mount -o nosuid\,nodev /dev/cd0a /CDROM

</PRE>



<P>


Any user may mount or unmount a CD-ROM on the machines in the <FONT SIZE="-1">CDROM</FONT>
<TT>
Host_Alias<BR>

</TT> (orion, perseus, hercules) without entering a password.
This is a bit tedious for users to type, so it is a prime candidate
for encapsulating in a shell script.
<A NAME="lbAR">&nbsp;</A>
<H2>SECURITY NOTES</H2>


<A NAME="ixAEY"></A>

It is generally not effective to ``subtract'' commands from <TT>
ALL<BR>

</TT>
using the '!' operator.  A user can trivially circumvent this
by copying the desired command to a different name and then
executing that.  For example:
<P>




<PRE>

    bill        ALL = ALL, !SU, !SHELLS

</PRE>



<P>


Doesn't really prevent <B>bill</B> from running the commands listed in
<I></I><FONT SIZE="-1"><I>SU</I></FONT><I></I> or <I></I><FONT SIZE="-1"><I>SHELLS</I></FONT><I></I> since he can simply copy those commands to a
different name, or use a shell escape from an editor or other
program.  Therefore, these kind of restrictions should be considered
advisory at best (and reinforced by policy).
<P>


Furthermore, if the <I>fast_glob</I> option is in use, it is not possible
to reliably negate commands where the path name includes globbing
(aka wildcard) characters.  This is because the C library's
<I><A HREF="/manpages/index.html?3+fnmatch">fnmatch</A></I>(3) function cannot resolve relative paths.  While this
is typically only an inconvenience for rules that grant privileges,
it can result in a security issue for rules that subtract or revoke
privileges.
<P>


For example, given the following <I>sudoers</I> entry:
<P>




<PRE>

 john   ALL = /usr/bin/passwd [a-zA-Z0-9]*, /usr/bin/chsh [a-zA-Z0-9]*,
      /usr/bin/chfn [a-zA-Z0-9]*, !/usr/bin/* root

</PRE>



<P>


User <B>john</B> can still run <TT>
/usr/bin/passwd root<BR>

</TT> if <I>fast_glob</I> is
enabled by changing to <I>/usr/bin</I> and running <TT>
./passwd root<BR>

</TT> instead.
<A NAME="lbAS">&nbsp;</A>
<H2>PREVENTING SHELL ESCAPES</H2>


<A NAME="ixAEZ"></A>

Once <B>sudo</B> executes a program, that program is free to do whatever
it pleases, including run other programs.  This can be a security
issue since it is not uncommon for a program to allow shell escapes,
which lets a user bypass <B>sudo</B>'s access control and logging.
Common programs that permit shell escapes include shells (obviously),
editors, paginators, mail and terminal programs.
<P>


There are two basic approaches to this problem:
<DL COMPACT>
<DT>restrict<DD>

<A NAME="ixAFA"></A>

Avoid giving users access to commands that allow the user to run
arbitrary commands.  Many editors have a restricted mode where shell
escapes are disabled, though <B>sudoedit</B> is a better solution to
running editors via <B>sudo</B>.  Due to the large number of programs that
offer shell escapes, restricting users to the set of programs that
do not is often unworkable.
<DT>noexec<DD>

<A NAME="ixAFB"></A>

Many systems that support shared libraries have the ability to
override default library functions by pointing an environment
variable (usually <TT>
LD_PRELOAD<BR>

</TT>) to an alternate shared library.
On such systems, <B>sudo</B>'s <I>noexec</I> functionality can be used to
prevent a program run by <B>sudo</B> from executing any other programs.
Note, however, that this applies only to native dynamically-linked
executables.  Statically-linked executables and foreign executables
running under binary emulation are not affected.


<P>



To tell whether or not <B>sudo</B> supports <I>noexec</I>, you can run
the following as root:


<P>





<PRE>

    sudo -V | grep &quot;dummy exec&quot;

</PRE>





<P>



If the resulting output contains a line that begins with:


<P>





<PRE>

    File containing dummy exec functions:

</PRE>





<P>



then <B>sudo</B> may be able to replace the exec family of functions
in the standard library with its own that simply return an error.
Unfortunately, there is no foolproof way to know whether or not
<I>noexec</I> will work at compile-time.  <I>noexec</I> should work on
SunOS, Solaris, *BSD, Linux, <FONT SIZE="-1">IRIX</FONT>, Tru64 <FONT SIZE="-1">UNIX</FONT>, MacOS X, and HP-UX
11.x.  It is known <B>not</B> to work on <FONT SIZE="-1">AIX</FONT> and UnixWare.  <I>noexec</I>
is expected to work on most operating systems that support the
<TT>
LD_PRELOAD<BR>

</TT> environment variable.  Check your operating system's
manual pages for the dynamic linker (usually ld.so, ld.so.1, dyld,
dld.sl, rld, or loader) to see if <TT>
LD_PRELOAD<BR>

</TT> is supported.


<P>



To enable <I>noexec</I> for a command, use the <TT>
NOEXEC<BR>

</TT> tag as documented
in the User Specification section above.  Here is that example again:


<P>





<PRE>

 aaron  shanty = NOEXEC: /usr/bin/more, /usr/bin/vi

</PRE>





<P>



This allows user <B>aaron</B> to run <I>/usr/bin/more</I> and <I>/usr/bin/vi</I>
with <I>noexec</I> enabled.  This will prevent those two commands from
executing other commands (such as a shell).  If you are unsure
whether or not your system is capable of supporting <I>noexec</I> you
can always just try it out and see if it works.
</DL>
<P>


Note that restricting shell escapes is not a panacea.  Programs
running as root are still capable of many potentially hazardous
operations (such as changing or overwriting files) that could lead
to unintended privilege escalation.  In the specific case of an
editor, a safer approach is to give the user permission to run
<B>sudoedit</B>.
<A NAME="lbAT">&nbsp;</A>
<H2>SEE ALSO</H2>


<A NAME="ixAFC"></A>

<I><A HREF="/manpages/index.html?1+rsh">rsh</A></I>(1), <I><A HREF="http://localhost/cgi-bin/man/man2html?1+su">su</A></I>(1), <I><A HREF="http://localhost/cgi-bin/man/man2html?3+fnmatch">fnmatch</A></I>(3), <I><A HREF="http://localhost/cgi-bin/man/man2html?3+glob">glob</A></I>(3), <I><A HREF="http://localhost/cgi-bin/man/man2html?8+sudo">sudo</A></I>(8), <I><A HREF="http://localhost/cgi-bin/man/man2html?8+visudo">visudo</A></I>(8)
<A NAME="lbAU">&nbsp;</A>
<H2>CAVEATS</H2>


<A NAME="ixAFD"></A>

The <I>sudoers</I> file should <B>always</B> be edited by the <B>visudo</B>
command which locks the file and does grammatical checking. It is
imperative that <I>sudoers</I> be free of syntax errors since <B>sudo</B>
will not run with a syntactically incorrect <I>sudoers</I> file.
<P>


When using netgroups of machines (as opposed to users), if you
store fully qualified host name in the netgroup (as is usually the
case), you either need to have the machine's host name be fully qualified
as returned by the <TT>
hostname<BR>

</TT> command or use the <I>fqdn</I> option in
<I>sudoers</I>.
<A NAME="lbAV">&nbsp;</A>
<H2>BUGS</H2>


<A NAME="ixAFE"></A>

If you feel you have found a bug in <B>sudo</B>, please submit a bug report
at <A HREF="http://www.sudo.ws/sudo/bugs/">http://www.sudo.ws/sudo/bugs/</A>
<A NAME="lbAW">&nbsp;</A>
<H2>SUPPORT</H2>


<A NAME="ixAFF"></A>

Limited free support is available via the sudo-users mailing list,
see <A HREF="http://www.sudo.ws/mailman/listinfo/sudo-users">http://www.sudo.ws/mailman/listinfo/sudo-users</A> to subscribe or
search the archives.
<A NAME="lbAX">&nbsp;</A>
<H2>DISCLAIMER</H2>


<A NAME="ixAFG"></A>

<B>sudo</B> is provided ``<FONT SIZE="-1">AS</FONT> <FONT SIZE="-1">IS</FONT>'' and any express or implied warranties,
including, but not limited to, the implied warranties of merchantability
and fitness for a particular purpose are disclaimed.  See the <FONT SIZE="-1">LICENSE</FONT>
file distributed with <B>sudo</B> or <A HREF="http://www.sudo.ws/sudo/license.html">http://www.sudo.ws/sudo/license.html</A>
for complete details.
<P>


<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">DESCRIPTION</A><DD>
<DL>
<DT><A HREF="#lbAD">Quick guide to <FONT SIZE="-1">EBNF</FONT></A><DD>
<DT><A HREF="#lbAE">Aliases</A><DD>
<DT><A HREF="#lbAF">Defaults</A><DD>
<DT><A HREF="#lbAG">User Specification</A><DD>
<DT><A HREF="#lbAH">Runas_Spec</A><DD>
<DT><A HREF="#lbAI">SELinux_Spec</A><DD>
<DT><A HREF="#lbAJ">Tag_Spec</A><DD>
<DT><A HREF="#lbAK">Wildcards</A><DD>
<DT><A HREF="#lbAL">Exceptions to wildcard rules</A><DD>
<DT><A HREF="#lbAM">Including other files from within sudoers</A><DD>
<DT><A HREF="#lbAN">Other special characters and reserved words</A><DD>
</DL>
<DT><A HREF="#lbAO">SUDOERS OPTIONS</A><DD>
<DT><A HREF="#lbAP">FILES</A><DD>
<DT><A HREF="#lbAQ">EXAMPLES</A><DD>
<DT><A HREF="#lbAR">SECURITY NOTES</A><DD>
<DT><A HREF="#lbAS">PREVENTING SHELL ESCAPES</A><DD>
<DT><A HREF="#lbAT">SEE ALSO</A><DD>
<DT><A HREF="#lbAU">CAVEATS</A><DD>
<DT><A HREF="#lbAV">BUGS</A><DD>
<DT><A HREF="#lbAW">SUPPORT</A><DD>
<DT><A HREF="#lbAX">DISCLAIMER</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:34:00 GMT, December 24, 2015
</div></div>
</body>
</HTML>
