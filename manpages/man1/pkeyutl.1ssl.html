<!DOCTYPE html>

<HTML><head><TITLE>Manpage of PKEYUTL</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux man pages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>PKEYUTL</H1>
Section: OpenSSL (1)<BR>Updated: 2009-04-10<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

pkeyutl - public key algorithm utility
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAC"></A>
<B>openssl</B> <B>pkeyutl</B>
[<B>-in file</B>]
[<B>-out file</B>]
[<B>-sigfile file</B>]
[<B>-inkey file</B>]
[<B>-keyform PEM|DER</B>]
[<B>-passin arg</B>]
[<B>-peerkey file</B>]
[<B>-peerform PEM|DER</B>]
[<B>-pubin</B>]
[<B>-certin</B>]
[<B>-rev</B>]
[<B>-sign</B>]
[<B>-verify</B>]
[<B>-verifyrecover</B>]
[<B>-encrypt</B>]
[<B>-decrypt</B>]
[<B>-derive</B>]
[<B>-pkeyopt opt:value</B>]
[<B>-hexdump</B>]
[<B>-asn1parse</B>]
[<B>-engine id</B>]
<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>
The <B>pkeyutl</B> command can be used to perform public key operations using
any supported algorithm.
<A NAME="lbAE">&nbsp;</A>
<H2>COMMAND OPTIONS</H2>

<A NAME="ixAAE"></A>
<DL COMPACT>
<DT><B>-in filename</B><DD>
<A NAME="ixAAF"></A>
This specifies the input filename to read data from or standard input
if this option is not specified.
<DT><B>-out filename</B><DD>
<A NAME="ixAAG"></A>
specifies the output filename to write to or standard output by
default.
<DT><B>-inkey file</B><DD>
<A NAME="ixAAH"></A>
the input key file, by default it should be a private key.
<DT><B>-keyform PEM|DER</B><DD>
<A NAME="ixAAI"></A>
the key format <FONT SIZE="-1">PEM</FONT>, <FONT SIZE="-1">DER</FONT> or <FONT SIZE="-1">ENGINE</FONT>.
<DT><B>-passin arg</B><DD>
<A NAME="ixAAJ"></A>
the input key password source. For more information about the format of <B>arg</B>
see the <B></B><FONT SIZE="-1"><B>PASS</B></FONT><B> </B><FONT SIZE="-1"><B>PHRASE</B></FONT><B> </B><FONT SIZE="-1"><B>ARGUMENTS</B></FONT><B></B> section in <I><A HREF="/manpages/index.html?1+openssl">openssl</A></I>(1).
<DT><B>-peerkey file</B><DD>
<A NAME="ixAAK"></A>
the peer key file, used by key derivation (agreement) operations.
<DT><B>-peerform PEM|DER</B><DD>
<A NAME="ixAAL"></A>
the peer key format <FONT SIZE="-1">PEM</FONT>, <FONT SIZE="-1">DER</FONT> or <FONT SIZE="-1">ENGINE</FONT>.
<DT><B>-engine id</B><DD>
<A NAME="ixAAM"></A>
specifying an engine (by its unique <B>id</B> string) will cause <B>pkeyutl</B>
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed. The engine will then be set as the default
for all available algorithms.
<DT><B>-pubin</B><DD>
<A NAME="ixAAN"></A>
the input file is a public key.
<DT><B>-certin</B><DD>
<A NAME="ixAAO"></A>
the input is a certificate containing a public key.
<DT><B>-rev</B><DD>
<A NAME="ixAAP"></A>
reverse the order of the input buffer. This is useful for some libraries
(such as CryptoAPI) which represent the buffer in little endian format.
<DT><B>-sign</B><DD>
<A NAME="ixAAQ"></A>
sign the input data and output the signed result. This requires
a private key.
<DT><B>-verify</B><DD>
<A NAME="ixAAR"></A>
verify the input data against the signature file and indicate if the
verification succeeded or failed.
<DT><B>-verifyrecover</B><DD>
<A NAME="ixAAS"></A>
verify the input data and output the recovered data.
<DT><B>-encrypt</B><DD>
<A NAME="ixAAT"></A>
encrypt the input data using a public key.
<DT><B>-decrypt</B><DD>
<A NAME="ixAAU"></A>
decrypt the input data using a private key.
<DT><B>-derive</B><DD>
<A NAME="ixAAV"></A>
derive a shared secret using the peer key.
<DT><B>-hexdump</B><DD>
<A NAME="ixAAW"></A>
hex dump the output data.
<DT><B>-asn1parse</B><DD>
<A NAME="ixAAX"></A>
asn1parse the output data, this is useful when combined with the
<B>-verifyrecover</B> option when an <FONT SIZE="-1">ASN1</FONT> structure is signed.
</DL>
<A NAME="lbAF">&nbsp;</A>
<H2>NOTES</H2>

<A NAME="ixAAY"></A>
The operations and options supported vary according to the key algorithm
and its implementation. The OpenSSL operations and options are indicated below.
<P>

Unless otherwise mentioned all algorithms support the <B>digest:alg</B> option
which specifies the digest in use for sign, verify and verifyrecover operations.
The value <B>alg</B> should represent a digest name as used in the
<I>EVP_get_digestbyname()</I> function for example <B>sha1</B>.
<A NAME="lbAG">&nbsp;</A>
<H2>RSA ALGORITHM</H2>

<A NAME="ixAAZ"></A>
The <FONT SIZE="-1">RSA</FONT> algorithm supports encrypt, decrypt, sign, verify and verifyrecover
operations in general. Some padding modes only support some of these 
operations however.
<DL COMPACT>
<DT>-<B>rsa_padding_mode:mode</B><DD>
<A NAME="ixABA"></A>
This sets the <FONT SIZE="-1">RSA</FONT> padding mode. Acceptable values for <B>mode</B> are <B>pkcs1</B> for
PKCS#1 padding, <B>sslv23</B> for SSLv23 padding, <B>none</B> for no padding, <B>oaep</B>
for <B></B><FONT SIZE="-1"><B>OAEP</B></FONT><B></B> mode, <B>x931</B> for X9.31 mode and <B>pss</B> for <FONT SIZE="-1">PSS</FONT>.


<P>


In PKCS#1 padding if the message digest is not set then the supplied data is 
signed or verified directly instead of using a <B>DigestInfo</B> structure. If a
digest is set then the a <B>DigestInfo</B> structure is used and its the length
must correspond to the digest type.


<P>


For <B>oeap</B> mode only encryption and decryption is supported.


<P>


For <B>x931</B> if the digest type is set it is used to format the block data
otherwise the first byte is used to specify the X9.31 digest <FONT SIZE="-1">ID</FONT>. Sign,
verify and verifyrecover are can be performed in this mode.


<P>


For <B>pss</B> mode only sign and verify are supported and the digest type must be
specified.
<DT><B>rsa_pss_saltlen:len</B><DD>
<A NAME="ixABB"></A>
For <B>pss</B> mode only this option specifies the salt length. Two special values
are supported: -1 sets the salt length to the digest length. When signing -2
sets the salt length to the maximum permissible value. When verifying -2 causes
the salt length to be automatically determined based on the <B></B><FONT SIZE="-1"><B>PSS</B></FONT><B></B> block
structure.
</DL>
<A NAME="lbAH">&nbsp;</A>
<H2>DSA ALGORITHM</H2>

<A NAME="ixABC"></A>
The <FONT SIZE="-1">DSA</FONT> algorithm supports signing and verification operations only. Currently
there are no additional options other than <B>digest</B>. Only the <FONT SIZE="-1">SHA1</FONT>
digest can be used and this digest is assumed by default.
<A NAME="lbAI">&nbsp;</A>
<H2>DH ALGORITHM</H2>

<A NAME="ixABD"></A>
The <FONT SIZE="-1">DH</FONT> algorithm only supports the derivation operation and no additional
options.
<A NAME="lbAJ">&nbsp;</A>
<H2>EC ALGORITHM</H2>

<A NAME="ixABE"></A>
The <FONT SIZE="-1">EC</FONT> algorithm supports sign, verify and derive operations. The sign and
verify operations use <FONT SIZE="-1">ECDSA</FONT> and derive uses <FONT SIZE="-1">ECDH</FONT>. Currently there are no
additional options other than <B>digest</B>. Only the <FONT SIZE="-1">SHA1</FONT> digest can be used and
this digest is assumed by default.
<A NAME="lbAK">&nbsp;</A>
<H2>EXAMPLES</H2>

<A NAME="ixABF"></A>
Sign some data using a private key:
<P>



<PRE>
 openssl pkeyutl -sign -in file -inkey key.pem -out sig

</PRE>


<P>

Recover the signed data (e.g. if an <FONT SIZE="-1">RSA</FONT> key is used):
<P>



<PRE>
 openssl pkeyutl -verifyrecover -in sig -inkey key.pem

</PRE>


<P>

Verify the signature (e.g. a <FONT SIZE="-1">DSA</FONT> key):
<P>



<PRE>
 openssl pkeyutl -verify -in file -sigfile sig -inkey key.pem

</PRE>


<P>

Sign data using a message digest value (this is currently only valid for <FONT SIZE="-1">RSA</FONT>):
<P>



<PRE>
 openssl pkeyutl -sign -in file -inkey key.pem -out sig -pkeyopt digest:sha256

</PRE>


<P>

Derive a shared secret value:
<P>



<PRE>
 openssl pkeyutl -derive -inkey key.pem -peerkey pubkey.pem -out secret

</PRE>


<A NAME="lbAL">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixABG"></A>
<I><A HREF="/manpages/index.html?1+genpkey">genpkey</A></I>(1), <I><A HREF="http://localhost/cgi-bin/man/man2html?1+pkey">pkey</A></I>(1), <I><A HREF="http://localhost/cgi-bin/man/man2html?1+rsautl">rsautl</A></I>(1)
<I><A HREF="/manpages/index.html?1+dgst">dgst</A></I>(1), <I><A HREF="http://localhost/cgi-bin/man/man2html?1+rsa">rsa</A></I>(1), <I><A HREF="http://localhost/cgi-bin/man/man2html?1+genrsa">genrsa</A></I>(1)
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">COMMAND OPTIONS</A><DD>
<DT><A HREF="#lbAF">NOTES</A><DD>
<DT><A HREF="#lbAG">RSA ALGORITHM</A><DD>
<DT><A HREF="#lbAH">DSA ALGORITHM</A><DD>
<DT><A HREF="#lbAI">DH ALGORITHM</A><DD>
<DT><A HREF="#lbAJ">EC ALGORITHM</A><DD>
<DT><A HREF="#lbAK">EXAMPLES</A><DD>
<DT><A HREF="#lbAL">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:29:09 GMT, December 24, 2015
</div></body>
</HTML>
