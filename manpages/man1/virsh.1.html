<!DOCTYPE html>

<HTML><head><TITLE>Manpage of VIRSH</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux manpages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content"><div class="wrap">
<H1>VIRSH</H1>
Section: Virtualization Support (1)<BR>Updated: 2012-10-11<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

virsh - management user interface
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAC"></A>
<B>virsh</B> [<I></I><FONT SIZE="-1"><I>OPTION</I></FONT><I></I>]... [<I></I><FONT SIZE="-1"><I>COMMAND_STRING</I></FONT><I></I>]
<P>

<B>virsh</B> [<I></I><FONT SIZE="-1"><I>OPTION</I></FONT><I></I>]... <I></I><FONT SIZE="-1"><I>COMMAND</I></FONT><I></I> [<I></I><FONT SIZE="-1"><I>ARG</I></FONT><I></I>]...
<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>
The <B>virsh</B> program is the main interface for managing virsh guest
domains. The program can be used to create, pause, and shutdown
domains. It can also be used to list current domains. Libvirt is a C
toolkit to interact with the virtualization capabilities of recent
versions of Linux (and other OSes). It is free software available
under the <FONT SIZE="-1">GNU</FONT> Lesser General Public License. Virtualization of the
Linux Operating System means the ability to run multiple instances of
Operating Systems concurrently on a single hardware system where the
basic resources are driven by a Linux instance. The library aims at
providing a long term stable C <FONT SIZE="-1">API</FONT>.  It currently supports Xen, QEmu,
<FONT SIZE="-1">KVM</FONT>, <FONT SIZE="-1">LXC</FONT>, OpenVZ, VirtualBox and VMware <FONT SIZE="-1">ESX</FONT>.
<P>

The basic structure of most virsh usage is:
<P>



<PRE>
  virsh [OPTION]... &lt;command&gt; &lt;domain-id&gt; [ARG]...

</PRE>


<P>

Where <I>command</I> is one of the commands listed below, <I>domain-id</I>
is the numeric domain id, or the domain name (which will be internally
translated to domain id), and <I></I><FONT SIZE="-1"><I>ARGS</I></FONT><I></I> are command specific
options.  There are a few exceptions to this rule in the cases where
the command in question acts on all domains, the entire machine,
or directly on the xen hypervisor.  Those exceptions will be clear for
each of those commands.
<P>

The <B>virsh</B> program can be used either to run one <I></I><FONT SIZE="-1"><I>COMMAND</I></FONT><I></I> by giving the
command and its arguments on the shell command line, or a <I></I><FONT SIZE="-1"><I>COMMAND_STRING</I></FONT><I></I>
which is a single shell argument consisting of multiple <I></I><FONT SIZE="-1"><I>COMMAND</I></FONT><I></I> actions
and their arguments joined with whitespace, and separated by semicolons
between commands.  Within <I></I><FONT SIZE="-1"><I>COMMAND_STRING</I></FONT><I></I>, virsh understands the
same single, double, and backslash escapes as the shell, although you must
add another layer of shell escaping in creating the single shell argument.
If no command is given in the command line, <B>virsh</B> will then start a minimal
interpreter waiting for your commands, and the <B>quit</B> command will then exit
the program.
<P>

The <B>virsh</B> program understands the following <I></I><FONT SIZE="-1"><I>OPTIONS</I></FONT><I></I>.
<DL COMPACT>
<DT><B>-h</B>, <B>--help</B><DD>
<A NAME="ixAAE"></A>
Ignore all other arguments, and behave as if the <B>help</B> command were
given instead.
<DT><B>-v</B>, <B>--version[=short]</B><DD>
<A NAME="ixAAF"></A>
Ignore all other arguments, and prints the version of the libvirt library
virsh is coming from
<DT><B>-V</B>, <B>--version=long</B><DD>
<A NAME="ixAAG"></A>
Ignore all other arguments, and prints the version of the libvirt library
virsh is coming from and which options and driver are compiled in.
<DT><B>-c</B>, <B>--connect</B> <I></I><FONT SIZE="-1"><I>URI</I></FONT><I></I><DD>
<A NAME="ixAAH"></A>
Connect to the specified <I></I><FONT SIZE="-1"><I>URI</I></FONT><I></I>, as if by the <B>connect</B> command,
instead of the default connection.
<DT><B>-d</B>, <B>--debug</B> <I></I><FONT SIZE="-1"><I>LEVEL</I></FONT><I></I><DD>
<A NAME="ixAAI"></A>
Enable debug messages at integer <I></I><FONT SIZE="-1"><I>LEVEL</I></FONT><I></I> and above.  <I></I><FONT SIZE="-1"><I>LEVEL</I></FONT><I></I> can
range from 0 to 4 (default).  See the documentation of <B></B><FONT SIZE="-1"><B>VIRSH_DEBUG</B></FONT><B></B>
environment variable for the description of each <I></I><FONT SIZE="-1"><I>LEVEL</I></FONT><I></I>.
<DT><B>-l</B>, <B>--log</B> <I></I><FONT SIZE="-1"><I>FILE</I></FONT><I></I><DD>
<A NAME="ixAAJ"></A>
Output logging details to <I></I><FONT SIZE="-1"><I>FILE</I></FONT><I></I>.
<DT><B>-q</B>, <B>--quiet</B><DD>
<A NAME="ixAAK"></A>
Avoid extra informational messages.
<DT><B>-r</B>, <B>--readonly</B><DD>
<A NAME="ixAAL"></A>
Make the initial connection read-only, as if by the <I>--readonly</I>
option of the <B>connect</B> command.
<DT><B>-t</B>, <B>--timing</B><DD>
<A NAME="ixAAM"></A>
Output elapsed time information for each command.
<DT><B>-e</B>, <B>--escape</B> <I>string</I><DD>
<A NAME="ixAAN"></A>
Set alternative escape sequence for <I>console</I> command. By default,
telnet's <B>^]</B> is used. Allowed characters when using hat notation are:
alphabetic character, @, [, ], \, ^, _.
</DL>
<A NAME="lbAE">&nbsp;</A>
<H2>NOTES</H2>

<A NAME="ixAAO"></A>
Most <B>virsh</B> operations rely upon the libvirt library being able to
connect to an already running libvirtd service.  This can usually be
done using the command <B>service libvirtd start</B>.
<P>

Most <B>virsh</B> commands require root privileges to run due to the
communications channels used to talk to the hypervisor.  Running as
non root will return an error.
<P>

Most <B>virsh</B> commands act synchronously, except maybe shutdown,
setvcpus and setmem. In those cases the fact that the <B>virsh</B>
program returned, may not mean the action is complete and you
must poll periodically to detect that the guest completed the
operation.
<P>

<B>virsh</B> strives for backward compatibility.  Although the <B>help</B>
command only lists the preferred usage of a command, if an older
version of <B>virsh</B> supported an alternate spelling of a command or
option (such as <I>--tunnelled</I> instead of <I>--tunneled</I>), then
scripts using that older spelling will continue to work.
<P>

Several <B>virsh</B> commands take an optionally scaled integer; if no
scale is provided, then the default is listed in the command (for
historical reasons, some commands default to bytes, while other
commands default to kibibytes).  The following case-insensitive
suffixes can be used to select a specfic scale:
<BR>&nbsp;&nbsp;b,&nbsp;byte&nbsp;&nbsp;byte&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1
<BR>&nbsp;&nbsp;<FONT SIZE="-1">KB</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kilobyte&nbsp;&nbsp;1,000
<BR>&nbsp;&nbsp;k,&nbsp;KiB&nbsp;&nbsp;&nbsp;kibibyte&nbsp;&nbsp;1,024
<BR>&nbsp;&nbsp;<FONT SIZE="-1">MB</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;megabyte&nbsp;&nbsp;1,000,000
<BR>&nbsp;&nbsp;M,&nbsp;MiB&nbsp;&nbsp;&nbsp;mebibyte&nbsp;&nbsp;1,048,576
<BR>&nbsp;&nbsp;<FONT SIZE="-1">GB</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gigabyte&nbsp;&nbsp;1,000,000,000
<BR>&nbsp;&nbsp;G,&nbsp;GiB&nbsp;&nbsp;&nbsp;gibibyte&nbsp;&nbsp;1,073,741,824
<BR>&nbsp;&nbsp;<FONT SIZE="-1">TB</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;terabyte&nbsp;&nbsp;1,000,000,000,000
<BR>&nbsp;&nbsp;T,&nbsp;TiB&nbsp;&nbsp;&nbsp;tebibyte&nbsp;&nbsp;1,099,511,627,776
<BR>&nbsp;&nbsp;<FONT SIZE="-1">PB</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;petabyte&nbsp;&nbsp;1,000,000,000,000,000
<BR>&nbsp;&nbsp;P,&nbsp;PiB&nbsp;&nbsp;&nbsp;pebibyte&nbsp;&nbsp;1,125,899,906,842,624
<BR>&nbsp;&nbsp;<FONT SIZE="-1">EB</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exabyte&nbsp;&nbsp;&nbsp;1,000,000,000,000,000,000
<BR>&nbsp;&nbsp;E,&nbsp;EiB&nbsp;&nbsp;&nbsp;exbibyte&nbsp;&nbsp;1,152,921,504,606,846,976
<A NAME="lbAF">&nbsp;</A>
<H2>GENERIC COMMANDS</H2>

<A NAME="ixAAP"></A>
The following commands are generic i.e. not specific to a domain.
<DL COMPACT>
<DT><B>help</B> [<I>command-or-group</I>]<DD>
<A NAME="ixAAQ"></A>
This lists each of the virsh commands.  When used without options, all
commands are listed, one per line, grouped into related categories,
displaying the keyword for each group.


<P>


To display only commands for a specific group, give the keyword for that
group as an option.  For example:


<P>




<PRE>
 virsh # help host

  Host and Hypervisor (help keyword 'host'):
     capabilities                   capabilities
     connect                        (re)connect to hypervisor
     freecell                       NUMA free memory
     hostname                       print the hypervisor hostname
     qemu-attach                    Attach to existing QEMU process
     qemu-monitor-command           QEMU Monitor Command
     sysinfo                        print the hypervisor sysinfo
     uri                            print the hypervisor canonical URI

</PRE>




<P>


To display detailed information for a specific command, give its name as the
option instead.  For example:


<P>




<PRE>
 virsh # help list
   NAME
     list - list domains

   SYNOPSIS
     list [--inactive] [--all]

   DESCRIPTION
     Returns list of domains.

   OPTIONS
     --inactive       list inactive domains
     --all            list inactive &amp; active domains

</PRE>


<DT><B>quit</B>, <B>exit</B><DD>
<A NAME="ixAAR"></A>
quit this interactive terminal
<DT><B>version</B><DD>
<A NAME="ixAAS"></A>
Will print out the major version info about what this built from.
<DL COMPACT><DT><DD>


<P>


<DL COMPACT><DT><DD>
<B>Example</B>


<P>


<B>virsh</B> version


<P>


Compiled against library: libvir 0.0.6


<P>


Using library: libvir 0.0.6


<P>


Using <FONT SIZE="-1">API:</FONT> Xen 3.0.0


<P>


Running hypervisor: Xen 3.0.0
</DL>

</DL>

<DL COMPACT><DT><DD>
</DL>

<DT><B>cd</B> [<I>directory</I>]<DD>
<A NAME="ixAAT"></A>
Will change current directory to <I>directory</I>.  The default directory
for the <B>cd</B> command is the home directory or, if there is no <I></I><FONT SIZE="-1"><I>HOME</I></FONT><I></I>
variable in the environment, the root directory.


<P>


This command is only available in interactive mode.
<DT><B>pwd</B><DD>
<A NAME="ixAAU"></A>
Will print the current directory.
<DT><B>connect</B> <I></I><FONT SIZE="-1"><I>URI</I></FONT><I></I> [<I>--readonly</I>]<DD>
<A NAME="ixAAV"></A>
(Re)-Connect to the hypervisor. When the shell is first started, this
is automatically run with the <I></I><FONT SIZE="-1"><I>URI</I></FONT><I></I> parameter requested by the <TT>&quot;-c&quot;</TT>
option on the command line. The <I></I><FONT SIZE="-1"><I>URI</I></FONT><I></I> parameter specifies how to
connect to the hypervisor. The documentation page at
&lt;<A HREF="http://libvirt.org/uri.html">http://libvirt.org/uri.html</A>&gt; list the values supported, but the most
common are:
<DL COMPACT><DT><DD>
<DL COMPACT>
<DT><A HREF="xen:///">xen:///</A><DD>
<A NAME="ixAAW"></A>
this is used to connect to the local Xen hypervisor, this is the default
<DT><A HREF="qemu:///system">qemu:///system</A><DD>
<A NAME="ixAAX"></A>
connect locally as root to the daemon supervising QEmu and <FONT SIZE="-1">KVM</FONT> domains
<DT><A HREF="qemu:///session">qemu:///session</A><DD>
<A NAME="ixAAY"></A>
connect locally as a normal user to his own set of QEmu and <FONT SIZE="-1">KVM</FONT> domains
<DT><A HREF="lxc:///">lxc:///</A><DD>
<A NAME="ixAAZ"></A>
connect to a local linux container
</DL>
</DL>

<DL COMPACT><DT><DD>


<P>


For remote access see the documentation page on how to make URIs.
The <I>--readonly</I> option allows for read-only connection
</DL>

<DT><B>uri</B><DD>
<A NAME="ixABA"></A>
Prints the hypervisor canonical <FONT SIZE="-1">URI</FONT>, can be useful in shell mode.
<DT><B>hostname</B><DD>
<A NAME="ixABB"></A>
Print the hypervisor hostname.
<DT><B>sysinfo</B><DD>
<A NAME="ixABC"></A>
Print the <FONT SIZE="-1">XML</FONT> representation of the hypervisor sysinfo, if available.
<DT><B>nodeinfo</B><DD>
<A NAME="ixABD"></A>
Returns basic information about the node, like number and type of <FONT SIZE="-1">CPU</FONT>,
and size of the physical memory. The output corresponds to virNodeInfo
structure. Specifically, the ``<FONT SIZE="-1">CPU</FONT> socket(s)'' field means number of <FONT SIZE="-1">CPU</FONT>
sockets per <FONT SIZE="-1">NUMA</FONT> cell.
<DT><B>nodecpustats</B> [<I>cpu</I>] [<I>--percent</I>]<DD>
<A NAME="ixABE"></A>
Returns cpu stats of the node.
If <I>cpu</I> is specified, this will prints specified cpu statistics only.
If <I>--percent</I> is specified, this will prints percentage of each kind of cpu
statistics during 1 second.
<DT><B>nodememstats</B> [<I>cell</I>]<DD>
<A NAME="ixABF"></A>
Returns memory stats of the node.
If <I>cell</I> is specified, this will prints specified cell statistics only.
<DT><B>nodesuspend</B> [<I>target</I>] [<I>duration</I>] [<I>flags</I>]<DD>
<A NAME="ixABG"></A>
Puts the node (host machine) into a system-wide sleep state such as
Suspend-to-RAM, Suspend-to-Disk or Hybrid-Suspend and sets up a
Real-Time-Clock interrupt to fire (to wake up the node) after a time delay
specified by the 'duration' parameter.
<DT><B>capabilities</B><DD>
<A NAME="ixABH"></A>
Print an <FONT SIZE="-1">XML</FONT> document describing the capabilities of the hypervisor
we are currently connected to. This includes a section on the host
capabilities in terms of <FONT SIZE="-1">CPU</FONT> and features, and a set of description
for each kind of guest which can be virtualized. For a more complete
description see:
<BR>&nbsp;&nbsp;&lt;<A HREF="http://libvirt.org/formatcaps.html">http://libvirt.org/formatcaps.html</A>&gt;
The <FONT SIZE="-1">XML</FONT> also show the <FONT SIZE="-1">NUMA</FONT> topology information if available.
<DT><B>inject-nmi</B> <I>domain-id</I><DD>
<A NAME="ixABI"></A>
Inject <FONT SIZE="-1">NMI</FONT> to the guest.
<DT><B>list</B> [<I>--inactive</I> | <I>--all</I>] [<I>--managed-save</I>] [<I>--title</I>] { [<I>--table</I>] | <I>--name</I> | <I>--uuid</I> } [<I>--persistent</I>] [<I>--transient</I>]<DD>
<A NAME="ixABJ"></A>
Prints information about existing domains.  If no options are
specified it prints out information about running domains.


<P>


An example format for the list is as follows:


<P>


<B>virsh</B> list
<BR>&nbsp;Id&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;State


<P>


----------------------------------


<P>




<PRE>
  0 Domain-0             running
  2 fedora               paused

</PRE>




<P>


Name is the name of the domain.  <FONT SIZE="-1">ID</FONT> the domain numeric id.
State is the run state (see below).


<P>


<B></B><FONT SIZE="-1"><B>STATES</B></FONT><B></B>


<P>


The State field lists 7 states for a domain, and which ones the
current domain is in.
<DL COMPACT><DT><DD>
<DL COMPACT>
<DT><B>running</B><DD>
<A NAME="ixABK"></A>
The domain is currently running on a <FONT SIZE="-1">CPU</FONT>
<DT><B>idle</B><DD>
<A NAME="ixABL"></A>
The domain is idle, and not running or runnable.  This can be caused
because the domain is waiting on <FONT SIZE="-1">IO</FONT> (a traditional wait state) or has
gone to sleep because there was nothing else for it to do.
<DT><B>paused</B><DD>
<A NAME="ixABM"></A>
The domain has been paused, usually occurring through the administrator
running <B>virsh suspend</B>.  When in a paused state the domain will still
consume allocated resources like memory, but will not be eligible for
scheduling by the hypervisor.
<DT><B>shutdown</B><DD>
<A NAME="ixABN"></A>
The domain is in the process of shutting down, i.e. the guest operating system
has been notified and should be in the process of stopping its operations
gracefully.
<DT><B>shut off</B><DD>
<A NAME="ixABO"></A>
The domain is not running.  Usually this indicates the domain has been
shut down completely, or has not been started.
<DT><B>crashed</B><DD>
<A NAME="ixABP"></A>
The domain has crashed, which is always a violent ending.  Usually
this state can only occur if the domain has been configured not to
restart on crash.
<DT><B>dying</B><DD>
<A NAME="ixABQ"></A>
The domain is in process of dying, but hasn't completely shutdown or
crashed.
</DL>
</DL>

<DL COMPACT><DT><DD>


<P>


If <I>--managed-save</I> is specified, then domains that have managed save
state (only possible if they are in the <B>shut off</B> state) will
instead show as <B>saved</B> in the listing. This flag is usable only with the
default <I>--table</I> output.


<P>


If <I>--name</I> is specified, domain names are printed instead of the table
formatted one per line. If <I>--uuid</I> is specified domain's <FONT SIZE="-1">UUID</FONT>'s are printed
instead of names. Flag <I>--table</I> specifies that the legacy table-formatted
output should be used. This is the default. All of these are mutually
exclusive.


<P>


Flag <I>--persistent</I> specifies that persistent domains should be printed.
Similarly <I>--transient</I> enables output of transient domains. These flags
may be combined. Default behavior is as though both were specified. (Note that
if any of these flags is specified, the check for the persistence state is done
and may fail. If none of these flags is specified, the check is skipped.)


<P>


If <I>--title</I> is specified, then the short domain description (title) is
printed in an extra column. This flag is usable only with the default
<I>--table</I> output.


<P>


Example:


<P>


<B>virsh</B> list --title
<BR>&nbsp;Id&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Title
<BR>&nbsp;-----------------------------------------------
<BR>&nbsp;&nbsp;0&nbsp;Domain-0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;running&nbsp;&nbsp;&nbsp;&nbsp;Mailserver&nbsp;1
<BR>&nbsp;&nbsp;2&nbsp;fedora&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paused
</DL>

<DT><B>freecell</B> [{ [<I>--cellno</I>] <B>cellno</B> | <I>--all</I> }]<DD>
<A NAME="ixABR"></A>
Prints the available amount of memory on the machine or within a <FONT SIZE="-1">NUMA</FONT>
cell.  The freecell command can provide one of three different
displays of available memory on the machine depending on the options
specified.  With no options, it displays the total free memory on the
machine.  With the --all option, it displays the free memory in each
cell and the total free memory on the machine.  Finally, with a
numeric argument or with --cellno plus a cell number it will display
the free memory for the specified cell only.
<DT><B>cpu-baseline</B> <I></I><FONT SIZE="-1"><I>FILE</I></FONT><I></I><DD>
<A NAME="ixABS"></A>
Compute baseline <FONT SIZE="-1">CPU</FONT> which will be supported by all host CPUs given in &lt;file&gt;.
The list of host CPUs is built by extracting all &lt;cpu&gt; elements from the
&lt;file&gt;. Thus, the &lt;file&gt; can contain either a set of &lt;cpu&gt; elements separated
by new lines or even a set of complete &lt;capabilities&gt; elements printed by
<B>capabilities</B> command.
<DT><B>cpu-compare</B> <I></I><FONT SIZE="-1"><I>FILE</I></FONT><I></I><DD>
<A NAME="ixABT"></A>
Compare <FONT SIZE="-1">CPU</FONT> definition from <FONT SIZE="-1">XML</FONT> &lt;file&gt; with host <FONT SIZE="-1">CPU</FONT>. The <FONT SIZE="-1">XML</FONT> &lt;file&gt; may
contain either host or guest <FONT SIZE="-1">CPU</FONT> definition. The host <FONT SIZE="-1">CPU</FONT> definition is the
&lt;cpu&gt; element and its contents as printed by <B>capabilities</B> command. The
guest <FONT SIZE="-1">CPU</FONT> definition is the &lt;cpu&gt; element and its contents from domain <FONT SIZE="-1">XML</FONT>
definition. For more information on guest <FONT SIZE="-1">CPU</FONT> definition see:
&lt;<A HREF="http://libvirt.org/formatdomain.html#elementsCPU">http://libvirt.org/formatdomain.html#elementsCPU</A>&gt;
<DT><B>echo</B> [<I>--shell</I>] [<I>--xml</I>] [<I>arg</I>...]<DD>
<A NAME="ixABU"></A>
Echo back each <I>arg</I>, separated by space.  If <I>--shell</I> is
specified, then the output will be single-quoted where needed, so that
it is suitable for reuse in a shell context.  If <I>--xml</I> is
specified, then the output will be escaped for use in <FONT SIZE="-1">XML</FONT>.
</DL>
<A NAME="lbAG">&nbsp;</A>
<H2>DOMAIN COMMANDS</H2>

<A NAME="ixABV"></A>
The following commands manipulate domains directly, as stated
previously most commands take domain-id as the first parameter. The
<I>domain-id</I> can be specified as a short integer, a name or a full <FONT SIZE="-1">UUID</FONT>.
<DL COMPACT>
<DT><B>autostart</B> [<I>--disable</I>] <I>domain-id</I><DD>
<A NAME="ixABW"></A>
Configure a domain to be automatically started at boot.


<P>


The option <I>--disable</I> disables autostarting.
<DT><B>console</B> <I>domain-id</I> [<I>devname</I>] [<I>--safe</I>] [<I>--force</I>]<DD>
<A NAME="ixABX"></A>
Connect the virtual serial console for the guest. The optional
<I>devname</I> parameter refers to the device alias of an alternate
console, serial or parallel device configured for the guest.
If omitted, the primary console will be opened.


<P>


If the flag <I>--safe</I> is specified, the connection is only attempted
if the driver supports safe console handling. This flag specifies that
the server has to ensure exclusive access to console devices. Optionally
the <I>--force</I> flag may be specified, requesting to disconnect any existing
sessions, such as in a case of a broken connection.
<DT><B>create</B> <I></I><FONT SIZE="-1"><I>FILE</I></FONT><I></I> [<I>--console</I>] [<I>--paused</I>] [<I>--autodestroy</I>]<DD>
<A NAME="ixABY"></A>
Create a domain from an <FONT SIZE="-1">XML</FONT> &lt;file&gt;. An easy way to create the <FONT SIZE="-1">XML</FONT>
&lt;file&gt; is to use the <B>dumpxml</B> command to obtain the definition of a
pre-existing guest.  The domain will be paused if the <I>--paused</I> option
is used and supported by the driver; otherwise it will be running.
If <I>--console</I> is requested, attach to the console after creation.
If <I>--autodestroy</I> is requested, then the guest will be automatically
destroyed when virsh closes its connection to libvirt, or otherwise
exits.


<P>


<B>Example</B>


<P>




<PRE>
 virsh dumpxml &lt;domain-id&gt; &gt; domain.xml
 vi domain.xml (or make changes with your other text editor)
 virsh create &lt; domain.xml

</PRE>


<DT><B>define</B> <I></I><FONT SIZE="-1"><I>FILE</I></FONT><I></I><DD>
<A NAME="ixABZ"></A>
Define a domain from an <FONT SIZE="-1">XML</FONT> &lt;file&gt;. The domain definition is registered
but not started.  If domain is already running, the changes will take
effect on the next boot.
<DT><B>desc</B> [[<I>--live</I>] [<I>--config</I>] | [<I>--current</I>]] [<I>--title</I>] [<I>--edit</I>] [<I>--new-desc</I> New description or title message]<DD>
<A NAME="ixACA"></A>
Show or modify description and title of a domain. These values are user
fields that allow to store arbitrary textual data to allow easy
identification of domains. Title should be short, although it's not enforced.


<P>


Flags <I>--live</I> or <I>--config</I> select whether this command works on live
or persistent definitions of the domain. If both <I>--live</I> and <I>--config</I>
are specified, the <I>--config</I> option takes precedence on getting the current
description and both live configuration and config are updated while setting
the description. <I>--current</I> is exclusive and implied if none of these was specified.


<P>


Flag <I>--edit</I> specifies that an editor with the contents of current
description or title should be opened and the contents saved back afterwards.


<P>


Flag <I>--title</I> selects operation on the title field instead of description.


<P>


If neither of <I>--edit</I> and <I>--new_desc</I> are specified the note or description
is displayed instead of being modified.
<DT><B>destroy</B> <I>domain-id</I> [<I>--graceful</I>]<DD>
<A NAME="ixACB"></A>
Immediately terminate the domain domain-id.  This doesn't give the domain
<FONT SIZE="-1">OS</FONT> any chance to react, and it's the equivalent of ripping the power
cord out on a physical machine.  In most cases you will want to use
the <B>shutdown</B> command instead.  However, this does not delete any
storage volumes used by the guest, and if the domain is persistent, it
can be restarted later.


<P>


If <I>domain-id</I> is transient, then the metadata of any snapshots will
be lost once the guest stops running, but the snapshot contents still
exist, and a new domain with the same name and <FONT SIZE="-1">UUID</FONT> can restore the
snapshot metadata with <B>snapshot-create</B>.


<P>


If <I>--graceful</I> is specified, don't resort to extreme measures
(e.g. <FONT SIZE="-1">SIGKILL</FONT>) when the guest doesn't stop after a reasonable timeout;
return an error instead.
<DT><B>domblkstat</B> <I>domain</I> <I>block-device</I> [<I>--human</I>]<DD>
<A NAME="ixACC"></A>
Get device block stats for a running domain.  A <I>block-device</I> corresponds
to a unique target name (&lt;target dev='name'/&gt;) or source file (&lt;source
file='name'/&gt;) for one of the disk devices attached to <I>domain</I> (see
also <B>domblklist</B> for listing these names).


<P>


Use <I>--human</I> for a more human readable output.


<P>


Availability of these fields depends on hypervisor. Unsupported fields are
missing from the output. Other fields may appear if communicating with a newer
version of libvirtd.


<P>


<B>Explanation of fields</B> (fields appear in the folowing order):
<BR>&nbsp;&nbsp;rd_req&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;count&nbsp;of&nbsp;read&nbsp;operations
<BR>&nbsp;&nbsp;rd_bytes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;count&nbsp;of&nbsp;read&nbsp;bytes
<BR>&nbsp;&nbsp;wr_req&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;count&nbsp;of&nbsp;write&nbsp;operations
<BR>&nbsp;&nbsp;wr_bytes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;count&nbsp;of&nbsp;written&nbsp;bytes
<BR>&nbsp;&nbsp;errs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;error&nbsp;count
<BR>&nbsp;&nbsp;flush_operations&nbsp;&nbsp;-&nbsp;count&nbsp;of&nbsp;flush&nbsp;operations
<BR>&nbsp;&nbsp;rd_total_times&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;total&nbsp;time&nbsp;read&nbsp;operations&nbsp;took&nbsp;(ns)
<BR>&nbsp;&nbsp;wr_total_times&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;total&nbsp;time&nbsp;write&nbsp;operations&nbsp;took&nbsp;(ns)
<BR>&nbsp;&nbsp;flush_total_times&nbsp;-&nbsp;total&nbsp;time&nbsp;flush&nbsp;operations&nbsp;took&nbsp;(ns)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;--&nbsp;other&nbsp;fields&nbsp;provided&nbsp;by&nbsp;hypervisor&nbsp;--&gt;
<DT><B>domifstat</B> <I>domain</I> <I>interface-device</I><DD>
<A NAME="ixACD"></A>
Get network interface stats for a running domain.
<DT><B>domif-setlink</B> <I>domain</I> <I>interface-device</I> <I>state</I> <I>--persistent</I><DD>
<A NAME="ixACE"></A>
Modify link state of the domain's virtual interface. Possible values for
state are ``up'' and &quot;down. If --persistent is specified, only the persistent
configuration of the domain is modified.
<I>interface-device</I> can be the interface's target name or the <FONT SIZE="-1">MAC</FONT> address.
<DT><B>domif-getlink</B> <I>domain</I> <I>interface-device</I> <I>--persistent</I><DD>
<A NAME="ixACF"></A>
Query link state of the domain's virtual interface. If --persistent
is specified, query the persistent configuration.
<I>interface-device</I> can be the interface's target name or the <FONT SIZE="-1">MAC</FONT> address.
<DT><B>domiftune</B> <I>domain</I> <I>interface-device</I> [[<I>--config</I>] [<I>--live</I>] | [<I>--current</I>]] [<I>--inbound average,peak,burst</I>] [<I>--outbound average,peak,burst</I>]<DD>
<A NAME="ixACG"></A>
Set or query the domain's network interface's bandwidth parameters.
<I>interface-device</I> can be the interface's target name (&lt;target dev='name'/&gt;),
or the <FONT SIZE="-1">MAC</FONT> address.


<P>


If no <I>--inbound</I> or <I>--outbound</I> is specified, this command will
query and show the bandwidth settings. Otherwise, it will set the
inbound or outbound bandwidth. <I>average,peak,burst</I> is the same as
in command <I>attach-interface</I>.


<P>


If <I>--live</I> is specified, affect a running guest.
If <I>--config</I> is specified, affect the next boot of a persistent guest.
If <I>--current</I> is specified, affect the current guest state.
Both <I>--live</I> and <I>--current</I> flags may be given, but <I>--current</I> is
exclusive. If no flag is specified, behavior is different depending
on hypervisor.
<DT><B>dommemstat</B> <I>domain</I><DD>
<A NAME="ixACH"></A>
Get memory stats for a running domain.
<DT><B>domblkerror</B> <I>domain-id</I><DD>
<A NAME="ixACI"></A>
Show errors on block devices.  This command usually comes handy when
<B>domstate</B> command says that a domain was paused due to I/O error.
The <B>domblkerror</B> command lists all block devices in error state and
the error seen on each of them.
<DT><B>domblkinfo</B> <I>domain</I> <I>block-device</I><DD>
<A NAME="ixACJ"></A>
Get block device size info for a domain.  A <I>block-device</I> corresponds
to a unique target name (&lt;target dev='name'/&gt;) or source file (&lt;source
file='name'/&gt;) for one of the disk devices attached to <I>domain</I> (see
also <B>domblklist</B> for listing these names).
<DT><B>domblklist</B> <I>domain</I> [<I>--inactive</I>] [<I>--details</I>]<DD>
<A NAME="ixACK"></A>
Print a table showing the brief information of all block devices
associated with <I>domain</I>. If <I>--inactive</I> is specified, query the
block devices that will be used on the next boot, rather than those
currently in use by a running domain. If <I>--details</I> is specified,
disk type and device value will also be printed. Other contexts
that require a block device name (such as <I>domblkinfo</I> or
<I>snapshot-create</I> for disk snapshots) will accept either target
or unique source names printed by this command.
<DT><B>domiflist</B> <I>domain</I> [<I>--inactive</I>]<DD>
<A NAME="ixACL"></A>
Print a table showing the brief information of all virtual interfaces
associated with <I>domain</I>. If <I>--inactive</I> is specified, query the
virtual interfaces that will be used on the next boot, rather than those
currently in use by a running domain. Other contexts that require a <FONT SIZE="-1">MAC</FONT>
address of virtual interface (such as <I>detach-interface</I> or
<I>domif-setlink</I>) will accept the <FONT SIZE="-1">MAC</FONT> address printed by this command.
<DT><B>blockcopy</B> <I>domain</I> <I>path</I> <I>dest</I> [<I>bandwidth</I>] [<I>--shallow</I>] [<I>--reuse-external</I>] [<I>--raw</I>] [<I>--wait</I> [<I>--verbose] [{--pivot | --finish}] [--timeout </I>seconds<I>] [--async]]</I><DD>
<A NAME="ixACM"></A>
Copy a disk backing image chain to <I>dest</I>. By default, this command
flattens the entire chain; but if <I>--shallow</I> is specified, the copy
shares the backing chain.


<P>


If <I>--reuse-external</I> is specified, then <I>dest</I> must exist and have
contents identical to the resulting backing file (that is, it must
start with contents matching the backing file <I>disk</I> if <I>--shallow</I>
is used, otherwise it must start empty); this option is typically used
to set up a relative backing file name in the destination.


<P>


The format of the destination is determined by the first match in the
following list: if <I>--raw</I> is specified, it will be raw; if
<I>--reuse-external</I> is specified, the existing destination is probed
for a format; and in all other cases, the destination format will
match the source format.


<P>


By default, the copy job runs in the background, and consists of two
phases.  Initially, the job must copy all data from the source, and
during this phase, the job can only be canceled to revert back to the
source disk, with no guarantees about the destination.  After this phase
completes, both the source and the destination remain mirrored until a
call to <B>blockjob</B> with the <I>--abort</I> and <I>--pivot</I> flags pivots over
to the copy, or a call without <I>--pivot</I> leaves the destination as a
faithful copy of that point in time.  However, if <I>--wait</I> is specified,
then this command will block until the mirroring phase begins, or cancel
the operation if the optional <I>timeout</I> in seconds elapses or <FONT SIZE="-1">SIGINT</FONT> is
sent (usually with <TT>&quot;Ctrl-C&quot;</TT>).  Using <I>--verbose</I> along with <I>--wait</I>
will produce periodic status updates.  Using <I>--pivot</I> or <I>--finish</I>
along with <I>--wait</I> will additionally end the job cleanly rather than
leaving things in the mirroring phase.  If job cancellation is triggered,
<I>--async</I> will return control to the user as fast as possible, otherwise
the command may continue to block a little while longer until the job
is done cleaning up.


<P>


<I>path</I> specifies fully-qualified path of the disk.
<I>bandwidth</I> specifies copying bandwidth limit in Mbps.
<DT><B>blockpull</B> <I>domain</I> <I>path</I> [<I>bandwidth</I>] [<I>base</I>] [<I>--wait</I> [<I>--verbose</I>] [<I>--timeout</I> <B>seconds</B>] [<I>--async]]</I><DD>
<A NAME="ixACN"></A>
Populate a disk from its backing image chain. By default, this command
flattens the entire chain; but if <I>base</I> is specified, containing the
name of one of the backing files in the chain, then that file becomes
the new backing file and only the intermediate portion of the chain is
pulled.  Once all requested data from the backing image chain has been
pulled, the disk no longer depends on that portion of the backing chain.


<P>


By default, this command returns as soon as possible, and data for
the entire disk is pulled in the background; the progress of the
operation can be checked with <B>blockjob</B>.  However, if <I>--wait</I> is
specified, then this command will block until the operation completes,
or cancel the operation if the optional <I>timeout</I> in seconds elapses
or <FONT SIZE="-1">SIGINT</FONT> is sent (usually with <TT>&quot;Ctrl-C&quot;</TT>).  Using <I>--verbose</I> along
with <I>--wait</I> will produce periodic status updates.  If job cancellation
is triggered, <I>--async</I> will return control to the user as fast as
possible, otherwise the command may continue to block a little while
longer until the job is done cleaning up.


<P>


<I>path</I> specifies fully-qualified path of the disk; it corresponds
to a unique target name (&lt;target dev='name'/&gt;) or source file (&lt;source
file='name'/&gt;) for one of the disk devices attached to <I>domain</I> (see
also <B>domblklist</B> for listing these names).
<I>bandwidth</I> specifies copying bandwidth limit in Mbps.
<DT><B>blkdeviotune</B> <I>domain</I> <I>device</I> [[<I>--config</I>] [<I>--live</I>] | [<I>--current</I>]] [[<I>total-bytes-sec</I>] | [<I>read-bytes-sec</I>] [<I>write-bytes-sec</I>]] [[<I>total-iops-sec</I>] | [<I>read-iops-sec</I>] [<I>write-iops-sec</I>]]<DD>
<A NAME="ixACO"></A>
Set or query the block disk io parameters for a block device of <I>domain</I>.
<I>device</I> specifies a unique target name (&lt;target dev='name'/&gt;) or source
file (&lt;source file='name'/&gt;) for one of the disk devices attached to
<I>domain</I> (see also <B>domblklist</B> for listing these names).


<P>


If no limit is specified, it will query current I/O limits setting.
Otherwise, alter the limits with these flags:
<I>--total-bytes-sec</I> specifies total throughput limit in bytes per second.
<I>--read-bytes-sec</I> specifies read throughput limit in bytes per second.
<I>--write-bytes-sec</I> specifies write throughput limit in bytes per second.
<I>--total-iops-sec</I> specifies total I/O operations limit per second.
<I>--read-iops-sec</I> specifies read I/O operations limit per second.
<I>--write-iops-sec</I> specifies write I/O operations limit per second.


<P>


Older versions of virsh only accepted these options with underscore
instead of dash, as in <I>--total_bytes_sec</I>.


<P>


Bytes and iops values are independent, but setting only one value (such
as --read-bytes-sec) resets the other two in that category to unlimited.
An explicit 0 also clears any limit.  A non-zero value for a given total
cannot be mixed with non-zero values for read or write.


<P>


If <I>--live</I> is specified, affect a running guest.
If <I>--config</I> is specified, affect the next boot of a persistent guest.
If <I>--current</I> is specified, affect the current guest state.
Both <I>--live</I> and <I>--current</I> flags may be given, but <I>--current</I> is
exclusive. If no flag is specified, behavior is different depending
on hypervisor.
<DT><B>blockjob</B> <I>domain</I> <I>path</I> { [<I>--abort</I>] [<I>--async</I>] [<I>--pivot</I>] | [<I>--info</I>] | [<I>bandwidth</I>] }<DD>
<A NAME="ixACP"></A>
Manage active block operations.  There are three modes: <I>--info</I>,
<I>bandwidth</I>, and <I>--abort</I>; <I>--info</I> is default except that <I>--async</I>
or <I>--pivot</I> implies <I>--abort</I>.


<P>


<I>path</I> specifies fully-qualified path of the disk; it corresponds
to a unique target name (&lt;target dev='name'/&gt;) or source file (&lt;source
file='name'/&gt;) for one of the disk devices attached to <I>domain</I> (see
also <B>domblklist</B> for listing these names).


<P>


If <I>--abort</I> is specified, the active job on the specified disk will
be aborted.  If <I>--async</I> is also specified, this command will return
immediately, rather than waiting for the cancelation to complete.  If
<I>--pivot</I> is specified, this requests that an active copy job
be pivoted over to the new copy.
If <I>--info</I> is specified, the active job information on the specified
disk will be printed.
<I>bandwidth</I> can be used to set bandwidth limit for the active job.
<DT><B>blockresize</B> <I>domain</I> <I>path</I> <I>size</I><DD>
<A NAME="ixACQ"></A>
Resize a block device of domain while the domain is running, <I>path</I>
specifies the absolute path of the block device; it corresponds
to a unique target name (&lt;target dev='name'/&gt;) or source file (&lt;source
file='name'/&gt;) for one of the disk devices attached to <I>domain</I> (see
also <B>domblklist</B> for listing these names).


<P>


<I>size</I> is a scaled integer (see <B></B><FONT SIZE="-1"><B>NOTES</B></FONT><B></B> above) which defaults to KiB
(blocks of 1024 bytes) if there is no suffix.  You must use a suffix of
``B'' to get bytes (note that for historical reasons, this differs from
<B>vol-resize</B> which defaults to bytes without a suffix).
<DT><B>dominfo</B> <I>domain-id</I><DD>
<A NAME="ixACR"></A>
Returns basic information about the domain.
<DT><B>domuuid</B> <I>domain-name-or-id</I><DD>
<A NAME="ixACS"></A>
Convert a domain name or id to domain <FONT SIZE="-1">UUID</FONT>
<DT><B>domid</B> <I>domain-name-or-uuid</I><DD>
<A NAME="ixACT"></A>
Convert a domain name (or <FONT SIZE="-1">UUID</FONT>) to a domain id
<DT><B>domjobabort</B> <I>domain-id-or-uuid</I><DD>
<A NAME="ixACU"></A>
Abort the currently running domain job.
<DT><B>domjobinfo</B> <I>domain-id-or-uuid</I><DD>
<A NAME="ixACV"></A>
Returns information about jobs running on a domain.
<DT><B>domname</B> <I>domain-id-or-uuid</I><DD>
<A NAME="ixACW"></A>
Convert a domain Id (or <FONT SIZE="-1">UUID</FONT>) to domain name
<DT><B>domstate</B> <I>domain-id</I> [<I>--reason</I>]<DD>
<A NAME="ixACX"></A>
Returns state about a domain.  <I>--reason</I> tells virsh to also print
reason for the state.
<DT><B>domcontrol</B> <I>domain-id</I><DD>
<A NAME="ixACY"></A>
Returns state of an interface to <FONT SIZE="-1">VMM</FONT> used to control a domain.  For
states other than ``ok'' or ``error'' the command also prints number of
seconds elapsed since the control interface entered its current state.
<DT><B>domxml-from-native</B> <I>format</I> <I>config</I><DD>
<A NAME="ixACZ"></A>
Convert the file <I>config</I> in the native guest configuration format
named by <I>format</I> to a domain <FONT SIZE="-1">XML</FONT> format. For <FONT SIZE="-1">QEMU/KVM</FONT> hypervisor,
the <I>format</I> argument must be <B>qemu-argv</B>. For Xen hypervisor, the
<I>format</I> argument may be <B>xen-xm</B> or <B>xen-sxpr</B>.
<DT><B>domxml-to-native</B> <I>format</I> <I>xml</I><DD>
<A NAME="ixADA"></A>
Convert the file <I>xml</I> in domain <FONT SIZE="-1">XML</FONT> format to the native guest
configuration format named by <I>format</I>. For <FONT SIZE="-1">QEMU/KVM</FONT> hypervisor,
the <I>format</I> argument must be <B>qemu-argv</B>. For Xen hypervisor, the
<I>format</I> argument may be <B>xen-xm</B> or <B>xen-sxpr</B>.
<DT><B>dump</B> <I>domain-id</I> <I>corefilepath</I> [<I>--bypass-cache</I>] { [<I>--live</I>] | [<I>--crash</I>] | [<I>--reset</I>] } [<I>--verbose</I>]<DD>
<A NAME="ixADB"></A>
Dumps the core of a domain to a file for analysis.
If <I>--live</I> is specified, the domain continues to run until the core
dump is complete, rather than pausing up front.
If <I>--crash</I> is specified, the domain is halted with a crashed status,
rather than merely left in a paused state.
If <I>--reset</I> is specified, the domain is reset after successful dump.
Note, these three switches are mutually exclusive.
If <I>--bypass-cache</I> is specified, the save will avoid the file system
cache, although this may slow down the operation.


<P>


The progress may be monitored using <B>domjobinfo</B> virsh command and canceled
with <B>domjobabort</B> command (sent by another virsh instance). Another option
is to send <FONT SIZE="-1">SIGINT</FONT> (usually with <TT>&quot;Ctrl-C&quot;</TT>) to the virsh process running
<B>dump</B> command. <I>--verbose</I> displays the progress of dump.


<P>


<FONT SIZE="-1">NOTE:</FONT> Some hypervisors may require the user to manually ensure proper
permissions on file and path specified by argument <I>corefilepath</I>.
<DT><B>dumpxml</B> <I>domain-id</I> [<I>--inactive</I>] [<I>--security-info</I>] [<I>--update-cpu</I>]<DD>
<A NAME="ixADC"></A>
Output the domain information as an <FONT SIZE="-1">XML</FONT> dump to stdout, this format can be used
by the <B>create</B> command. Additional options affecting the <FONT SIZE="-1">XML</FONT> dump may be
used. <I>--inactive</I> tells virsh to dump domain configuration that will be used
on next start of the domain as opposed to the current domain configuration.
Using <I>--security-info</I> will also include security sensitive information
in the <FONT SIZE="-1">XML</FONT> dump. <I>--update-cpu</I> updates domain <FONT SIZE="-1">CPU</FONT> requirements according to
host <FONT SIZE="-1">CPU</FONT>.
<DT><B>edit</B> <I>domain-id</I><DD>
<A NAME="ixADD"></A>
Edit the <FONT SIZE="-1">XML</FONT> configuration file for a domain, which will affect the
next boot of the guest.


<P>


This is equivalent to:


<P>




<PRE>
 virsh dumpxml --inactive --security-info domain &gt; domain.xml
 vi domain.xml (or make changes with your other text editor)
 virsh define domain.xml

</PRE>




<P>


except that it does some error checking.


<P>


The editor used can be supplied by the <TT>$VISUAL</TT> or <TT>$EDITOR</TT> environment
variables, and defaults to <TT>&quot;vi&quot;</TT>.
<DT><B>managedsave</B> <I>domain-id</I> [<I>--bypass-cache</I>] [{<I>--running</I> | <I>--paused</I>}] [<I>--verbose</I>]<DD>
<A NAME="ixADE"></A>
Save and destroy (stop) a running domain, so it can be restarted from the same
state at a later time.  When the virsh <B>start</B> command is next run for
the domain, it will automatically be started from this saved state.
If <I>--bypass-cache</I> is specified, the save will avoid the file system
cache, although this may slow down the operation.


<P>


The progress may be monitored using <B>domjobinfo</B> virsh command and canceled
with <B>domjobabort</B> command (sent by another virsh instance). Another option
is to send <FONT SIZE="-1">SIGINT</FONT> (usually with <TT>&quot;Ctrl-C&quot;</TT>) to the virsh process running
<B>managedsave</B> command. <I>--verbose</I> displays the progress of save.


<P>


Normally, starting a managed save will decide between running or paused
based on the state the domain was in when the save was done; passing
either the <I>--running</I> or <I>--paused</I> flag will allow overriding which
state the <B>start</B> should use.


<P>


The <B>dominfo</B> command can be used to query whether a domain currently
has any managed save image.
<DT><B>managedsave-remove</B> <I>domain-id</I><DD>
<A NAME="ixADF"></A>
Remove the <B>managedsave</B> state file for a domain, if it exists.  This
ensures the domain will do a full boot the next time it is started.
<DT><B>maxvcpus</B> [<I>type</I>]<DD>
<A NAME="ixADG"></A>
Provide the maximum number of virtual CPUs supported for a guest <FONT SIZE="-1">VM</FONT> on
this connection.  If provided, the <I>type</I> parameter must be a valid
type attribute for the &lt;domain&gt; element of <FONT SIZE="-1">XML</FONT>.
<DT><B>cpu-stats</B> <I>domain</I> [<I>--total</I>] [<I>start</I>] [<I>count</I>]<DD>
<A NAME="ixADH"></A>
Provide cpu statistics information of a domain. The domain should
be running. Default it shows stats for all CPUs, and a total. Use
<I>--total</I> for only the total stats, <I>start</I> for only the per-cpu
stats of the CPUs from <I>start</I>, <I>count</I> for only <I>count</I> CPUs'
stats.
<DT><B>migrate</B> [<I>--live</I>] [<I>--direct</I>] [<I>--p2p</I> [<I>--tunnelled</I>]] [<I>--persistent</I>] [<I>--undefinesource</I>] [<I>--suspend</I>] [<I>--copy-storage-all</I>] [<I>--copy-storage-inc</I>] [<I>--change-protection</I>] [<I>--unsafe</I>] [<I>--verbose</I>] <I>domain-id</I> <I>desturi</I> [<I>migrateuri</I>] [<I>dname</I>] [<I>--timeout</I> <B>seconds</B>] [<I>--xml</I> <B>file</B>]<DD>
<A NAME="ixADI"></A>
Migrate domain to another host.  Add <I>--live</I> for live migration; <I>--p2p</I>
for peer-2-peer migration; <I>--direct</I> for direct migration; or <I>--tunnelled</I>
for tunnelled migration.  <I>--persistent</I> leaves the domain persistent on
destination host, <I>--undefinesource</I> undefines the domain on the source host,
and <I>--suspend</I> leaves the domain paused on the destination host.
<I>--copy-storage-all</I> indicates migration with non-shared storage with full
disk copy, <I>--copy-storage-inc</I> indicates migration with non-shared storage
with incremental copy (same base image shared between source and destination).
In both cases the disk images have to exist on destination host, the
<I>--copy-storage-...</I> options only tell libvirt to transfer data from the
images on source host to the images found at the same place on the destination
host. <I>--change-protection</I> enforces that no incompatible configuration
changes will be made to the domain while the migration is underway; this flag
is implicitly enabled when supported by the hypervisor, but can be explicitly
used to reject the migration if the hypervisor lacks change protection
support.  <I>--verbose</I> displays the progress of migration.


<P>


In some cases libvirt may refuse to migrate the domain because doing so may
lead to potential problems such as data corruption, and thus the migration is
considered unsafe. For <FONT SIZE="-1">QEMU</FONT> domain, this may happen if the domain uses disks
without explicitly setting cache mode to ``none''. Migrating such domains is
unsafe unless the disk images are stored on coherent clustered filesystem,
such as <FONT SIZE="-1">GFS2</FONT> or <FONT SIZE="-1">GPFS</FONT>. If you are sure the migration is safe or you just do not
care, use <I>--unsafe</I> to force the migration.


<P>


The <I>desturi</I> is the connection <FONT SIZE="-1">URI</FONT> of the destination host, and
<I>migrateuri</I> is the migration <FONT SIZE="-1">URI</FONT>, which usually can be omitted.
<I>dname</I> is used for renaming the domain to new name during migration, which
also usually can be omitted.  Likewise, <I>--xml</I> <B>file</B> is usually
omitted, but can be used to supply an alternative <FONT SIZE="-1">XML</FONT> file for use on
the destination to supply a larger set of changes to any host-specific
portions of the domain <FONT SIZE="-1">XML</FONT>, such as accounting for naming differences
between source and destination in accessing underlying storage.


<P>


<I>--timeout</I> <B>seconds</B> forces guest to suspend when live migration exceeds
that many seconds, and
then the migration will complete offline. It can only be used with <I>--live</I>.


<P>


Running migration can be canceled by interrupting virsh (usually using
<TT>&quot;Ctrl-C&quot;</TT>) or by <B>domjobabort</B> command sent from another virsh instance.


<P>


<B>Note</B>: The <I>desturi</I> parameter for normal migration and peer2peer migration
has different semantics:
<DL COMPACT><DT><DD>
<DL COMPACT>
<DT>*<DD>
normal migration: the <I>desturi</I> is an address of the target host as
seen from the client machine.
<DT>*<DD>
peer2peer migration: the <I>desturi</I> is an address of the target host as
seen from the source machine.
</DL>
</DL>

<DL COMPACT><DT><DD>
</DL>

<DT><B>migrate-setmaxdowntime</B> <I>domain-id</I> <I>downtime</I><DD>
<A NAME="ixADJ"></A>
Set maximum tolerable downtime for a domain which is being live-migrated to
another host.  The <I>downtime</I> is a number of milliseconds the guest is allowed
to be down at the end of live migration.
<DT><B>migrate-setspeed</B> <I>domain-id</I> <I>bandwidth</I><DD>
<A NAME="ixADK"></A>
Set the maximum migration bandwidth (in Mbps) for a domain which is being
migrated to another host.
<DT><B>migrate-getspeed</B> <I>domain-id</I><DD>
<A NAME="ixADL"></A>
Get the maximum migration bandwidth (in Mbps) for a domain.
<DT><B>numatune</B> <I>domain</I> [<I>--mode</I> <B>mode</B>] [<I>--nodeset</I> <B>nodeset</B>] [[<I>--config</I>] [<I>--live</I>] | [<I>--current</I>]]<DD>
<A NAME="ixADM"></A>
Set or get a domain's numa parameters, corresponding to the &lt;numatune&gt;
element of domain <FONT SIZE="-1">XML</FONT>.  Without flags, the current settings are
displayed.


<P>


<I>mode</I> can be one of `strict', `interleave' and `preferred'.  For a
running domain, the mode can't be changed, and the nodeset can be
changed only if the domain was started with a mode of `strict'.


<P>


<I>nodeset</I> is a list of numa nodes used by the host for running the domain.
Its syntax is a comma separated list, with '-' for ranges and '^' for
excluding a node.


<P>


If <I>--live</I> is specified, set scheduler information of a running guest.
If <I>--config</I> is specified, affect the next boot of a persistent guest.
If <I>--current</I> is specified, affect the current guest state.
<DT><B>reboot</B> <I>domain-id</I> [<I>--mode acpi|agent</I>]<DD>
<A NAME="ixADN"></A>
Reboot a domain.  This acts just as if the domain had the <B>reboot</B>
command run from the console.  The command returns as soon as it has
executed the reboot action, which may be significantly before the
domain actually reboots.


<P>


The exact behavior of a domain when it reboots is set by the
<I>on_reboot</I> parameter in the domain's <FONT SIZE="-1">XML</FONT> definition.


<P>


By default the hypervisor will try to pick a suitable shutdown
method. To specify an alternative method, the <I>--mode</I> parameter
can specify <TT>&quot;acpi&quot;</TT> or <TT>&quot;agent&quot;</TT>.
<DT><B>reset</B> <I>domain-id</I><DD>
<A NAME="ixADO"></A>
Reset a domain immediately without any guest shutdown. <B>reset</B>
emulates the power reset button on a machine, where all guest
hardware sees the <FONT SIZE="-1">RST</FONT> line set and reinitializes internal state.


<P>


<B>Note</B>: Reset without any guest <FONT SIZE="-1">OS</FONT> shutdown risks data loss.
<DT><B>restore</B> <I>state-file</I> [<I>--bypass-cache</I>] [<I>--xml</I> <B>file</B>] [{<I>--running</I> | <I>--paused</I>}]<DD>
<A NAME="ixADP"></A>
Restores a domain from a <B>virsh save</B> state file. See <I>save</I> for more info.


<P>


If <I>--bypass-cache</I> is specified, the restore will avoid the file system
cache, although this may slow down the operation.


<P>


<I>--xml</I> <B>file</B> is usually omitted, but can be used to supply an
alternative <FONT SIZE="-1">XML</FONT> file for use on the restored guest with changes only
in the host-specific portions of the domain <FONT SIZE="-1">XML</FONT>.  For example, it can
be used to account for file naming differences in underlying storage
due to disk snapshots taken after the guest was saved.


<P>


Normally, restoring a saved image will use the state recorded in the
save image to decide between running or paused; passing either the
<I>--running</I> or <I>--paused</I> flag will allow overriding which state the
domain should be started in.


<P>


<B>Note</B>: To avoid corrupting file system contents within the domain, you
should not reuse the saved state file for a second <B>restore</B> unless you
have also reverted all storage volumes back to the same contents as when
the state file was created.
<DT><B>save</B> <I>domain-id</I> <I>state-file</I> [<I>--bypass-cache</I>] [<I>--xml</I> <B>file</B>] [{<I>--running</I> | <I>--paused</I>}] [<I>--verbose</I>]<DD>
<A NAME="ixADQ"></A>
Saves a running domain (<FONT SIZE="-1">RAM</FONT>, but not disk state) to a state file so that
it can be restored
later.  Once saved, the domain will no longer be running on the
system, thus the memory allocated for the domain will be free for
other domains to use.  <B>virsh restore</B> restores from this state file.
If <I>--bypass-cache</I> is specified, the save will avoid the file system
cache, although this may slow down the operation.


<P>


The progress may be monitored using <B>domjobinfo</B> virsh command and canceled
with <B>domjobabort</B> command (sent by another virsh instance). Another option
is to send <FONT SIZE="-1">SIGINT</FONT> (usually with <TT>&quot;Ctrl-C&quot;</TT>) to the virsh process running
<B>save</B> command. <I>--verbose</I> displays the progress of save.


<P>


This is roughly equivalent to doing a hibernate on a running computer,
with all the same limitations.  Open network connections may be
severed upon restore, as <FONT SIZE="-1">TCP</FONT> timeouts may have expired.


<P>


<I>--xml</I> <B>file</B> is usually omitted, but can be used to supply an
alternative <FONT SIZE="-1">XML</FONT> file for use on the restored guest with changes only
in the host-specific portions of the domain <FONT SIZE="-1">XML</FONT>.  For example, it can
be used to account for file naming differences that are planned to
be made via disk snapshots of underlying storage after the guest is saved.


<P>


Normally, restoring a saved image will decide between running or paused
based on the state the domain was in when the save was done; passing
either the <I>--running</I> or <I>--paused</I> flag will allow overriding which
state the <B>restore</B> should use.


<P>


Domain saved state files assume that disk images will be unchanged
between the creation and restore point.  For a more complete system
restore point, where the disk state is saved alongside the memory
state, see the <B>snapshot</B> family of commands.
<DT><B>save-image-define</B> <I>file</I> <I>xml</I> [{<I>--running</I> | <I>--paused</I>}]<DD>
<A NAME="ixADR"></A>
Update the domain <FONT SIZE="-1">XML</FONT> that will be used when <I>file</I> is later
used in the <B>restore</B> command.  The <I>xml</I> argument must be a file
name containing the alternative <FONT SIZE="-1">XML</FONT>, with changes only in the
host-specific portions of the domain <FONT SIZE="-1">XML</FONT>.  For example, it can
be used to account for file naming differences resulting from creating
disk snapshots of underlying storage after the guest was saved.


<P>


The save image records whether the domain should be restored to a
running or paused state.  Normally, this command does not alter the
recorded state; passing either the <I>--running</I> or <I>--paused</I> flag
will allow overriding which state the <B>restore</B> should use.
<DT><B>save-image-dumpxml</B> <I>file</I> [<I>--security-info</I>]<DD>
<A NAME="ixADS"></A>
Extract the domain <FONT SIZE="-1">XML</FONT> that was in effect at the time the saved state
file <I>file</I> was created with the <B>save</B> command.  Using
<I>--security-info</I> will also include security sensitive information.
<DT><B>save-image-edit</B> <I>file</I> [{<I>--running</I> | <I>--paused</I>}]<DD>
<A NAME="ixADT"></A>
Edit the <FONT SIZE="-1">XML</FONT> configuration associated with a saved state file <I>file</I>
created by the <B>save</B> command.


<P>


The save image records whether the domain should be restored to a
running or paused state.  Normally, this command does not alter the
recorded state; passing either the <I>--running</I> or <I>--paused</I> flag
will allow overriding which state the <B>restore</B> should use.


<P>


This is equivalent to:


<P>




<PRE>
 virsh save-image-dumpxml state-file &gt; state-file.xml
 vi state-file.xml (or make changes with your other text editor)
 virsh save-image-define state-file state-file-xml

</PRE>




<P>


except that it does some error checking.


<P>


The editor used can be supplied by the <TT>$VISUAL</TT> or <TT>$EDITOR</TT> environment
variables, and defaults to <TT>&quot;vi&quot;</TT>.
<DT><B>schedinfo</B> [<I>--set</I> <B>parameter=value</B>] <I>domain-id</I> [[<I>--config</I>] [<I>--live</I>] | [<I>--current</I>]]<DD>
<A NAME="ixADU"></A>

<DT><B>schedinfo</B> [<I>--weight</I> <B>number</B>] [<I>--cap</I> <B>number</B>] <I>domain-id</I><DD>
<A NAME="ixADV"></A>

Allows you to show (and set) the domain scheduler parameters. The parameters
available for each hypervisor are:


<P>


<FONT SIZE="-1">LXC</FONT> (posix scheduler) : cpu_shares


<P>


<FONT SIZE="-1">QEMU/KVM</FONT> (posix scheduler): cpu_shares, vcpu_period, vcpu_quota


<P>


Xen (credit scheduler): weight, cap


<P>


<FONT SIZE="-1">ESX</FONT> (allocation scheduler): reservation, limit, shares


<P>


If <I>--live</I> is specified, set scheduler information of a running guest.
If <I>--config</I> is specified, affect the next boot of a persistent guest.
If <I>--current</I> is specified, affect the current guest state.


<P>


<B>Note</B>: The cpu_shares parameter has a valid value range of 0-262144; Negative
values are wrapped to positive, and larger values are capped at the maximum.
Therefore, -1 is a useful shorthand for 262144. On the Linux kernel, the
values 0 and 1 are automatically converted to a minimal value of 2.


<P>


<B>Note</B>: The weight and cap parameters are defined only for the
<FONT SIZE="-1">XEN_CREDIT</FONT> scheduler and are now <I></I><FONT SIZE="-1"><I>DEPRECATED</I></FONT><I></I>.


<P>


<B>Note</B>: The vcpu_period parameter has a valid value range of 1000-1000000 or
0, and the vcpu_quota parameter has a valid value range of
1000-18446744073709551 or less than 0. The value 0 for either parameter is
the same as not specifying that parameter.
<DT><B>screenshot</B> <I>domain-id</I> [<I>imagefilepath</I>] [<I>--screen</I> <B>screenID</B>]<DD>
<A NAME="ixADW"></A>
Takes a screenshot of a current domain console and stores it into a file.
Optionally, if hypervisor supports more displays for a domain, <I>screenID</I>
allows to specify which screen will be captured. It is the sequential number
of screen. In case of multiple graphics cards, heads are enumerated before
devices, e.g. having two graphics cards, both with four heads, screen <FONT SIZE="-1">ID</FONT> 5
addresses the second head on the second card.
<DT><B>send-key</B> <I>domain-id</I> [<I>--codeset</I> <B>codeset</B>] [<I>--holdtime</I> <B>holdtime</B>] <I>keycode</I>...<DD>
<A NAME="ixADX"></A>
Parse the <I>keycode</I> sequence as keystrokes to send to <I>domain-id</I>.
Each <I>keycode</I> can either be a numeric value or a symbolic name from
the corresponding codeset.  If <I>--holdtime</I> is given, each keystroke
will be held for that many milliseconds.  The default codeset is
<B>linux</B>, but use of the <I>--codeset</I> option allows other codesets to
be chosen.
<DL COMPACT><DT><DD>
<DL COMPACT>
<DT><B>linux</B><DD>
<A NAME="ixADY"></A>
The numeric values are those defined by the Linux generic input
event subsystem. The symbolic names match the corresponding
Linux key constant macro names.
<DT><B>xt</B><DD>
<A NAME="ixADZ"></A>
The numeric values are those defined by the original <FONT SIZE="-1">XT</FONT> keyboard
controller. No symbolic names are provided
<DT><B>atset1</B><DD>
<A NAME="ixAEA"></A>
The numeric values are those defined by the <FONT SIZE="-1">AT</FONT> keyboard controller,
set 1 (aka <FONT SIZE="-1">XT</FONT> compatible set). Extended keycoes from <B>atset1</B>
may differ from extended keycodes in the <B>xt</B> codeset. No symbolic
names are provided
<DT><B>atset2</B><DD>
<A NAME="ixAEB"></A>
The numeric values are those defined by the <FONT SIZE="-1">AT</FONT> keyboard controller,
set 2. No symbolic names are provided
<DT><B>atset3</B><DD>
<A NAME="ixAEC"></A>
The numeric values are those defined by the <FONT SIZE="-1">AT</FONT> keyboard controller,
set 3 (aka <FONT SIZE="-1">PS/2</FONT> compatible set). No symbolic names are provided
<DT><B>os_x</B><DD>
<A NAME="ixAED"></A>
The numeric values are those defined by the OS-X keyboard input
subsystem. The symbolic names match the corresponding OS-X key
constant macro names
<DT><B>xt_kbd</B><DD>
<A NAME="ixAEE"></A>
The numeric values are those defined by the Linux <FONT SIZE="-1">KBD</FONT> device.
These are a variant on the original <FONT SIZE="-1">XT</FONT> codeset, but often with
different encoding for extended keycodes. No symbolic names are
provided.
<DT><B>win32</B><DD>
<A NAME="ixAEF"></A>
The numeric values are those defined by the Win32 keyboard input
subsystem. The symbolic names match the corresponding Win32 key
constant macro names
<DT><B>usb</B><DD>
<A NAME="ixAEG"></A>
The numeric values are those defined by the <FONT SIZE="-1">USB</FONT> <FONT SIZE="-1">HID</FONT> specification
for keyboard input. No symbolic names are provided
<DT><B>rfb</B><DD>
<A NAME="ixAEH"></A>
The numeric values are those defined by the <FONT SIZE="-1">RFB</FONT> extension for sending
raw keycodes. These are a variant on the <FONT SIZE="-1">XT</FONT> codeset, but extended
keycodes have the low bit of the second byte set, instead of the high
bit of the first byte. No symbolic names are provided.
</DL>
</DL>

<DL COMPACT><DT><DD>


<P>


<B>Examples</B>
<BR>&nbsp;&nbsp;#&nbsp;send&nbsp;three&nbsp;strokes&nbsp;'k',&nbsp;'e',&nbsp;'y',&nbsp;using&nbsp;xt&nbsp;codeset
<BR>&nbsp;&nbsp;virsh&nbsp;send-key&nbsp;dom&nbsp;--codeset&nbsp;xt&nbsp;37&nbsp;18&nbsp;21
<BR>&nbsp;&nbsp;#&nbsp;send&nbsp;one&nbsp;stroke&nbsp;'right-ctrl+C'
<BR>&nbsp;&nbsp;virsh&nbsp;send-key&nbsp;dom&nbsp;<FONT SIZE="-1">KEY_RIGHTCTRL</FONT>&nbsp;<FONT SIZE="-1">KEY_C</FONT>
<BR>&nbsp;&nbsp;#&nbsp;send&nbsp;a&nbsp;tab,&nbsp;held&nbsp;for&nbsp;1&nbsp;second
<BR>&nbsp;&nbsp;virsh&nbsp;send-key&nbsp;--holdtime&nbsp;1000&nbsp;0xf
</DL>

<DT><B>setmem</B> <I>domain-id</I> <B>size</B> [[<I>--config</I>] [<I>--live</I>] | [<I>--current</I>]]<DD>
<A NAME="ixAEI"></A>
Change the memory allocation for a guest domain.
If <I>--live</I> is specified, perform a memory balloon of a running guest.
If <I>--config</I> is specified, affect the next boot of a persistent guest.
If <I>--current</I> is specified, affect the current guest state.
Both <I>--live</I> and <I>--config</I> flags may be given, but <I>--current</I> is
exclusive. If no flag is specified, behavior is different depending
on hypervisor.


<P>


<I>size</I> is a scaled integer (see <B></B><FONT SIZE="-1"><B>NOTES</B></FONT><B></B> above); it defaults to kibibytes
(blocks of 1024 bytes) unless you provide a suffix (and the older option
name <I>--kilobytes</I> is available as a deprecated synonym) .  Libvirt rounds
up to the nearest kibibyte.  Some hypervisors require a larger granularity
than KiB, and requests that are not an even multiple will be rounded up.
For example, vSphere/ESX rounds the parameter up to mebibytes (1024 kibibytes).


<P>


For Xen, you can only adjust the memory of a running domain if the domain is
paravirtualized or running the <FONT SIZE="-1">PV</FONT> balloon driver.
<DT><B>setmaxmem</B> <I>domain-id</I> <B>size</B> [[<I>--config</I>] [<I>--live</I>] | [<I>--current</I>]]<DD>
<A NAME="ixAEJ"></A>
Change the maximum memory allocation limit for a guest domain.
If <I>--live</I> is specified, affect a running guest.
If <I>--config</I> is specified, affect the next boot of a persistent guest.
If <I>--current</I> is specified, affect the current guest state.
Both <I>--live</I> and <I>--config</I> flags may be given, but <I>--current</I> is
exclusive. If no flag is specified, behavior is different depending
on hypervisor.


<P>


This command works for at least the Xen, <FONT SIZE="-1">QEMU/KVM</FONT> and vSphere/ESX hypervisors.


<P>


<I>size</I> is a scaled integer (see <B></B><FONT SIZE="-1"><B>NOTES</B></FONT><B></B> above); it defaults to kibibytes
(blocks of 1024 bytes) unless you provide a suffix (and the older option
name <I>--kilobytes</I> is available as a deprecated synonym) .  Libvirt rounds
up to the nearest kibibyte.  Some hypervisors require a larger granularity
than KiB, and requests that are not an even multiple will be rounded up.
For example, vSphere/ESX rounds the parameter up to mebibytes (1024 kibibytes).
<DT><B>memtune</B> <I>domain-id</I> [<I>--hard-limit</I> <B>size</B>] [<I>--soft-limit</I> <B>size</B>] [<I>--swap-hard-limit</I> <B>size</B>] [<I>--min-guarantee</I> <B>size</B>] [[<I>--config</I>] [<I>--live</I>] | [<I>--current</I>]]<DD>
<A NAME="ixAEK"></A>
Allows you to display or set the domain memory parameters. Without
flags, the current settings are displayed; with a flag, the
appropriate limit is adjusted if supported by the hypervisor.  <FONT SIZE="-1">LXC</FONT> and
<FONT SIZE="-1">QEMU/KVM</FONT> support <I>--hard-limit</I>, <I>--soft-limit</I>, and <I>--swap-hard-limit</I>.
<I>--min-guarantee</I> is supported only by <FONT SIZE="-1">ESX</FONT> hypervisor.  Each of these
limits are scaled integers (see <B></B><FONT SIZE="-1"><B>NOTES</B></FONT><B></B> above), with a default of
kibibytes (blocks of 1024 bytes) if no suffix is present.


<P>


If <I>--live</I> is specified, affect a running guest.
If <I>--config</I> is specified, affect the next boot of a persistent guest.
If <I>--current</I> is specified, affect the current guest state.
Both <I>--live</I> and <I>--config</I> flags may be given, but <I>--current</I> is
exclusive. If no flag is specified, behavior is different depending
on hypervisor.


<P>


For <FONT SIZE="-1">QEMU/KVM</FONT>, the parameters are applied to the <FONT SIZE="-1">QEMU</FONT> process as a whole.
Thus, when counting them, one needs to add up guest <FONT SIZE="-1">RAM</FONT>, guest video <FONT SIZE="-1">RAM</FONT>, and
some memory overhead of <FONT SIZE="-1">QEMU</FONT> itself.  The last piece is hard to determine so
one needs guess and try.
<DL COMPACT><DT><DD>
<DL COMPACT>
<DT><I>--hard-limit</I><DD>
<A NAME="ixAEL"></A>
The maximum memory the guest can use.
<DT><I>--soft-limit</I><DD>
<A NAME="ixAEM"></A>
The memory limit to enforce during memory contention.
<DT><I>--swap-hard-limit</I><DD>
<A NAME="ixAEN"></A>
The maximum memory plus swap the guest can use.  This has to be more
than hard-limit value provided.
<DT><I>--min-guarantee</I><DD>
<A NAME="ixAEO"></A>
The guaranteed minimum memory allocation for the guest.
</DL>
</DL>

<DL COMPACT><DT><DD>


<P>


Specifying -1 as a value for these limits is interpreted as unlimited.
</DL>

<DT><B>blkiotune</B> <I>domain-id</I> [<I>--weight</I> <B>weight</B>] [<I>--device-weights</I> <B>device-weights</B>] [[<I>--config</I>] [<I>--live</I>] | [<I>--current</I>]]<DD>
<A NAME="ixAEP"></A>
Display or set the blkio parameters. <FONT SIZE="-1">QEMU/KVM</FONT> supports <I>--weight</I>.
<I>--weight</I> is in range [100, 1000].


<P>


<B>device-weights</B> is a single string listing one or more device/weight
pairs, in the format of /path/to/device,weight,/path/to/device,weight.
Each weight is in the range [100, 1000], or the value 0 to remove that
device from per-device listings.  Only the devices listed in the string
are modified; any existing per-device weights for other devices remain
unchanged.


<P>


If <I>--live</I> is specified, affect a running guest.
If <I>--config</I> is specified, affect the next boot of a persistent guest.
If <I>--current</I> is specified, affect the current guest state.
Both <I>--live</I> and <I>--config</I> flags may be given, but <I>--current</I> is
exclusive. If no flag is specified, behavior is different depending
on hypervisor.
<DT><B>setvcpus</B> <I>domain-id</I> <I>count</I> [<I>--maximum</I>] [[<I>--config</I>] [<I>--live</I>] | [<I>--current</I>]]<DD>
<A NAME="ixAEQ"></A>
Change the number of virtual CPUs active in a guest domain.  By default,
this command works on active guest domains.  To change the settings for an
inactive guest domain, use the <I>--config</I> flag.


<P>


The <I>count</I> value may be limited by host, hypervisor, or a limit coming
from the original description of the guest domain. For Xen, you can only
adjust the virtual CPUs of a running domain if the domain is paravirtualized.


<P>


If the <I>--config</I> flag is specified, the change is made to the stored <FONT SIZE="-1">XML</FONT>
configuration for the guest domain, and will only take effect when the guest
domain is next started.


<P>


If <I>--live</I> is specified, the guest domain must be active, and the change
takes place immediately.  Both the <I>--config</I> and <I>--live</I> flags may be
specified together if supported by the hypervisor.


<P>


If <I>--current</I> is specified, affect the current guest state.


<P>


When no flags are given, the <I>--live</I>
flag is assumed and the guest domain must be active.  In this situation it
is up to the hypervisor whether the <I>--config</I> flag is also assumed, and
therefore whether the <FONT SIZE="-1">XML</FONT> configuration is adjusted to make the change
persistent.


<P>


The <I>--maximum</I> flag controls the maximum number of virtual cpus that can
be hot-plugged the next time the domain is booted.  As such, it must only be
used with the <I>--config</I> flag, and not with the <I>--live</I> flag.
<DT><B>shutdown</B> <I>domain-id</I> [<I>--mode acpi|agent</I>]<DD>
<A NAME="ixAER"></A>
Gracefully shuts down a domain.  This coordinates with the domain <FONT SIZE="-1">OS</FONT>
to perform graceful shutdown, so there is no guarantee that it will
succeed, and may take a variable length of time depending on what
services must be shutdown in the domain.


<P>


The exact behavior of a domain when it shuts down is set by the
<I>on_shutdown</I> parameter in the domain's <FONT SIZE="-1">XML</FONT> definition.


<P>


If <I>domain-id</I> is transient, then the metadata of any snapshots will
be lost once the guest stops running, but the snapshot contents still
exist, and a new domain with the same name and <FONT SIZE="-1">UUID</FONT> can restore the
snapshot metadata with <B>snapshot-create</B>.


<P>


By default the hypervisor will try to pick a suitable shutdown
method. To specify an alternative method, the <I>--mode</I> parameter
can specify <TT>&quot;acpi&quot;</TT> or <TT>&quot;agent&quot;</TT>.
<DT><B>start</B> <I>domain-name</I> [<I>--console</I>] [<I>--paused</I>] [<I>--autodestroy</I>] [<I>--bypass-cache</I>] [<I>--force-boot</I>]<DD>
<A NAME="ixAES"></A>
Start a (previously defined) inactive domain, either from the last
<B>managedsave</B> state, or via a fresh boot if no managedsave state is
present.  The domain will be paused if the <I>--paused</I> option is
used and supported by the driver; otherwise it will be running.
If <I>--console</I> is requested, attach to the console after creation.
If <I>--autodestroy</I> is requested, then the guest will be automatically
destroyed when virsh closes its connection to libvirt, or otherwise
exits.  If <I>--bypass-cache</I> is specified, and managedsave state exists,
the restore will avoid the file system cache, although this may slow
down the operation.  If <I>--force-boot</I> is specified, then any
managedsave state is discarded and a fresh boot occurs.
<DT><B>suspend</B> <I>domain-id</I><DD>
<A NAME="ixAET"></A>
Suspend a running domain. It is kept in memory but won't be scheduled
anymore.
<DT><B>resume</B> <I>domain-id</I><DD>
<A NAME="ixAEU"></A>
Moves a domain out of the suspended state.  This will allow a previously
suspended domain to now be eligible for scheduling by the underlying
hypervisor.
<DT><B>dompmsuspend</B> <I>domain-id</I> <I>target</I><DD>
<A NAME="ixAEV"></A>
Suspend a running domain into one of these states (possible <I>target</I>
values):
<BR>&nbsp;&nbsp;&nbsp;&nbsp;mem&nbsp;equivallent&nbsp;of&nbsp;S3&nbsp;<FONT SIZE="-1">ACPI</FONT>&nbsp;state
<BR>&nbsp;&nbsp;&nbsp;&nbsp;disk&nbsp;equivallent&nbsp;of&nbsp;S4&nbsp;<FONT SIZE="-1">ACPI</FONT>&nbsp;state
<BR>&nbsp;&nbsp;&nbsp;&nbsp;hybrid&nbsp;<FONT SIZE="-1">RAM</FONT>&nbsp;is&nbsp;saved&nbsp;to&nbsp;disk&nbsp;but&nbsp;not&nbsp;powered&nbsp;off
<DT><B>ttyconsole</B> <I>domain-id</I><DD>
<A NAME="ixAEW"></A>
Output the device used for the <FONT SIZE="-1">TTY</FONT> console of the domain. If the information
is not available the processes will provide an exit code of 1.
<DT><B>undefine</B> <I>domain-id</I> [<I>--managed-save</I>] [<I>--snapshots-metadata</I>] [ {<I>--storage</I> <B>volumes</B> | <I>--remove-all-storage</I>} <I>--wipe-storage</I>]<DD>
<A NAME="ixAEX"></A>
Undefine a domain. If the domain is running, this converts it to a
transient domain, without stopping it. If the domain is inactive,
the domain configuration is removed.


<P>


The <I>--managed-save</I> flag guarantees that any managed save image (see
the <B>managedsave</B> command) is also cleaned up.  Without the flag, attempts
to undefine a domain with a managed save image will fail.


<P>


The <I>--snapshots-metadata</I> flag guarantees that any snapshots (see the
<B>snapshot-list</B> command) are also cleaned up when undefining an inactive
domain.  Without the flag, attempts to undefine an inactive domain with
snapshot metadata will fail.  If the domain is active, this flag is
ignored.


<P>


The <I>--storage</I> flag takes a parameter <B>volumes</B>, which is a comma separated
list of volume target names or source paths of storage volumes to be removed
along with the undefined domain. Volumes can be undefined and thus removed only
on inactive domains. Volume deletion is only attempted after the domain is
undefined; if not all of the requested volumes could be deleted, the
error message indicates what still remains behind. If a volume path is not
found in the domain definition, it's treated as if the volume was successfully
deleted.
(See <B>domblklist</B> for list of target names associated to a domain).
Example: --storage vda,/path/to/storage.img


<P>


The <I>--remove-all-storage</I> flag specifies that all of the domain's storage
volumes should be deleted.


<P>


The flag <I>--wipe-storage</I> specifies that the storage volumes should be
wiped before removal.


<P>


<FONT SIZE="-1">NOTE:</FONT> For an inactive domain, the domain name or <FONT SIZE="-1">UUID</FONT> must be used as the
<I>domain-id</I>.
<DT><B>vcpucount</B> <I>domain-id</I>  [{<I>--maximum</I> | <I>--active</I>} {<I>--config</I> | <I>--live</I> | <I>--current</I>}]<DD>
<A NAME="ixAEY"></A>
Print information about the virtual cpu counts of the given
<I>domain-id</I>.  If no flags are specified, all possible counts are
listed in a table; otherwise, the output is limited to just the
numeric value requested.  For historical reasons, the table
lists the label ``current'' on the rows that can be queried in isolation
via the <I>--active</I> flag, rather than relating to the <I>--current</I> flag.


<P>


<I>--maximum</I> requests information on the maximum cap of vcpus that a
domain can add via <B>setvcpus</B>, while <I>--active</I> shows the current
usage; these two flags cannot both be specified.  <I>--config</I>
requires a persistent domain and requests information regarding the next
time the domain will be booted, <I>--live</I> requires a running domain and
lists current values, and <I>--current</I> queries according to the current
state of the domain (corresponding to <I>--live</I> if running, or
<I>--config</I> if inactive); these three flags are mutually exclusive.
Thus, this command always takes exactly zero or two flags.
<DT><B>vcpuinfo</B> <I>domain-id</I><DD>
<A NAME="ixAEZ"></A>
Returns basic information about the domain virtual CPUs, like the number of
vCPUs, the running time, the affinity to physical processors.
<DT><B>vcpupin</B> <I>domain-id</I> [<I>vcpu</I>] [<I>cpulist</I>] [[<I>--live</I>] [<I>--config</I>] | [<I>--current</I>]]<DD>
<A NAME="ixAFA"></A>
Query or change the pinning of domain VCPUs to host physical CPUs.  To
pin a single <I>vcpu</I>, specify <I>cpulist</I>; otherwise, you can query one
<I>vcpu</I> or omit <I>vcpu</I> to list all at once.


<P>


<I>cpulist</I> is a list of physical <FONT SIZE="-1">CPU</FONT> numbers. Its syntax is a comma
separated list and a special markup using '-' and '^' (ex. '0-4', '0-3,^2') can
also be allowed. The '-' denotes the range and the '^' denotes exclusive.
If you want to reset vcpupin setting, that is, to pin vcpu all physical cpus,
simply specify 'r' as a cpulist.
If <I>--live</I> is specified, affect a running guest.
If <I>--config</I> is specified, affect the next boot of a persistent guest.
If <I>--current</I> is specified, affect the current guest state.
Both <I>--live</I> and <I>--config</I> flags may be given if <I>cpulist</I> is present,
but <I>--current</I> is exclusive.
If no flag is specified, behavior is different depending on hypervisor.


<P>


<B>Note</B>: The expression is sequentially evaluated, so ``0-15,^8'' is
identical to ``9-14,0-7,15'' but not identical to ``^8,0-15''.
<DT><B>vncdisplay</B> <I>domain-id</I><DD>
<A NAME="ixAFB"></A>
Output the <FONT SIZE="-1">IP</FONT> address and port number for the <FONT SIZE="-1">VNC</FONT> display. If the information
is not available the processes will provide an exit code of 1.
</DL>
<A NAME="lbAH">&nbsp;</A>
<H2>DEVICE COMMANDS</H2>

<A NAME="ixAFC"></A>
The following commands manipulate devices associated to domains.
The domain-id can be specified as a short integer, a name or a full <FONT SIZE="-1">UUID</FONT>.
To better understand the values allowed as options for the command
reading the documentation at &lt;<A HREF="http://libvirt.org/formatdomain.html">http://libvirt.org/formatdomain.html</A>&gt; on the
format of the device sections to get the most accurate set of accepted values.
<DL COMPACT>
<DT><B>attach-device</B> <I>domain-id</I> <I></I><FONT SIZE="-1"><I>FILE</I></FONT><I></I><DD>
<A NAME="ixAFD"></A>
Attach a device to the domain, using a device definition in an <FONT SIZE="-1">XML</FONT> file.
See the documentation to learn about libvirt <FONT SIZE="-1">XML</FONT> format for a device.
For cdrom and floppy devices, this command only replaces the media within
the single existing device; consider using <B>update-device</B> for this usage.
For passthrough host devices, see also <B>nodedev-detach</B>, needed if
the device does not use managed mode.
<DT><B>attach-disk</B> <I>domain-id</I> <I>source</I> <I>target</I> [<I>--driver driver</I>] [<I>--subdriver subdriver</I>] [<I>--cache cache</I>] [<I>--type type</I>] [<I>--mode mode</I>] [<I>--persistent</I>] [<I>--sourcetype soucetype</I>] [<I>--serial serial</I>] [<I>--shareable</I>] [<I>--rawio</I>] [<I>--address address</I>] [<I>--multifunction</I>]<DD>
<A NAME="ixAFE"></A>
Attach a new disk device to the domain.
<I>source</I> and <I>target</I> are paths for the files and devices.
<I>driver</I> can be <I>file</I>, <I>tap</I> or <I>phy</I> for the Xen hypervisor depending on
the kind of access; or <I>qemu</I> for the <FONT SIZE="-1">QEMU</FONT> emulator.
<I>type</I> can indicate <I>cdrom</I> or <I>floppy</I> as alternative to the disk default,
although this use only replaces the media within the existing virtual cdrom or
floppy device; consider using <B>update-device</B> for this usage instead.
<I>mode</I> can specify the two specific mode <I>readonly</I> or <I>shareable</I>.
<I>persistent</I> indicates the changes will affect the next boot of the domain.
<I>sourcetype</I> can indicate the type of source (block|file)
<I>cache</I> can be one of ``default'', ``none'', ``writethrough'', ``writeback'',
``directsync'' or ``unsafe''.
<I>serial</I> is the serial of disk device. <I>shareable</I> indicates the disk device
is shareable between domains.
<I>rawio</I> indicates the disk needs rawio capability.
<I>address</I> is the address of disk device in the form of pci:domain.bus.slot.function,
scsi:controller.bus.unit or ide:controller.bus.unit.
<I>multifunction</I> indicates specified pci address is a multifunction pci device
address.
<DT><B>attach-interface</B> <I>domain-id</I> <I>type</I> <I>source</I> [<I>--target target</I>] [<I>--mac mac</I>] [<I>--script script</I>] [<I>--model model</I>] [<I>--persistent</I>] [<I>--inbound average,peak,burst</I>] [<I>--outbound average,peak,burst</I>]<DD>
<A NAME="ixAFF"></A>
Attach a new network interface to the domain.
<I>type</I> can be either <I>network</I> to indicate a physical network device or <I>bridge</I> to indicate a bridge to a device.
<I>source</I> indicates the source device.
<I>target</I> allows to indicate the target device in the guest.
<I>mac</I> allows to specify the <FONT SIZE="-1">MAC</FONT> address of the network interface.
<I>script</I> allows to specify a path to a script handling a bridge instead of
the default one.
<I>model</I> allows to specify the model type.
<I>persistent</I> indicates the changes will affect the next boot of the domain.
<I>inbound</I> and <I>outbound</I> control the bandwidth of the interface. <I>peak</I>
and <I>burst</I> are optional, so ``average,peak'', ``average,,burst'' and
``average'' are also legal.


<P>


<B>Note</B>: the optional target value is the name of a device to be created
as the back-end on the node. If not provided a device named ``vnetN'' or ``vifN''
will be created automatically.
<DT><B>detach-device</B> <I>domain-id</I> <I></I><FONT SIZE="-1"><I>FILE</I></FONT><I></I><DD>
<A NAME="ixAFG"></A>
Detach a device from the domain, takes the same kind of <FONT SIZE="-1">XML</FONT> descriptions
as command <B>attach-device</B>.
For passthrough host devices, see also <B>nodedev-reattach</B>, needed if
the device does not use managed mode.
<DT><B>detach-disk</B> <I>domain-id</I> <I>target</I><DD>
<A NAME="ixAFH"></A>
Detach a disk device from a domain. The <I>target</I> is the device as seen
from the domain.
<DT><B>detach-interface</B> <I>domain-id</I> <I>type</I> [<I>--mac mac</I>]<DD>
<A NAME="ixAFI"></A>
Detach a network interface from a domain.
<I>type</I> can be either <I>network</I> to indicate a physical network device or <I>bridge</I> to indicate a bridge to a device.
It is recommended to use the <I>mac</I> option to distinguish between the interfaces
if more than one are present on the domain.
<DT><B>update-device</B> <I>domain-id</I> <I>file</I> [<I>--persistent</I>] [<I>--force</I>]<DD>
<A NAME="ixAFJ"></A>
Update the characteristics of a device associated with <I>domain-id</I>, based on
the device definition in an <FONT SIZE="-1">XML</FONT> <I>file</I>.  If the <I>--persistent</I> option is
used, the changes will affect the next boot of the domain. The <I>--force</I>
option can be used to force device update, e.g., to eject a CD-ROM even if it
is locked/mounted in the domain. See the documentation to learn about libvirt
<FONT SIZE="-1">XML</FONT> format for a device.
<DT><B>change-media</B> <I>domain-id</I> <I>path</I> [<I>--eject</I>] [<I>--insert</I>] [<I>--update</I>] [<I>source</I>] [<I>--force</I>] [[<I>--live</I>] [<I>--config</I>] | [<I>--current</I>]]<DD>
<A NAME="ixAFK"></A>
Change media of <FONT SIZE="-1">CDROM</FONT> or floppy drive. <I>path</I> can be the fully-qualified path
or the unique target name (&lt;target dev='hdc'&gt;) of the disk device. <I>source</I>
specifies the path of the media to be inserted or updated.


<P>


<I>--eject</I> indicates the media will be ejected.
<I>--insert</I> indicates the media will be inserted. <I>source</I> must be specified.
If the device has source (e.g. &lt;source file='media'&gt;), and <I>source</I> is not
specified, <I>--update</I> is equal to <I>--eject</I>. If the device has no source,
and <I>source</I> is specified, <I>--update</I> is equal to <I>--insert</I>. If the device
has source, and <I>source</I> is specified, <I>--update</I> behaves like combination
of <I>--eject</I> and <I>--insert</I>.
If none of <I>--eject</I>, <I>--insert</I>, and <I>--update</I> is specified, <I>--update</I>
is used by default.
The <I>--force</I> option can be used to force media changing.
If <I>--live</I> is specified, alter live configuration of running guest.
If <I>--config</I> is specified, alter persistent configuration, effect observed
on next boot.
<I>--current</I> can be either or both of <I>live</I> and <I>config</I>, depends on
the hypervisor's implementation.
Both <I>--live</I> and <I>--config</I> flags may be given, but <I>--current</I> is
exclusive. If no flag is specified, behavior is different depending
on hypervisor.
</DL>
<A NAME="lbAI">&nbsp;</A>
<H2>NODEDEV COMMANDS</H2>

<A NAME="ixAFL"></A>
The following commands manipulate host devices that are intended to be
passed through to guest domains via &lt;hostdev&gt; elements in a domain's
&lt;devices&gt; section.  A node device key is generally specified by the bus
name followed by its address, using underscores between all components,
such as pci_0000_00_02_1, usb_1_5_3, or net_eth1_00_27_13_6a_fe_00.
The <B>nodedev-list</B> gives the full list of host devices that are known
to libvirt, although this includes devices that cannot be assigned to
a guest (for example, attempting to detach the <FONT SIZE="-1">PCI</FONT> device that controls
the host's hard disk controller where the guest's disk images live could
cause the host system to lock up or reboot).
<P>

For more information on node device definition see:
&lt;<A HREF="http://libvirt.org/formatnode.html">http://libvirt.org/formatnode.html</A>&gt;.
<P>

Passthrough devices cannot be simultaneously used by the host and its
guest domains, nor by multiple active guests at once.  If the
&lt;hostdev&gt; description includes the attribute <B>managed='yes'</B>, and the
hypervisor driver supports it, then the device is in managed mode, and
attempts to use that passthrough device in an active guest will
automatically behave as if <B>nodedev-detach</B> (guest start, device
hot-plug) and <B>nodedev-reattach</B> (guest stop, device hot-unplug) were
called at the right points (currently, qemu does this for <FONT SIZE="-1">PCI</FONT> devices,
but not <FONT SIZE="-1">USB</FONT>).  If a device is not marked as managed, then it must
manually be detached before guests can use it, and manually reattached
to be returned to the host.  Also, if a device is manually detached,
then the host does not regain control of the device without a matching
reattach, even if the guests use the device in managed mode.
<DL COMPACT>
<DT><B>nodedev-create</B> <I></I><FONT SIZE="-1"><I>FILE</I></FONT><I></I><DD>
<A NAME="ixAFM"></A>
Create a device on the host node that can then be assigned to virtual
machines. Normally, libvirt is able to automatically determine which
host nodes are available for use, but this allows registration of
host hardware that libvirt did not automatically detect.  <I>file</I>
contains xml for a top-level &lt;device&gt; description of a node device.
<DT><B>nodedev-destroy</B> <I>nodedev</I><DD>
<A NAME="ixAFN"></A>
Destroy (stop) a device on the host.  Note that this makes libvirt
quit managing a host device, and may even make that device unusable
by the rest of the physical host until a reboot.
<DT><B>nodedev-detach</B> <I>nodedev</I><DD>
<A NAME="ixAFO"></A>
Detach <I>nodedev</I> from the host, so that it can safely be used by
guests via &lt;hostdev&gt; passthrough.  This is reversed with
<B>nodedev-reattach</B>, and is done automatically for managed devices.
For compatibility purposes, this command can also be spelled
<B>nodedev-dettach</B>.
<DT><B>nodedev-dumpxml</B> <I>nodedev</I><DD>
<A NAME="ixAFP"></A>
Dump a &lt;device&gt; <FONT SIZE="-1">XML</FONT> representation for the given node device, including
such information as the device name, which bus owns the device, the
vendor and product id, and any capabilities of the device usable by
libvirt (such as whether device reset is supported).
<DT><B>nodedev-list</B> <I>cap</I> <I>--tree</I><DD>
<A NAME="ixAFQ"></A>
List all of the devices available on the node that are known by libvirt.
If <I>cap</I> is used, the list is filtered to show only the nodes that
include the given capability.  If <I>--tree</I> is used, the output is
formatted in a tree representing parents of each node.
<DT><B>nodedev-reattach</B> <I>nodedev</I><DD>
<A NAME="ixAFR"></A>
Declare that <I>nodedev</I> is no longer in use by any guests, and that
the host can resume normal use of the device.  This is done
automatically for devices in managed mode, but must be done explicitly
to match any explicit <B>nodedev-detach</B>.
<DT><B>nodedev-reset</B> <I>nodedev</I><DD>
<A NAME="ixAFS"></A>
Trigger a device reset for <I>nodedev</I>, useful prior to transferring
a node device between guest passthrough or the host.  Libvirt will
often do this action implicitly when required, but this command
allows an explicit reset when needed.
</DL>
<A NAME="lbAJ">&nbsp;</A>
<H2>VIRTUAL NETWORK COMMANDS</H2>

<A NAME="ixAFT"></A>
The following commands manipulate networks. Libvirt has the capability to
define virtual networks which can then be used by domains and linked to
actual network devices. For more detailed information about this feature
see the documentation at &lt;<A HREF="http://libvirt.org/formatnetwork.html">http://libvirt.org/formatnetwork.html</A>&gt; . Many
of the commands for virtual networks are similar to the ones used for domains,
but the way to name a virtual network is either by its name or <FONT SIZE="-1">UUID</FONT>.
<DL COMPACT>
<DT><B>net-autostart</B> <I>network</I> [<I>--disable</I>]<DD>
<A NAME="ixAFU"></A>
Configure a virtual network to be automatically started at boot.
The <I>--disable</I> option disable autostarting.
<DT><B>net-create</B> <I>file</I><DD>
<A NAME="ixAFV"></A>
Create a virtual network from an <FONT SIZE="-1">XML</FONT> <I>file</I>, see the documentation to get
a description of the <FONT SIZE="-1">XML</FONT> network format used by libvirt.
<DT><B>net-define</B> <I>file</I><DD>
<A NAME="ixAFW"></A>
Define a virtual network from an <FONT SIZE="-1">XML</FONT> <I>file</I>, the network is just defined but
not instantiated.
<DT><B>net-destroy</B> <I>network</I><DD>
<A NAME="ixAFX"></A>
Destroy (stop) a given virtual network specified by its name or <FONT SIZE="-1">UUID</FONT>. This
takes effect immediately.
<DT><B>net-dumpxml</B> <I>network</I> [<I>--inactive</I>]<DD>
<A NAME="ixAFY"></A>
Output the virtual network information as an <FONT SIZE="-1">XML</FONT> dump to stdout.
If <I>--inactive</I> is specified, then physical functions are not
expanded into their associated virtual functions.
<DT><B>net-edit</B> <I>network</I><DD>
<A NAME="ixAFZ"></A>
Edit the <FONT SIZE="-1">XML</FONT> configuration file for a network.


<P>


This is equivalent to:


<P>




<PRE>
 virsh net-dumpxml network &gt; network.xml
 vi network.xml (or make changes with your other text editor)
 virsh net-define network.xml

</PRE>




<P>


except that it does some error checking.


<P>


The editor used can be supplied by the <TT>$VISUAL</TT> or <TT>$EDITOR</TT> environment
variables, and defaults to <TT>&quot;vi&quot;</TT>.
<DT><B>net-info</B> <I>network</I><DD>
<A NAME="ixAGA"></A>
Returns basic information about the <I>network</I> object.
<DT><B>net-list</B> [<I>--inactive</I> | <I>--all</I>]<DD>
<A NAME="ixAGB"></A>
Returns the list of active networks, if <I>--all</I> is specified this will also
include defined but inactive networks, if <I>--inactive</I> is specified only the
inactive ones will be listed.
<DT><B>net-name</B> <I>network-UUID</I><DD>
<A NAME="ixAGC"></A>
Convert a network <FONT SIZE="-1">UUID</FONT> to network name.
<DT><B>net-start</B> <I>network</I><DD>
<A NAME="ixAGD"></A>
Start a (previously defined) inactive network.
<DT><B>net-undefine</B> <I>network</I><DD>
<A NAME="ixAGE"></A>
Undefine the configuration for an inactive network.
<DT><B>net-uuid</B> <I>network-name</I><DD>
<A NAME="ixAGF"></A>
Convert a network name to network <FONT SIZE="-1">UUID</FONT>.
</DL>
<A NAME="lbAK">&nbsp;</A>
<H2>INTERFACE COMMANDS</H2>

<A NAME="ixAGG"></A>
The following commands manipulate host interfaces.  Often, these host
interfaces can then be used by name within domain &lt;interface&gt; elements
(such as a system-created bridge interface), but there is no
requirement that host interfaces be tied to any particular guest
configuration <FONT SIZE="-1">XML</FONT> at all.
<P>

Many of the commands for host interfaces are similar to the ones used
for domains, and the way to name an interface is either by its name or
its <FONT SIZE="-1">MAC</FONT> address.  However, using a <FONT SIZE="-1">MAC</FONT> address for an <I>iface</I>
argument only works when that address is unique (if an interface and a
bridge share the same <FONT SIZE="-1">MAC</FONT> address, which is often the case, then using
that <FONT SIZE="-1">MAC</FONT> address results in an error due to ambiguity, and you must
resort to a name instead).
<DL COMPACT>
<DT><B>iface-bridge</B> <I>interface</I> <I>bridge</I> [<I>--no-stp</I>] [<I>delay</I>] [<I>--no-start</I>]<DD>
<A NAME="ixAGH"></A>
Create a bridge device named <I>bridge</I>, and attach the existing
network device <I>interface</I> to the new bridge.  The new bridge
defaults to starting immediately, with <FONT SIZE="-1">STP</FONT> enabled and a delay of 0;
these settings can be altered with <I>--no-stp</I>, <I>--no-start</I>, and an
integer number of seconds for <I>delay</I>. All <FONT SIZE="-1">IP</FONT> address configuration
of <I>interface</I> will be moved to the new bridge device.


<P>


See also <B>iface-unbridge</B> for undoing this operation.
<DT><B>iface-define</B> <I>file</I><DD>
<A NAME="ixAGI"></A>
Define a host interface from an <FONT SIZE="-1">XML</FONT> <I>file</I>, the interface is just defined but
not started.
<DT><B>iface-destroy</B> <I>interface</I><DD>
<A NAME="ixAGJ"></A>
Destroy (stop) a given host interface, such as by running ``if-down'' to
disable that interface from active use. This takes effect immediately.
<DT><B>iface-dumpxml</B> <I>interface</I> [<I>--inactive</I>]<DD>
<A NAME="ixAGK"></A>
Output the host interface information as an <FONT SIZE="-1">XML</FONT> dump to stdout.  If
<I>--inactive</I> is specified, then the output reflects the persistent
state of the interface that will be used the next time it is started.
<DT><B>iface-edit</B> <I>interface</I><DD>
<A NAME="ixAGL"></A>
Edit the <FONT SIZE="-1">XML</FONT> configuration file for a host interface.


<P>


This is equivalent to:


<P>




<PRE>
 virsh iface-dumpxml iface &gt; iface.xml
 vi iface.xml (or make changes with your other text editor)
 virsh iface-define iface.xml

</PRE>




<P>


except that it does some error checking.


<P>


The editor used can be supplied by the <TT>$VISUAL</TT> or <TT>$EDITOR</TT> environment
variables, and defaults to <TT>&quot;vi&quot;</TT>.
<DT><B>iface-list</B> [<I>--inactive</I> | <I>--all</I>]<DD>
<A NAME="ixAGM"></A>
Returns the list of active host interfaces.  If <I>--all</I> is specified
this will also include defined but inactive interfaces.  If
<I>--inactive</I> is specified only the inactive ones will be listed.
<DT><B>iface-name</B> <I>interface</I><DD>
<A NAME="ixAGN"></A>
Convert a host interface <FONT SIZE="-1">MAC</FONT> to interface name, if the <FONT SIZE="-1">MAC</FONT> address is unique
among the host's interfaces.


<P>


<I>interface</I> specifies the interface <FONT SIZE="-1">MAC</FONT> address.
<DT><B>iface-mac</B> <I>interface</I><DD>
<A NAME="ixAGO"></A>
Convert a host interface name to <FONT SIZE="-1">MAC</FONT> address.


<P>


<I>interface</I> specifies the interface name.
<DT><B>iface-start</B> <I>interface</I><DD>
<A NAME="ixAGP"></A>
Start a (previously defined) host interface, such as by running ``if-up''.
<DT><B>iface-unbridge</B> <I>bridge</I> [<I>--no-start</I>]<DD>
<A NAME="ixAGQ"></A>
Tear down a bridge device named <I>bridge</I>, releasing its underlying
interface back to normal usage, and moving all <FONT SIZE="-1">IP</FONT> address
configuration from the bridge device to the underlying device.  The
underlying interface is restarted unless <I>--no-start</I> is present;
this flag is present for symmetry, but generally not recommended.


<P>


See also <B>iface-bridge</B> for creating a bridge.
<DT><B>iface-undefine</B> <I>interface</I><DD>
<A NAME="ixAGR"></A>
Undefine the configuration for an inactive host interface.
<DT><B>iface-begin</B><DD>
<A NAME="ixAGS"></A>
Create a snapshot of current host interface settings, which can later
be committed (<I>iface-commit</I>) or restored (<I>iface-rollback</I>).  If a
snapshot already exists, then this command will fail until the
previous snapshot has been committed or restored.  Undefined behavior
results if any external changes are made to host interfaces outside of
the libvirt <FONT SIZE="-1">API</FONT> between the beginning of a snapshot and its eventual
commit or rollback.
<DT><B>iface-commit</B><DD>
<A NAME="ixAGT"></A>
Declare all changes since the last <I>iface-begin</I> as working, and
delete the rollback point.  If no interface snapshot has already been
started, then this command will fail.
<DT><B>iface-rollback</B><DD>
<A NAME="ixAGU"></A>
Revert all host interface settings back to the state recorded in the
last <I>iface-begin</I>.  If no interface snapshot has already been
started, then this command will fail.  Rebooting the host also serves
as an implicit rollback point.
</DL>
<A NAME="lbAL">&nbsp;</A>
<H2>STORAGE POOL COMMANDS</H2>

<A NAME="ixAGV"></A>
The following commands manipulate storage pools. Libvirt has the
capability to manage various storage solutions, including files, raw
partitions, and domain-specific formats, used to provide the storage
volumes visible as devices within virtual machines. For more detailed
information about this feature, see the documentation at
&lt;<A HREF="http://libvirt.org/formatstorage.html">http://libvirt.org/formatstorage.html</A>&gt; . Many of the commands for
pools are similar to the ones used for domains.
<DL COMPACT>
<DT><B>find-storage-pool-sources</B> <I>type</I> [<I>srcSpec</I>]<DD>
<A NAME="ixAGW"></A>
Returns <FONT SIZE="-1">XML</FONT> describing all storage pools of a given <I>type</I> that could
be found.  If <I>srcSpec</I> is provided, it is a file that contains <FONT SIZE="-1">XML</FONT>
to further restrict the query for pools.
<DT><B>find-storage-pool-sources-as</B> <I>type</I> [<I>host</I>] [<I>port</I>] [<I>initiator</I>]<DD>
<A NAME="ixAGX"></A>
Returns <FONT SIZE="-1">XML</FONT> describing all storage pools of a given <I>type</I> that could
be found.  If <I>host</I>, <I>port</I>, or <I>initiator</I> are provided, they control
where the query is performed.
<DT><B>pool-autostart</B> <I>pool-or-uuid</I> [<I>--disable</I>]<DD>
<A NAME="ixAGY"></A>
Configure whether <I>pool</I> should automatically start at boot.
<DT><B>pool-build</B> <I>pool-or-uuid</I> [<I>--overwrite</I>] [<I>--no-overwrite</I>]<DD>
<A NAME="ixAGZ"></A>
Build a given pool.


<P>


Options <I>--overwrite</I> and <I>--no-overwrite</I> can only be used for
<B>pool-build</B> a filesystem pool. If neither of them is specified,
<B>pool-build</B> on a filesystem pool only makes the directory; If
<I>--no-overwrite</I> is specified, it probes to determine if a
filesystem already exists on the target device, returning an error
if exists, or using mkfs to format the target device if not; If
<I>--overwrite</I> is specified, mkfs is always executed, any existed
data on the target device is overwritten unconditionally.
<DT><B>pool-create</B> <I>file</I><DD>
<A NAME="ixAHA"></A>
Create and start a pool object from the <FONT SIZE="-1">XML</FONT> <I>file</I>.
<DT><B>pool-create-as</B> <I>name</I> <I>--print-xml</I> <I>type</I> [<I>source-host</I>] [<I>source-path</I>] [<I>source-dev</I>] [<I>source-name</I>] [&lt;target&gt;] [<I>--source-format format</I>]<DD>
<A NAME="ixAHB"></A>
Create and start a pool object <I>name</I> from the raw parameters.  If
<I>--print-xml</I> is specified, then print the <FONT SIZE="-1">XML</FONT> of the pool object
without creating the pool.  Otherwise, the pool has the specified
<I>type</I>.
<DT><B>pool-define</B> <I>file</I><DD>
<A NAME="ixAHC"></A>
Create, but do not start, a pool object from the <FONT SIZE="-1">XML</FONT> <I>file</I>.
<DT><B>pool-define-as</B> <I>name</I> <I>--print-xml</I> <I>type</I> [<I>source-host</I>] [<I>source-path</I>] [<I>source-dev</I>] [<I>source-name</I>] [&lt;target&gt;] [<I>--source-format format</I>]<DD>
<A NAME="ixAHD"></A>
Create, but do not start, a pool object <I>name</I> from the raw parameters.  If
<I>--print-xml</I> is specified, then print the <FONT SIZE="-1">XML</FONT> of the pool object
without defining the pool.  Otherwise, the pool has the specified
<I>type</I>.
<DT><B>pool-destroy</B> <I>pool-or-uuid</I><DD>
<A NAME="ixAHE"></A>
Destroy (stop) a given <I>pool</I> object. Libvirt will no longer manage the
storage described by the pool object, but the raw data contained in
the pool is not changed, and can be later recovered with
<B>pool-create</B>.
<DT><B>pool-delete</B> <I>pool-or-uuid</I><DD>
<A NAME="ixAHF"></A>
Destroy the resources used by a given <I>pool</I> object. This operation
is non-recoverable.  The <I>pool</I> object will still exist after this
command, ready for the creation of new storage volumes.
<DT><B>pool-dumpxml</B> <I>pool-or-uuid</I><DD>
<A NAME="ixAHG"></A>
Returns the <FONT SIZE="-1">XML</FONT> information about the <I>pool</I> object.
<DT><B>pool-edit</B> <I>pool-or-uuid</I><DD>
<A NAME="ixAHH"></A>
Edit the <FONT SIZE="-1">XML</FONT> configuration file for a storage pool.


<P>


This is equivalent to:


<P>




<PRE>
 virsh pool-dumpxml pool &gt; pool.xml
 vi pool.xml (or make changes with your other text editor)
 virsh pool-define pool.xml

</PRE>




<P>


except that it does some error checking.


<P>


The editor used can be supplied by the <TT>$VISUAL</TT> or <TT>$EDITOR</TT> environment
variables, and defaults to <TT>&quot;vi&quot;</TT>.
<DT><B>pool-info</B> <I>pool-or-uuid</I><DD>
<A NAME="ixAHI"></A>
Returns basic information about the <I>pool</I> object.
<DT><B>pool-list</B> [<I>--inactive</I> | <I>--all</I>] [<I>--details</I>]<DD>
<A NAME="ixAHJ"></A>
List pool objects known to libvirt.  By default, only pools in use by
active domains are listed; <I>--inactive</I> lists just the inactive
pools, and <I>--all</I> lists all pools. The <I>--details</I> option instructs
virsh to additionally display pool persistence and capacity related
information where available.
<DT><B>pool-name</B> <I>uuid</I><DD>
<A NAME="ixAHK"></A>
Convert the <I>uuid</I> to a pool name.
<DT><B>pool-refresh</B> <I>pool-or-uuid</I><DD>
<A NAME="ixAHL"></A>
Refresh the list of volumes contained in <I>pool</I>.
<DT><B>pool-start</B> <I>pool-or-uuid</I><DD>
<A NAME="ixAHM"></A>
Start the storage <I>pool</I>, which is previously defined but inactive.
<DT><B>pool-undefine</B> <I>pool-or-uuid</I><DD>
<A NAME="ixAHN"></A>
Undefine the configuration for an inactive <I>pool</I>.
<DT><B>pool-uuid</B> <I>pool</I><DD>
<A NAME="ixAHO"></A>
Returns the <FONT SIZE="-1">UUID</FONT> of the named <I>pool</I>.
</DL>
<A NAME="lbAM">&nbsp;</A>
<H2>VOLUME COMMANDS</H2>

<A NAME="ixAHP"></A>
<DL COMPACT>
<DT><B>vol-create</B> <I>pool-or-uuid</I> <I></I><FONT SIZE="-1"><I>FILE</I></FONT><I></I><DD>
<A NAME="ixAHQ"></A>
Create a volume from an <FONT SIZE="-1">XML</FONT> &lt;file&gt;.
<I>pool-or-uuid</I> is the name or <FONT SIZE="-1">UUID</FONT> of the storage pool to create the volume in.
<I></I><FONT SIZE="-1"><I>FILE</I></FONT><I></I> is the <FONT SIZE="-1">XML</FONT> &lt;file&gt; with the volume definition. An easy way to create the
<FONT SIZE="-1">XML</FONT> &lt;file&gt; is to use the <B>vol-dumpxml</B> command to obtain the definition of a
pre-existing volume.


<P>


<B>Example</B>


<P>




<PRE>
 virsh vol-dumpxml --pool storagepool1 appvolume1 &gt; newvolume.xml
 vi newvolume.xml (or make changes with your other text editor)
 virsh vol-create differentstoragepool newvolume.xml

</PRE>


<DT><B>vol-create-from</B> <I>pool-or-uuid</I> <I></I><FONT SIZE="-1"><I>FILE</I></FONT><I></I> [<I>--inputpool</I> <I>pool-or-uuid</I>] <I>vol-name-or-key-or-path</I><DD>
<A NAME="ixAHR"></A>
Create a volume, using another volume as input.
<I>pool-or-uuid</I> is the name or <FONT SIZE="-1">UUID</FONT> of the storage pool to create the volume in.
<I></I><FONT SIZE="-1"><I>FILE</I></FONT><I></I> is the <FONT SIZE="-1">XML</FONT> &lt;file&gt; with the volume definition.
<I>--inputpool</I> <I>pool-or-uuid</I> is the name or uuid of the storage pool the
source volume is in.
<I>vol-name-or-key-or-path</I> is the name or key or path of the source volume.
<DT><B>vol-create-as</B> <I>pool-or-uuid</I> <I>name</I> <I>capacity</I> [<I>--allocation</I> <I>size</I>] [<I>--format</I> <I>string</I>] [<I>--backing-vol</I> <I>vol-name-or-key-or-path</I>] [<I>--backing-vol-format</I> <I>string</I>]<DD>
<A NAME="ixAHS"></A>
Create a volume from a set of arguments.
<I>pool-or-uuid</I> is the name or <FONT SIZE="-1">UUID</FONT> of the storage pool to create the volume
in.
<I>name</I> is the name of the new volume.
<I>capacity</I> is the size of the volume to be created, as a scaled integer
(see <B></B><FONT SIZE="-1"><B>NOTES</B></FONT><B></B> above), defaulting to bytes if there is no suffix.
<I>--allocation</I> <I>size</I> is the initial size to be allocated in the volume,
also as a scaled integer defaulting to bytes.
<I>--format</I> <I>string</I> is used in file based storage pools to specify the volume
file format to use; raw, bochs, qcow, qcow2, vmdk.
<I>--backing-vol</I> <I>vol-name-or-key-or-path</I> is the source backing
volume to be used if taking a snapshot of an existing volume.
<I>--backing-vol-format</I> <I>string</I> is the format of the snapshot backing volume;
raw, bochs, qcow, qcow2, vmdk, host_device.
<DT><B>vol-clone</B> [<I>--pool</I> <I>pool-or-uuid</I>] <I>vol-name-or-key-or-path</I> <I>name</I><DD>
<A NAME="ixAHT"></A>
Clone an existing volume.  Less powerful, but easier to type, version of
<B>vol-create-from</B>.
<I>--pool</I> <I>pool-or-uuid</I> is the name or <FONT SIZE="-1">UUID</FONT> of the storage pool to create
the volume in.
<I>vol-name-or-key-or-path</I> is the name or key or path of the source volume.
<I>name</I> is the name of the new volume.
<DT><B>vol-delete</B> [<I>--pool</I> <I>pool-or-uuid</I>] <I>vol-name-or-key-or-path</I><DD>
<A NAME="ixAHU"></A>
Delete a given volume.
<I>--pool</I> <I>pool-or-uuid</I> is the name or <FONT SIZE="-1">UUID</FONT> of the storage pool the volume
is in.
<I>vol-name-or-key-or-path</I> is the name or key or path of the volume to delete.
<DT><B>vol-upload</B> [<I>--pool</I> <I>pool-or-uuid</I>] [<I>--offset</I> <I>bytes</I>] [<I>--length</I> <I>bytes</I>] <I>vol-name-or-key-or-path</I> <I>local-file</I><DD>
<A NAME="ixAHV"></A>
Upload the contents of <I>local-file</I> to a storage volume.
<I>--pool</I> <I>pool-or-uuid</I> is the name or <FONT SIZE="-1">UUID</FONT> of the storage pool the volume
is in.
<I>vol-name-or-key-or-path</I> is the name or key or path of the volume to wipe.
<I>--offset</I> is the position in the storage volume at which to start writing
the data. <I>--length</I> is an upper bound of the amount of data to be uploaded.
An error will occurr if the <I>local-file</I> is greater than the specified length.
<DT><B>vol-download</B> [<I>--pool</I> <I>pool-or-uuid</I>] [<I>--offset</I> <I>bytes</I>] [<I>--length</I> <I>bytes</I>] <I>vol-name-or-key-or-path</I> <I>local-file</I><DD>
<A NAME="ixAHW"></A>
Download the contents of <I>local-file</I> from a storage volume.
<I>--pool</I> <I>pool-or-uuid</I> is the name or <FONT SIZE="-1">UUID</FONT> of the storage pool the volume
is in.
<I>vol-name-or-key-or-path</I> is the name or key or path of the volume to wipe.
<I>--offset</I> is the position in the storage volume at which to start reading
the data. <I>--length</I> is an upper bound of the amount of data to be downloaded.
<DT><B>vol-wipe</B> [<I>--pool</I> <I>pool-or-uuid</I>] [<I>--algorithm</I> <I>algorithm</I>] <I>vol-name-or-key-or-path</I><DD>
<A NAME="ixAHX"></A>
Wipe a volume, ensure data previously on the volume is not accessible to
future reads. <I>--pool</I> <I>pool-or-uuid</I> is the name or <FONT SIZE="-1">UUID</FONT> of the storage
pool the volume is in.
<I>vol-name-or-key-or-path</I> is the name or key or path of the volume to wipe.
It is possible to choose different wiping algorithms instead of re-writing
volume with zeroes. This can be done via <I>--algorithm</I> switch.


<P>


<B>Supported algorithms</B>
<BR>&nbsp;&nbsp;zero&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;1-pass&nbsp;all&nbsp;zeroes
<BR>&nbsp;&nbsp;nnsa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;4-pass&nbsp;<FONT SIZE="-1">NNSA</FONT>&nbsp;Policy&nbsp;Letter&nbsp;<FONT SIZE="-1">NAP-14</FONT>.1-C&nbsp;(<FONT SIZE="-1">XVI-8</FONT>)&nbsp;for
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sanitizing&nbsp;removable&nbsp;and&nbsp;non-removable&nbsp;hard&nbsp;disks:
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;random&nbsp;x2,&nbsp;0x00,&nbsp;verify.
<BR>&nbsp;&nbsp;dod&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;4-pass&nbsp;DoD&nbsp;5220.22-M&nbsp;section&nbsp;8-306&nbsp;procedure&nbsp;for
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sanitizing&nbsp;removeable&nbsp;and&nbsp;non-removeable&nbsp;rigid
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disks:&nbsp;random,&nbsp;0x00,&nbsp;0xff,&nbsp;verify.
<BR>&nbsp;&nbsp;bsi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;9-pass&nbsp;method&nbsp;recommended&nbsp;by&nbsp;the&nbsp;German&nbsp;Center&nbsp;of
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Security&nbsp;in&nbsp;Information&nbsp;Technologies
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<A HREF="http://www.bsi.bund.de):">http://www.bsi.bund.de):</A>&nbsp;0xff,&nbsp;0xfe,&nbsp;0xfd,&nbsp;0xfb,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xf7,&nbsp;0xef,&nbsp;0xdf,&nbsp;0xbf,&nbsp;0x7f.
<BR>&nbsp;&nbsp;gutmann&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;The&nbsp;canonical&nbsp;35-pass&nbsp;sequence&nbsp;described&nbsp;in
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gutmann's&nbsp;paper.
<BR>&nbsp;&nbsp;schneier&nbsp;&nbsp;&nbsp;-&nbsp;7-pass&nbsp;method&nbsp;described&nbsp;by&nbsp;Bruce&nbsp;Schneier&nbsp;in
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;``Applied&nbsp;Cryptography''&nbsp;(1996):&nbsp;0x00,&nbsp;0xff,
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;random&nbsp;x5.
<BR>&nbsp;&nbsp;pfitzner7&nbsp;&nbsp;-&nbsp;Roy&nbsp;Pfitzner's&nbsp;7-random-pass&nbsp;method:&nbsp;random&nbsp;x7.
<BR>&nbsp;&nbsp;pfitzner33&nbsp;-&nbsp;Roy&nbsp;Pfitzner's&nbsp;33-random-pass&nbsp;method:&nbsp;random&nbsp;x33.
<BR>&nbsp;&nbsp;random&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;1-pass&nbsp;pattern:&nbsp;random.


<P>


<B>Note</B>: The availability of algorithms may be limited by the version
of the <TT>&quot;scrub&quot;</TT> binary installed on the host.
<DT><B>vol-dumpxml</B> [<I>--pool</I> <I>pool-or-uuid</I>] <I>vol-name-or-key-or-path</I><DD>
<A NAME="ixAHY"></A>
Output the volume information as an <FONT SIZE="-1">XML</FONT> dump to stdout.
<I>--pool</I> <I>pool-or-uuid</I> is the name or <FONT SIZE="-1">UUID</FONT> of the storage pool the volume
is in. <I>vol-name-or-key-or-path</I> is the name or key or path of the volume
to output the <FONT SIZE="-1">XML</FONT> of.
<DT><B>vol-info</B> [<I>--pool</I> <I>pool-or-uuid</I>] <I>vol-name-or-key-or-path</I><DD>
<A NAME="ixAHZ"></A>
Returns basic information about the given storage volume.
<I>--pool</I> <I>pool-or-uuid</I> is the name or <FONT SIZE="-1">UUID</FONT> of the storage pool the volume
is in. <I>vol-name-or-key-or-path</I> is the name or key or path of the volume
to return information for.
<DT><B>vol-list</B> [<I>--pool</I> <I>pool-or-uuid</I>] [<I>--details</I>]<DD>
<A NAME="ixAIA"></A>
Return the list of volumes in the given storage pool.
<I>--pool</I> <I>pool-or-uuid</I> is the name or <FONT SIZE="-1">UUID</FONT> of the storage pool.
The <I>--details</I> option instructs virsh to additionally display volume
type and capacity related information where available.
<DT><B>vol-pool</B> [<I>--uuid</I>] <I>vol-key-or-path</I><DD>
<A NAME="ixAIB"></A>
Return the pool name or <FONT SIZE="-1">UUID</FONT> for a given volume. By default, the pool name is
returned. If the <I>--uuid</I> option is given, the pool <FONT SIZE="-1">UUID</FONT> is returned instead.
<I>vol-key-or-path</I> is the key or path of the volume to return the pool
information for.
<DT><B>vol-path</B> [<I>--pool</I> <I>pool-or-uuid</I>] <I>vol-name-or-key</I><DD>
<A NAME="ixAIC"></A>
Return the path for a given volume.
<I>--pool</I> <I>pool-or-uuid</I> is the name or <FONT SIZE="-1">UUID</FONT> of the storage pool the volume
is in.
<I>vol-name-or-key</I> is the name or key of the volume to return the path for.
<DT><B>vol-name</B> <I>vol-key-or-path</I><DD>
<A NAME="ixAID"></A>
Return the name for a given volume.
<I>vol-key-or-path</I> is the key or path of the volume to return the name for.
<DT><B>vol-key</B> [<I>--pool</I> <I>pool-or-uuid</I>] <I>vol-name-or-path</I><DD>
<A NAME="ixAIE"></A>
Return the volume key for a given volume.
<I>--pool</I> <I>pool-or-uuid</I> is the name or <FONT SIZE="-1">UUID</FONT> of the storage pool the volume
is in. <I>vol-name-or-path</I> is the name or path of the volume to return the
volume key for.
<DT><B>vol-resize</B> [<I>--pool</I> <I>pool-or-uuid</I>] <I>vol-name-or-path</I> <I>pool-or-uuid</I> <I>capacity</I> [<I>--allocate</I>] [<I>--delta</I>] [<I>--shrink</I>]<DD>
<A NAME="ixAIF"></A>
Resize the capacity of the given volume, in bytes.
<I>--pool</I> <I>pool-or-uuid</I> is the name or <FONT SIZE="-1">UUID</FONT> of the storage pool the volume
is in. <I>vol-name-or-key-or-path</I> is the name or key or path of the volume
to resize.  The new capacity might be sparse unless <I>--allocate</I> is
specified.  Normally, <I>capacity</I> is the new size, but if <I>--delta</I>
is present, then it is added to the existing size.  Attempts to shrink
the volume will fail unless <I>--shrink</I> is present; <I>capacity</I> cannot
be negative unless <I>--shrink</I> is provided, but a negative sign is not
necessary. <I>capacity</I> is a scaled integer (see <B></B><FONT SIZE="-1"><B>NOTES</B></FONT><B></B> above), which
defaults to bytes if there is no suffix.  This command is only safe
for storage volumes not in use by an active guest; see also
<B>blockresize</B> for live resizing.
</DL>
<A NAME="lbAN">&nbsp;</A>
<H2>SECRET COMMMANDS</H2>

<A NAME="ixAIG"></A>
The following commands manipulate ``secrets'' (e.g. passwords, passphrases and
encryption keys).  Libvirt can store secrets independently from their use, and
other objects (e.g. volumes or domains) can refer to the secrets for encryption
or possibly other uses.  Secrets are identified using an <FONT SIZE="-1">UUID</FONT>.  See
&lt;<A HREF="http://libvirt.org/formatsecret.html">http://libvirt.org/formatsecret.html</A>&gt; for documentation of the <FONT SIZE="-1">XML</FONT> format
used to represent properties of secrets.
<DL COMPACT>
<DT><B>secret-define</B> <I>file</I><DD>
<A NAME="ixAIH"></A>
Create a secret with the properties specified in <I>file</I>, with no associated
secret value.  If <I>file</I> does not specify a <FONT SIZE="-1">UUID</FONT>, choose one automatically.
If <I>file</I> specifies an <FONT SIZE="-1">UUID</FONT> of an existing secret, replace its properties by
properties defined in <I>file</I>, without affecting the secret value.
<DT><B>secret-dumpxml</B> <I>secret</I><DD>
<A NAME="ixAII"></A>
Output properties of <I>secret</I> (specified by its <FONT SIZE="-1">UUID</FONT>) as an <FONT SIZE="-1">XML</FONT> dump to stdout.
<DT><B>secret-set-value</B> <I>secret</I> <I>base64</I><DD>
<A NAME="ixAIJ"></A>
Set the value associated with <I>secret</I> (specified by its <FONT SIZE="-1">UUID</FONT>) to the value
Base64-encoded value <I>base64</I>.
<DT><B>secret-get-value</B> <I>secret</I><DD>
<A NAME="ixAIK"></A>
Output the value associated with <I>secret</I> (specified by its <FONT SIZE="-1">UUID</FONT>) to stdout,
encoded using Base64.
<DT><B>secret-undefine</B> <I>secret</I><DD>
<A NAME="ixAIL"></A>
Delete a <I>secret</I> (specified by its <FONT SIZE="-1">UUID</FONT>), including the associated value, if
any.
<DT><B>secret-list</B><DD>
<A NAME="ixAIM"></A>
Output a list of UUIDs of known secrets to stdout.
</DL>
<A NAME="lbAO">&nbsp;</A>
<H2>SNAPSHOT COMMMANDS</H2>

<A NAME="ixAIN"></A>
The following commands manipulate domain snapshots.  Snapshots take the
disk, memory, and device state of a domain at a point-of-time, and save it
for future use.  They have many uses, from saving a ``clean'' copy of an <FONT SIZE="-1">OS</FONT>
image to saving a domain's state before a potentially destructive operation.
Snapshots are identified with a unique name.  See
&lt;<A HREF="http://libvirt.org/formatsnapshot.html">http://libvirt.org/formatsnapshot.html</A>&gt; for documentation of the <FONT SIZE="-1">XML</FONT> format
used to represent properties of snapshots.
<DL COMPACT>
<DT><B>snapshot-create</B> <I>domain</I> [<I>xmlfile</I>] {[<I>--redefine</I> [<I>--current</I>]] | [<I>--no-metadata</I>] [<I>--halt</I>] [<I>--disk-only</I>] [<I>--reuse-external</I>] [<I>--quiesce</I>] [<I>--atomic</I>]}<DD>
<A NAME="ixAIO"></A>
Create a snapshot for domain <I>domain</I> with the properties specified in
<I>xmlfile</I>.  Normally, the only properties settable for a domain snapshot
are the &lt;name&gt; and &lt;description&gt; elements, as well as &lt;disks&gt; if
<I>--disk-only</I> is given; the rest of the fields are
ignored, and automatically filled in by libvirt.  If <I>xmlfile</I> is
completely omitted, then libvirt will choose a value for all fields.
The new snapshot will become current, as listed by <B>snapshot-current</B>.


<P>


If <I>--halt</I> is specified, the domain will be left in an inactive state
after the snapshot is created.


<P>


If <I>--disk-only</I> is specified, the snapshot will only include disk
state rather than the usual system checkpoint with vm state.  Disk
snapshots are faster than full system checkpoints, but reverting to a
disk snapshot may require fsck or journal replays, since it is like
the disk state at the point when the power cord is abruptly pulled;
and mixing <I>--halt</I> and <I>--disk-only</I> loses any data that was not
flushed to disk at the time.


<P>


If <I>--redefine</I> is specified, then all <FONT SIZE="-1">XML</FONT> elements produced by
<B>snapshot-dumpxml</B> are valid; this can be used to migrate snapshot
hierarchy from one machine to another, to recreate hierarchy for the
case of a transient domain that goes away and is later recreated with
the same name and <FONT SIZE="-1">UUID</FONT>, or to make slight alterations in the snapshot
metadata (such as host-specific aspects of the domain <FONT SIZE="-1">XML</FONT> embedded in
the snapshot).  When this flag is supplied, the <I>xmlfile</I> argument
is mandatory, and the domain's current snapshot will not be altered
unless the <I>--current</I> flag is also given.


<P>


If <I>--no-metadata</I> is specified, then the snapshot data is created,
but any metadata is immediately discarded (that is, libvirt does not
treat the snapshot as current, and cannot revert to the snapshot
unless <I>--redefine</I> is later used to teach libvirt about the
metadata again).


<P>


If <I>--reuse-external</I> is specified, and the snapshot <FONT SIZE="-1">XML</FONT> requests an
external snapshot with a destination of an existing file, then the
existing file is truncated and reused; otherwise, a snapshot is refused
to avoid losing contents of the existing files.


<P>


If <I>--quiesce</I> is specified, libvirt will try to use guest agent
to freeze and unfreeze domain's mounted file systems. However,
if domain has no guest agent, snapshot creation will fail.
Currently, this requires <I>--disk-only</I> to be passed as well.


<P>


If <I>--atomic</I> is specified, libvirt will guarantee that the snapshot
either succeeds, or fails with no changes; not all hypervisors support
this.  If this flag is not specified, then some hypervisors may fail
after partially performing the action, and <B>dumpxml</B> must be used to
see whether any partial changes occurred.


<P>


Existence of snapshot metadata will prevent attempts to <B>undefine</B>
a persistent domain.  However, for transient domains, snapshot
metadata is silently lost when the domain quits running (whether
by command such as <B>destroy</B> or by internal guest action).
<DT><B>snapshot-create-as</B> <I>domain</I> {[<I>--print-xml</I>] | [<I>--no-metadata</I>] [<I>--halt</I>] [<I>--reuse-existing</I>]} [<I>name</I>] [<I>description</I>] [<I>--disk-only</I> [<I>--quiesce</I>] [<I>--atomic</I>] [[<I>--diskspec</I>] <B>diskspec</B>]...]<DD>
<A NAME="ixAIP"></A>
Create a snapshot for domain <I>domain</I> with the given &lt;name&gt; and
&lt;description&gt;; if either value is omitted, libvirt will choose a
value.  If <I>--print-xml</I> is specified, then <FONT SIZE="-1">XML</FONT> appropriate for
<I>snapshot-create</I> is output, rather than actually creating a snapshot.
Otherwise, if <I>--halt</I> is specified, the domain will be left in an
inactive state after the snapshot is created, and if <I>--disk-only</I>
is specified, the snapshot will not include vm state.


<P>


The <I>--disk-only</I> flag is used to request a disk-only snapshot.  When
this flag is in use, the command can also take additional <I>diskspec</I>
arguments to add &lt;disk&gt; elements to the xml.  Each &lt;diskspec&gt; is in the
form <B>disk[,snapshot=type][,driver=type][,file=name]</B>.  To include a
literal comma in <B>disk</B> or in <B>file=name</B>, escape it with a second
comma.  A literal <I>--diskspec</I> must preceed each <B>diskspec</B> unless
all three of <I>domain</I>, <I>name</I>, and <I>description</I> are also present.
For example, a diskspec of ``vda,snapshot=external,file=/path/to,,new''
results in the following <FONT SIZE="-1">XML:</FONT>
<BR>&nbsp;&nbsp;&lt;disk&nbsp;name='vda'&nbsp;snapshot='external'&gt;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;source&nbsp;file='/path/to,new'/&gt;
<BR>&nbsp;&nbsp;&lt;/disk&gt;


<P>


If <I>--reuse-external</I> is specified, and the domain <FONT SIZE="-1">XML</FONT> or <I>diskspec</I>
option requests an external snapshot with a destination of an existing
file, then the existing file is truncated and reused; otherwise, a
snapshot is refused to avoid losing contents of the existing files.


<P>


If <I>--quiesce</I> is specified, libvirt will try to use guest agent
to freeze and unfreeze domain's mounted file systems. However,
if domain has no guest agent, snapshot creation will fail.
Currently, this requires <I>--disk-only</I> to be passed as well.


<P>


If <I>--no-metadata</I> is specified, then the snapshot data is created,
but any metadata is immediately discarded (that is, libvirt does not
treat the snapshot as current, and cannot revert to the snapshot
unless <B>snapshot-create</B> is later used to teach libvirt about the
metadata again).  This flag is incompatible with <I>--print-xml</I>.


<P>


If <I>--atomic</I> is specified, libvirt will guarantee that the snapshot
either succeeds, or fails with no changes; not all hypervisors support
this.  If this flag is not specified, then some hypervisors may fail
after partially performing the action, and <B>dumpxml</B> must be used to
see whether any partial changes occurred.
<DT><B>snapshot-current</B> <I>domain</I> {[<I>--name</I>] | [<I>--security-info</I>] | [<I>snapshotname</I>]}<DD>
<A NAME="ixAIQ"></A>
Without <I>snapshotname</I>, this will output the snapshot <FONT SIZE="-1">XML</FONT> for the domain's
current snapshot (if any).  If <I>--name</I> is specified, just the
current snapshot name instead of the full xml.  Otherwise, using
<I>--security-info</I> will also include security sensitive information in
the <FONT SIZE="-1">XML</FONT>.


<P>


With <I>snapshotname</I>, this is a request to make the existing named
snapshot become the current snapshot, without reverting the domain.
<DT><B>snapshot-edit</B> <I>domain</I> [<I>snapshotname</I>] [<I>--current</I>] {[<I>--rename</I>] | [<I>--clone</I>]}<DD>
<A NAME="ixAIR"></A>
Edit the <FONT SIZE="-1">XML</FONT> configuration file for <I>snapshotname</I> of a domain.  If
both <I>snapshotname</I> and <I>--current</I> are specified, also force the
edited snapshot to become the current snapshot.  If <I>snapshotname</I>
is omitted, then <I>--current</I> must be supplied, to edit the current
snapshot.


<P>


This is equivalent to:


<P>




<PRE>
 virsh snapshot-dumpxml dom name &gt; snapshot.xml
 vi snapshot.xml (or make changes with your other text editor)
 virsh snapshot-create dom snapshot.xml --redefine [--current]

</PRE>




<P>


except that it does some error checking.


<P>


The editor used can be supplied by the <TT>$VISUAL</TT> or <TT>$EDITOR</TT> environment
variables, and defaults to <TT>&quot;vi&quot;</TT>.


<P>


If <I>--rename</I> is specified, then the edits can change the snapshot
name.  If <I>--clone</I> is specified, then changing the snapshot name
will create a clone of the snapshot metadata.  If neither is specified,
then the edits must not change the snapshot name.  Note that changing
a snapshot name must be done with care, since the contents of some
snapshots, such as internal snapshots within a single qcow2 file, are
accessible only from the original name.
<DT><B>snapshot-list</B> <I>domain</I> [{<I>--parent</I> | <I>--roots</I> | <I>--tree</I>}] [{[<I>--from</I>] <B>snapshot</B> | <I>--current</I>} [<I>--descendants</I>]] [<I>--metadata</I>] [<I>--leaves</I>]<DD>
<A NAME="ixAIS"></A>
List all of the available snapshots for the given domain, defaulting
to show columns for the snapshot name, creation time, and domain state.


<P>


If <I>--parent</I> is specified, add a column to the output table giving
the name of the parent of each snapshot.  If <I>--roots</I> is specified,
the list will be filtered to just snapshots that have no parents.
If <I>--tree</I> is specified, the output will be in a tree format, listing
just snapshot names.  These three options are mutually exclusive.


<P>


If <I>--from</I> is provided, filter the list to snapshots which are
children of the given <B>snapshot</B>; or if <I>--current</I> is provided,
start at the current snapshot.  When used in isolation or with
<I>--parent</I>, the list is limited to direct children unless
<I>--descendants</I> is also present.  When used with <I>--tree</I>, the
use of <I>--descendants</I> is implied.  This option is not compatible
with <I>--roots</I>.


<P>


If <I>--leaves</I> is specified, the list will be filtered to just
snapshots that have no children.  This option is not compatible
with <I>--tree</I>.


<P>


If <I>--metadata</I> is specified, the list will be filtered to just
snapshots that involve libvirt metadata, and thus would prevent
<B>undefine</B> of a persistent domain, or be lost on <B>destroy</B> of
a transient domain.
<DT><B>snapshot-dumpxml</B> <I>domain</I> <I>snapshot</I> [<I>--security-info</I>]<DD>
<A NAME="ixAIT"></A>
Output the snapshot <FONT SIZE="-1">XML</FONT> for the domain's snapshot named <I>snapshot</I>.
Using <I>--security-info</I> will also include security sensitive information.
Use <B>snapshot-current</B> to easily access the <FONT SIZE="-1">XML</FONT> of the current snapshot.
<DT><B>snapshot-parent</B> <I>domain</I> {<I>snapshot</I> | <I>--current</I>}<DD>
<A NAME="ixAIU"></A>
Output the name of the parent snapshot, if any, for the given
<I>snapshot</I>, or for the current snapshot with <I>--current</I>.
<DT><B>snapshot-revert</B> <I>domain</I> {<I>snapshot</I> | <I>--current</I>} [{<I>--running</I> | <I>--paused</I>}] [<I>--force</I>]<DD>
<A NAME="ixAIV"></A>
Revert the given domain to the snapshot specified by <I>snapshot</I>, or to
the current snapshot with <I>--current</I>.  Be aware
that this is a destructive action; any changes in the domain since the last
snapshot was taken will be lost.  Also note that the state of the domain after
snapshot-revert is complete will be the state of the domain at the time
the original snapshot was taken.


<P>


Normally, reverting to a snapshot leaves the domain in the state it was
at the time the snapshot was created, except that a disk snapshot with
no vm state leaves the domain in an inactive state.  Passing either the
<I>--running</I> or <I>--paused</I> flag will perform additional state changes
(such as booting an inactive domain, or pausing a running domain).  Since
transient domains cannot be inactive, it is required to use one of these
flags when reverting to a disk snapshot of a transient domain.


<P>


There are two cases where a snapshot revert involves extra risk, which
requires the use of <I>--force</I> to proceed.  One is the case of a
snapshot that lacks full domain information for reverting
configuration (such as snapshots created prior to libvirt 0.9.5);
since libvirt cannot prove that the current configuration matches what
was in use at the time of the snapshot, supplying <I>--force</I> assures
libvirt that the snapshot is compatible with the current configuration
(and if it is not, the domain will likely fail to run).  The other is
the case of reverting from a running domain to an active state where a
new hypervisor has to be created rather than reusing the existing
hypervisor, because it implies drawbacks such as breaking any existing
<FONT SIZE="-1">VNC</FONT> or Spice connections; this condition happens with an active
snapshot that uses a provably incompatible configuration, as well as
with an inactive snapshot that is combined with the <I>--start</I> or
<I>--pause</I> flag.
<DT><B>snapshot-delete</B> <I>domain</I> {<I>snapshot</I> | <I>--current</I>} [<I>--metadata</I>] [{<I>--children</I> | <I>--children-only</I>}]<DD>
<A NAME="ixAIW"></A>
Delete the snapshot for the domain named <I>snapshot</I>, or the current
snapshot with <I>--current</I>.  If this snapshot
has child snapshots, changes from this snapshot will be merged into the
children.  If <I>--children</I> is passed, then delete this snapshot and any
children of this snapshot.  If <I>--children-only</I> is passed, then delete
any children of this snapshot, but leave this snapshot intact.  These
two flags are mutually exclusive.


<P>


If <I>--metadata</I> is specified, then only delete the snapshot metadata
maintained by libvirt, while leaving the snapshot contents intact for
access by external tools; otherwise deleting a snapshot also removes
the data contents from that point in time.
</DL>
<A NAME="lbAP">&nbsp;</A>
<H2>NWFILTER COMMMANDS</H2>

<A NAME="ixAIX"></A>
The following commands manipulate network filters. Network filters allow
filtering of the network traffic coming from and going to virtual machines.
Individual network traffic filters are written in <FONT SIZE="-1">XML</FONT> and may contain
references to other network filters, describe traffic filtering rules,
or contain both. Network filters are referenced by virtual machines
from within their interface description. A network filter may be referenced
by multiple virtual machines' interfaces.
<DL COMPACT>
<DT><B>nwfilter-define</B> <I>xmlfile</I><DD>
<A NAME="ixAIY"></A>
Make a new network filter known to libvirt. If a network filter with
the same name already exists, it will be replaced with the new <FONT SIZE="-1">XML</FONT>.
Any running virtual machine referencing this network filter will have
its network traffic rules adapted. If for any reason the network traffic
filtering rules cannot be instantiated by any of the running virtual
machines, then the new <FONT SIZE="-1">XML</FONT> will be rejected.
<DT><B>nwfilter-undefine</B> <I>nwfilter-name</I><DD>
<A NAME="ixAIZ"></A>
Delete a network filter. The deletion will fail if any running virtual
machine is currently using this network filter.
<DT><B>nwfilter-list</B><DD>
<A NAME="ixAJA"></A>
List all of the available network filters.
<DT><B>nwfilter-dumpxml</B> <I>nwfilter-name</I><DD>
<A NAME="ixAJB"></A>
Output the network filter <FONT SIZE="-1">XML</FONT>.
<DT><B>nwfilter-edit</B> <I>nwfilter-name</I><DD>
<A NAME="ixAJC"></A>
Edit the <FONT SIZE="-1">XML</FONT> of a network filter.


<P>


This is equivalent to:


<P>




<PRE>
 virsh nwfilter-dumpxml myfilter &gt; myfilter.xml
 vi myfilter.xml (or make changes with your other text editor)
 virsh nwfilter-define myfilter.xml

</PRE>




<P>


except that it does some error checking.
The new network filter may be rejected due to the same reason as
mentioned in <I>nwfilter-define</I>.


<P>


The editor used can be supplied by the <TT>$VISUAL</TT> or <TT>$EDITOR</TT> environment
variables, and defaults to <TT>&quot;vi&quot;</TT>.
</DL>
<A NAME="lbAQ">&nbsp;</A>
<H2>QEMU-SPECIFIC COMMANDS</H2>

<A NAME="ixAJD"></A>
<FONT SIZE="-1">NOTE:</FONT> Use of the following commands is <B>strongly</B> discouraged.  They
can cause libvirt to become confused and do the wrong thing on subsequent
operations.  Once you have used this command, please do not report
problems to the libvirt developers; the reports will be ignored.
<DL COMPACT>
<DT><B>qemu-attach</B> <I>pid</I><DD>
<A NAME="ixAJE"></A>
Attach an externally launched <FONT SIZE="-1">QEMU</FONT> process to the libvirt <FONT SIZE="-1">QEMU</FONT> driver.
The <FONT SIZE="-1">QEMU</FONT> process must have been created with a monitor connection
using the <FONT SIZE="-1">UNIX</FONT> driver. Ideally the process will also have had the
'-name' argument specified.
<DL COMPACT><DT><DD>


<P>




<PRE>
     $ qemu-kvm -cdrom ~/demo.iso \
         -monitor unix:/tmp/demo,server,nowait \
         -name foo \
         -uuid cece4f9f-dff0-575d-0e8e-01fe380f12ea  &amp;
     $ QEMUPID=$!
     $ virsh qemu-attach $QEMUPID

</PRE>


</DL>

<DL COMPACT><DT><DD>


<P>


Not all functions of libvirt are expected to work reliably after
attaching to an externally launched <FONT SIZE="-1">QEMU</FONT> process. There may be
issues with the guest <FONT SIZE="-1">ABI</FONT> changing upon migration, and hotunplug
may not work.
</DL>

<DT><B>qemu-monitor-command</B> <I>domain</I> [<I>--hmp</I>] <I>command</I>...<DD>
<A NAME="ixAJF"></A>
Send an arbitrary monitor command <I>command</I> to domain <I>domain</I> through the
qemu monitor.  The results of the command will be printed on stdout.  If
<I>--hmp</I> is passed, the command is considered to be a human monitor command
and libvirt will automatically convert it into <FONT SIZE="-1">QMP</FONT> if needed.  In that case
the result will also be converted back from <FONT SIZE="-1">QMP</FONT>.  If more than one argument
is provided for <I>command</I>, they are concatenated with a space in between
before passing the single command to the monitor.
</DL>
<A NAME="lbAR">&nbsp;</A>
<H2>ENVIRONMENT</H2>

<A NAME="ixAJG"></A>
The following environment variables can be set to alter the behaviour
of <TT>&quot;virsh&quot;</TT>
<DL COMPACT>
<DT>VIRSH_DEBUG=&lt;0 to 4&gt;<DD>
<A NAME="ixAJH"></A>
Turn on verbose debugging of virsh commands. Valid levels are
<DT>* VIRSH_DEBUG=0<DD>
<A NAME="ixAJI"></A>
<FONT SIZE="-1">DEBUG</FONT> - Messages at <FONT SIZE="-1">ALL</FONT> levels get logged
<DT>* VIRSH_DEBUG=1<DD>
<A NAME="ixAJJ"></A>
<FONT SIZE="-1">INFO</FONT> - Logs messages at levels <FONT SIZE="-1">INFO</FONT>, <FONT SIZE="-1">NOTICE</FONT>, <FONT SIZE="-1">WARNING</FONT> and <FONT SIZE="-1">ERROR</FONT>
<DT>* VIRSH_DEBUG=2<DD>
<A NAME="ixAJK"></A>
<FONT SIZE="-1">NOTICE</FONT> - Logs messages at levels <FONT SIZE="-1">NOTICE</FONT>, <FONT SIZE="-1">WARNING</FONT> and <FONT SIZE="-1">ERROR</FONT>
<DT>* VIRSH_DEBUG=3<DD>
<A NAME="ixAJL"></A>
<FONT SIZE="-1">WARNING</FONT> - Logs messages at levels <FONT SIZE="-1">WARNING</FONT> and <FONT SIZE="-1">ERROR</FONT>
<DT>* VIRSH_DEBUG=4<DD>
<A NAME="ixAJM"></A>
<FONT SIZE="-1">ERROR</FONT> - Messages at only <FONT SIZE="-1">ERROR</FONT> level gets logged.
<DT>VIRSH_LOG_FILE=LOGFILE<DD>


<A NAME="ixAJN"></A>
The file to log virsh debug messages.
<DT><FONT SIZE="-1">VIRSH_DEFAULT_CONNECT_URI</FONT><DD>
<A NAME="ixAJO"></A>
The hypervisor to connect to by default. Set this to a <FONT SIZE="-1">URI</FONT>, in the same
format as accepted by the <B>connect</B> option.
<DT><FONT SIZE="-1">VISUAL</FONT><DD>
<A NAME="ixAJP"></A>
The editor to use by the <B>edit</B> and related options.
<DT><FONT SIZE="-1">EDITOR</FONT><DD>
<A NAME="ixAJQ"></A>
The editor to use by the <B>edit</B> and related options, if <TT>&quot;VISUAL&quot;</TT>
is not set.
<DT>LIBVIRT_DEBUG=LEVEL<DD>
<A NAME="ixAJR"></A>
Turn on verbose debugging of all libvirt <FONT SIZE="-1">API</FONT> calls. Valid levels are
<DL COMPACT><DT><DD>
<DL COMPACT>
<DT>*<DD>
LIBVIRT_DEBUG=1


<P>


Messages at level <FONT SIZE="-1">DEBUG</FONT> or above
<DT>*<DD>
LIBVIRT_DEBUG=2


<P>


Messages at level <FONT SIZE="-1">INFO</FONT> or above
<DT>*<DD>
LIBVIRT_DEBUG=3


<P>


Messages at level <FONT SIZE="-1">WARNING</FONT> or above
<DT>*<DD>
LIBVIRT_DEBUG=4


<P>


Messages at level <FONT SIZE="-1">ERROR</FONT> or above
</DL>
</DL>

<DL COMPACT><DT><DD>


<P>


For further information about debugging options consult <TT>&quot;<A HREF="http://libvirt.org/logging.html">http://libvirt.org/logging.html</A>&quot;</TT>
</DL>

</DL>
<A NAME="lbAS">&nbsp;</A>
<H2>BUGS</H2>

<A NAME="ixAJS"></A>
Report any bugs discovered to the libvirt community via the mailing
list <TT>&quot;<A HREF="http://libvirt.org/contact.html">http://libvirt.org/contact.html</A>&quot;</TT> or bug tracker <TT>&quot;<A HREF="http://libvirt.org/bugs.html">http://libvirt.org/bugs.html</A>&quot;</TT>.
Alternatively report bugs to your software distributor / vendor.
<A NAME="lbAT">&nbsp;</A>
<H2>AUTHORS</H2>

<A NAME="ixAJT"></A>


<PRE>
  Please refer to the AUTHORS file distributed with libvirt.

  Based on the xm man page by:
  Sean Dague &lt;sean at dague dot net&gt;
  Daniel Stekloff &lt;dsteklof at us dot ibm dot com&gt;

</PRE>


<A NAME="lbAU">&nbsp;</A>
<H2>COPYRIGHT</H2>

<A NAME="ixAJU"></A>
Copyright (C) 2005, 2007-2010 Red Hat, Inc., and the authors listed in the
libvirt <FONT SIZE="-1">AUTHORS</FONT> file.
<A NAME="lbAV">&nbsp;</A>
<H2>LICENSE</H2>

<A NAME="ixAJV"></A>
virsh is distributed under the terms of the <FONT SIZE="-1">GNU</FONT> <FONT SIZE="-1">LGPL</FONT> v2+.
This is free software; see the source for copying conditions. There
is <FONT SIZE="-1">NO</FONT> warranty; not even for <FONT SIZE="-1">MERCHANTABILITY</FONT> or <FONT SIZE="-1">FITNESS</FONT> <FONT SIZE="-1">FOR</FONT> A <FONT SIZE="-1">PARTICULAR</FONT>
<FONT SIZE="-1">PURPOSE</FONT>
<A NAME="lbAW">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAJW"></A>
<I><A HREF="/manpages/index.html?1+virt-install">virt-install</A></I>(1), <I><A HREF="http://localhost/cgi-bin/man/man2html?1+virt-xml-validate">virt-xml-validate</A></I>(1), <I><A HREF="http://localhost/cgi-bin/man/man2html?1+virt-top">virt-top</A></I>(1), <I><A HREF="http://localhost/cgi-bin/man/man2html?1+virt-df">virt-df</A></I>(1),
&lt;<A HREF="http://www.libvirt.org/">http://www.libvirt.org/</A>&gt;
<A NAME="lbAX">&nbsp;</A>
<H2>POD ERRORS</H2>

<A NAME="ixAJX"></A>
Hey! <B>The above document had some coding errors, which are explained below:</B>
<DL COMPACT>
<DT>Around line 633:<DD>
<A NAME="ixAJY"></A>
Unterminated I&lt;...&gt; sequence
<DT>Around line 674:<DD>
<A NAME="ixAJZ"></A>
Unterminated I&lt;...&gt; sequence
<P>
</DL>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">NOTES</A><DD>
<DT><A HREF="#lbAF">GENERIC COMMANDS</A><DD>
<DT><A HREF="#lbAG">DOMAIN COMMANDS</A><DD>
<DT><A HREF="#lbAH">DEVICE COMMANDS</A><DD>
<DT><A HREF="#lbAI">NODEDEV COMMANDS</A><DD>
<DT><A HREF="#lbAJ">VIRTUAL NETWORK COMMANDS</A><DD>
<DT><A HREF="#lbAK">INTERFACE COMMANDS</A><DD>
<DT><A HREF="#lbAL">STORAGE POOL COMMANDS</A><DD>
<DT><A HREF="#lbAM">VOLUME COMMANDS</A><DD>
<DT><A HREF="#lbAN">SECRET COMMMANDS</A><DD>
<DT><A HREF="#lbAO">SNAPSHOT COMMMANDS</A><DD>
<DT><A HREF="#lbAP">NWFILTER COMMMANDS</A><DD>
<DT><A HREF="#lbAQ">QEMU-SPECIFIC COMMANDS</A><DD>
<DT><A HREF="#lbAR">ENVIRONMENT</A><DD>
<DT><A HREF="#lbAS">BUGS</A><DD>
<DT><A HREF="#lbAT">AUTHORS</A><DD>
<DT><A HREF="#lbAU">COPYRIGHT</A><DD>
<DT><A HREF="#lbAV">LICENSE</A><DD>
<DT><A HREF="#lbAW">SEE ALSO</A><DD>
<DT><A HREF="#lbAX">POD ERRORS</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:29:12 GMT, December 24, 2015
</div></div>
</body>
</HTML>
