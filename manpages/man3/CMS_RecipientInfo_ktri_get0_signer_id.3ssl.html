<!DOCTYPE html>

<HTML><head><TITLE>Manpage of CMS_get0_RecipientInfos</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux man pages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>CMS_get0_RecipientInfos</H1>
Section: OpenSSL (3)<BR>Updated: 2008-04-10<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>



<PRE>
 CMS_get0_RecipientInfos, CMS_RecipientInfo_type, CMS_RecipientInfo_ktri_get0_signer_id,CMS_RecipientInfo_ktri_cert_cmp, CMS_RecipientInfo_set0_pkey, CMS_RecipientInfo_kekri_get0_id, CMS_RecipientInfo_kekri_id_cmp, CMS_RecipientInfo_set0_key, CMS_RecipientInfo_decrypt - CMS envelopedData RecipientInfo routines

</PRE>


<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAC"></A>


<PRE>
 #include &lt;<A HREF="file:/usr/include/openssl/cms.h">openssl/cms.h</A>&gt;

 STACK_OF(CMS_RecipientInfo) *CMS_get0_RecipientInfos(CMS_ContentInfo *cms);
 int CMS_RecipientInfo_type(CMS_RecipientInfo *ri);

 int CMS_RecipientInfo_ktri_get0_signer_id(CMS_RecipientInfo *ri, ASN1_OCTET_STRING **keyid, X509_NAME **issuer, ASN1_INTEGER **sno);
 int CMS_RecipientInfo_ktri_cert_cmp(CMS_RecipientInfo *ri, X509 *cert);
 int CMS_RecipientInfo_set0_pkey(CMS_RecipientInfo *ri, EVP_PKEY *pkey);

 int CMS_RecipientInfo_kekri_get0_id(CMS_RecipientInfo *ri, X509_ALGOR **palg, ASN1_OCTET_STRING **pid, ASN1_GENERALIZEDTIME **pdate, ASN1_OBJECT **potherid, ASN1_TYPE **pothertype);
 int CMS_RecipientInfo_kekri_id_cmp(CMS_RecipientInfo *ri, const unsigned char *id, size_t idlen);
 int CMS_RecipientInfo_set0_key(CMS_RecipientInfo *ri, unsigned char *key, size_t keylen);

 int CMS_RecipientInfo_decrypt(CMS_ContentInfo *cms, CMS_RecipientInfo *ri);

</PRE>


<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>
The function <I>CMS_get0_RecipientInfos()</I> returns all the CMS_RecipientInfo
structures associated with a <FONT SIZE="-1">CMS</FONT> EnvelopedData structure.
<P>

<I>CMS_RecipientInfo_type()</I> returns the type of CMS_RecipientInfo structure <B>ri</B>.
It will currently return <FONT SIZE="-1">CMS_RECIPINFO_TRANS</FONT>, <FONT SIZE="-1">CMS_RECIPINFO_AGREE</FONT>,
<FONT SIZE="-1">CMS_RECIPINFO_KEK</FONT>, <FONT SIZE="-1">CMS_RECIPINFO_PASS</FONT>, or <FONT SIZE="-1">CMS_RECIPINFO_OTHER</FONT>.
<P>

<I>CMS_RecipientInfo_ktri_get0_signer_id()</I> retrieves the certificate recipient
identifier associated with a specific CMS_RecipientInfo structure <B>ri</B>, which
must be of type <FONT SIZE="-1">CMS_RECIPINFO_TRANS</FONT>. Either the keyidentifier will be set in
<B>keyid</B> or <B>both</B> issuer name and serial number in <B>issuer</B> and <B>sno</B>.
<P>

<I>CMS_RecipientInfo_ktri_cert_cmp()</I> compares the certificate <B>cert</B> against the
CMS_RecipientInfo structure <B>ri</B>, which must be of type <FONT SIZE="-1">CMS_RECIPINFO_TRANS</FONT>.
It returns zero if the comparison is successful and non zero if not.
<P>

<I>CMS_RecipientInfo_set0_pkey()</I> associates the private key <B>pkey</B> with
the CMS_RecipientInfo structure <B>ri</B>, which must be of type
<FONT SIZE="-1">CMS_RECIPINFO_TRANS</FONT>.
<P>

<I>CMS_RecipientInfo_kekri_get0_id()</I> retrieves the key information from the
CMS_RecipientInfo structure <B>ri</B> which must be of type <FONT SIZE="-1">CMS_RECIPINFO_KEK</FONT>.  Any
of the remaining parameters can be <FONT SIZE="-1">NULL</FONT> if the application is not interested in
the value of a field. Where a field is optional and absent <FONT SIZE="-1">NULL</FONT> will be written
to the corresponding parameter. The keyEncryptionAlgorithm field is written to
<B>palg</B>, the <B>keyIdentifier</B> field is written to <B>pid</B>, the <B>date</B> field if
present is written to <B>pdate</B>, if the <B>other</B> field is present the components
<B>keyAttrId</B> and <B>keyAttr</B> are written to parameters <B>potherid</B> and
<B>pothertype</B>.
<P>

<I>CMS_RecipientInfo_kekri_id_cmp()</I> compares the <FONT SIZE="-1">ID</FONT> in the <B>id</B> and <B>idlen</B>
parameters against the <B>keyIdentifier</B> CMS_RecipientInfo structure <B>ri</B>,
which must be of type <FONT SIZE="-1">CMS_RECIPINFO_KEK</FONT>.  It returns zero if the comparison is
successful and non zero if not.
<P>

<I>CMS_RecipientInfo_set0_key()</I> associates the symmetric key <B>key</B> of length
<B>keylen</B> with the CMS_RecipientInfo structure <B>ri</B>, which must be of type
<FONT SIZE="-1">CMS_RECIPINFO_KEK</FONT>.
<P>

<I>CMS_RecipientInfo_decrypt()</I> attempts to decrypt CMS_RecipientInfo structure
<B>ri</B> in structure <B>cms</B>. A key must have been associated with the structure
first.
<A NAME="lbAE">&nbsp;</A>
<H2>NOTES</H2>

<A NAME="ixAAE"></A>
The main purpose of these functions is to enable an application to lookup
recipient keys using any appropriate technique when the simpler method
of <I>CMS_decrypt()</I> is not appropriate.
<P>

In typical usage and application will retrieve all CMS_RecipientInfo structures
using <I>CMS_get0_RecipientInfos()</I> and check the type of each using
<I>CMS_RecpientInfo_type()</I>. Depending on the type the CMS_RecipientInfo structure
can be ignored or its key identifier data retrieved using an appropriate
function. Then if the corresponding secret or private key can be obtained by
any appropriate means it can then associated with the structure and
<I>CMS_RecpientInfo_decrypt()</I> called. If successful <I>CMS_decrypt()</I> can be called
with a <FONT SIZE="-1">NULL</FONT> key to decrypt the enveloped content.
<A NAME="lbAF">&nbsp;</A>
<H2>RETURN VALUES</H2>

<A NAME="ixAAF"></A>
<I>CMS_get0_RecipientInfos()</I> returns all CMS_RecipientInfo structures, or <FONT SIZE="-1">NULL</FONT> if
an error occurs.
<P>

<I>CMS_RecipientInfo_ktri_get0_signer_id()</I>, <I>CMS_RecipientInfo_set0_pkey()</I>,
<I>CMS_RecipientInfo_kekri_get0_id()</I>, <I>CMS_RecipientInfo_set0_key()</I> and
<I>CMS_RecipientInfo_decrypt()</I> return 1 for success or 0 if an error occurs.
<P>

<I>CMS_RecipientInfo_ktri_cert_cmp()</I> and <I>CMS_RecipientInfo_kekri_cmp()</I> return 0
for a successful comparison and non zero otherwise.
<P>

Any error can be obtained from <I><A HREF="/manpages/index.html?3+ERR_get_error">ERR_get_error</A></I>(3).
<A NAME="lbAG">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAAG"></A>
<I><A HREF="/manpages/index.html?3+ERR_get_error">ERR_get_error</A></I>(3), <I><A HREF="http://localhost/cgi-bin/man/man2html?3+CMS_decrypt">CMS_decrypt</A></I>(3)
<A NAME="lbAH">&nbsp;</A>
<H2>HISTORY</H2>

<A NAME="ixAAH"></A>
These functions were first was added to OpenSSL 0.9.8
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">NOTES</A><DD>
<DT><A HREF="#lbAF">RETURN VALUES</A><DD>
<DT><A HREF="#lbAG">SEE ALSO</A><DD>
<DT><A HREF="#lbAH">HISTORY</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:16 GMT, December 24, 2015
</div></body>
</HTML>
