<!DOCTYPE html>

<HTML><head><TITLE>Manpage of BIO_s_connect</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux manpages</a></div>
 <div class="site-description">{"type":"documentation"}</div>
 </div>
 </header>
 <div class="page-content"><div class="wrap">
<H1>BIO_s_connect</H1>
Section: OpenSSL (3)<BR>Updated: 2000-10-19<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

BIO_s_connect, BIO_set_conn_hostname, BIO_set_conn_port,
BIO_set_conn_ip, BIO_set_conn_int_port, BIO_get_conn_hostname,
BIO_get_conn_port, BIO_get_conn_ip, BIO_get_conn_int_port,
BIO_set_nbio, BIO_do_connect - connect BIO
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAC"></A>


<PRE>
 #include &lt;<A HREF="file:/usr/include/openssl/bio.h">openssl/bio.h</A>&gt;

 BIO_METHOD * BIO_s_connect(void);

 BIO *BIO_new_connect(char *name);

 long BIO_set_conn_hostname(BIO *b, char *name);
 long BIO_set_conn_port(BIO *b, char *port);
 long BIO_set_conn_ip(BIO *b, char *ip);
 long BIO_set_conn_int_port(BIO *b, char *port);
 char *BIO_get_conn_hostname(BIO *b);
 char *BIO_get_conn_port(BIO *b);
 char *BIO_get_conn_ip(BIO *b, dummy);
 long BIO_get_conn_int_port(BIO *b, int port);

 long BIO_set_nbio(BIO *b, long n);

 int BIO_do_connect(BIO *b);

</PRE>


<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>
<I>BIO_s_connect()</I> returns the connect <FONT SIZE="-1">BIO</FONT> method. This is a wrapper
round the platform's <FONT SIZE="-1">TCP/IP</FONT> socket connection routines.
<P>

Using connect BIOs, <FONT SIZE="-1">TCP/IP</FONT> connections can be made and data
transferred using only <FONT SIZE="-1">BIO</FONT> routines. In this way any platform
specific operations are hidden by the <FONT SIZE="-1">BIO</FONT> abstraction.
<P>

Read and write operations on a connect <FONT SIZE="-1">BIO</FONT> will perform I/O
on the underlying connection. If no connection is established
and the port and hostname (see below) is set up properly then
a connection is established first.
<P>

Connect BIOs support <I>BIO_puts()</I> but not <I>BIO_gets()</I>.
<P>

If the close flag is set on a connect <FONT SIZE="-1">BIO</FONT> then any active
connection is shutdown and the socket closed when the <FONT SIZE="-1">BIO</FONT>
is freed.
<P>

Calling <I>BIO_reset()</I> on a connect <FONT SIZE="-1">BIO</FONT> will close any active
connection and reset the <FONT SIZE="-1">BIO</FONT> into a state where it can connect
to the same host again.
<P>

<I>BIO_get_fd()</I> places the underlying socket in <B>c</B> if it is not <FONT SIZE="-1">NULL</FONT>,
it also returns the socket . If <B>c</B> is not <FONT SIZE="-1">NULL</FONT> it should be of
type (int *).
<P>

<I>BIO_set_conn_hostname()</I> uses the string <B>name</B> to set the hostname.
The hostname can be an <FONT SIZE="-1">IP</FONT> address. The hostname can also include the
port in the form hostname:port . It is also acceptable to use the
form ``hostname/any/other/path'' or ``hostname:port/any/other/path''.
<P>

<I>BIO_set_conn_port()</I> sets the port to <B>port</B>. <B>port</B> can be the
numerical form or a string such as ``http''. A string will be looked
up first using <I>getservbyname()</I> on the host platform but if that
fails a standard table of port names will be used. Currently the
list is http, telnet, socks, https, ssl, ftp, gopher and wais.
<P>

<I>BIO_set_conn_ip()</I> sets the <FONT SIZE="-1">IP</FONT> address to <B>ip</B> using binary form,
that is four bytes specifying the <FONT SIZE="-1">IP</FONT> address in big-endian form.
<P>

<I>BIO_set_conn_int_port()</I> sets the port using <B>port</B>. <B>port</B> should
be of type (int *).
<P>

<I>BIO_get_conn_hostname()</I> returns the hostname of the connect <FONT SIZE="-1">BIO</FONT> or
<FONT SIZE="-1">NULL</FONT> if the <FONT SIZE="-1">BIO</FONT> is initialized but no hostname is set.
This return value is an internal pointer which should not be modified.
<P>

<I>BIO_get_conn_port()</I> returns the port as a string.
<P>

<I>BIO_get_conn_ip()</I> returns the <FONT SIZE="-1">IP</FONT> address in binary form.
<P>

<I>BIO_get_conn_int_port()</I> returns the port as an int.
<P>

<I>BIO_set_nbio()</I> sets the non blocking I/O flag to <B>n</B>. If <B>n</B> is
zero then blocking I/O is set. If <B>n</B> is 1 then non blocking I/O
is set. Blocking I/O is the default. The call to <I>BIO_set_nbio()</I>
should be made before the connection is established because 
non blocking I/O is set during the connect process.
<P>

<I>BIO_new_connect()</I> combines <I>BIO_new()</I> and <I>BIO_set_conn_hostname()</I> into
a single call: that is it creates a new connect <FONT SIZE="-1">BIO</FONT> with <B>name</B>.
<P>

<I>BIO_do_connect()</I> attempts to connect the supplied <FONT SIZE="-1">BIO</FONT>. It returns 1
if the connection was established successfully. A zero or negative
value is returned if the connection could not be established, the
call <I>BIO_should_retry()</I> should be used for non blocking connect BIOs
to determine if the call should be retried.
<A NAME="lbAE">&nbsp;</A>
<H2>NOTES</H2>

<A NAME="ixAAE"></A>
If blocking I/O is set then a non positive return value from any
I/O call is caused by an error condition, although a zero return
will normally mean that the connection was closed.
<P>

If the port name is supplied as part of the host name then this will
override any value set with <I>BIO_set_conn_port()</I>. This may be undesirable
if the application does not wish to allow connection to arbitrary
ports. This can be avoided by checking for the presence of the ':'
character in the passed hostname and either indicating an error or
truncating the string at that point.
<P>

The values returned by <I>BIO_get_conn_hostname()</I>, <I>BIO_get_conn_port()</I>,
<I>BIO_get_conn_ip()</I> and <I>BIO_get_conn_int_port()</I> are updated when a
connection attempt is made. Before any connection attempt the values
returned are those set by the application itself.
<P>

Applications do not have to call <I>BIO_do_connect()</I> but may wish to do
so to separate the connection process from other I/O processing.
<P>

If non blocking I/O is set then retries will be requested as appropriate.
<P>

It addition to <I>BIO_should_read()</I> and <I>BIO_should_write()</I> it is also
possible for <I>BIO_should_io_special()</I> to be true during the initial
connection process with the reason <FONT SIZE="-1">BIO_RR_CONNECT</FONT>. If this is returned
then this is an indication that a connection attempt would block,
the application should then take appropriate action to wait until
the underlying socket has connected and retry the call.
<P>

<I>BIO_set_conn_hostname()</I>, <I>BIO_set_conn_port()</I>, <I>BIO_set_conn_ip()</I>,
<I>BIO_set_conn_int_port()</I>, <I>BIO_get_conn_hostname()</I>, <I>BIO_get_conn_port()</I>,
<I>BIO_get_conn_ip()</I>, <I>BIO_get_conn_int_port()</I>, <I>BIO_set_nbio()</I> and
<I>BIO_do_connect()</I> are macros.
<A NAME="lbAF">&nbsp;</A>
<H2>RETURN VALUES</H2>

<A NAME="ixAAF"></A>
<I>BIO_s_connect()</I> returns the connect <FONT SIZE="-1">BIO</FONT> method.
<P>

<I>BIO_get_fd()</I> returns the socket or -1 if the <FONT SIZE="-1">BIO</FONT> has not
been initialized.
<P>

<I>BIO_set_conn_hostname()</I>, <I>BIO_set_conn_port()</I>, <I>BIO_set_conn_ip()</I> and
<I>BIO_set_conn_int_port()</I> always return 1.
<P>

<I>BIO_get_conn_hostname()</I> returns the connected hostname or <FONT SIZE="-1">NULL</FONT> is
none was set.
<P>

<I>BIO_get_conn_port()</I> returns a string representing the connected
port or <FONT SIZE="-1">NULL</FONT> if not set.
<P>

<I>BIO_get_conn_ip()</I> returns a pointer to the connected <FONT SIZE="-1">IP</FONT> address in
binary form or all zeros if not set.
<P>

<I>BIO_get_conn_int_port()</I> returns the connected port or 0 if none was
set.
<P>

<I>BIO_set_nbio()</I> always returns 1.
<P>

<I>BIO_do_connect()</I> returns 1 if the connection was successfully
established and 0 or -1 if the connection failed.
<A NAME="lbAG">&nbsp;</A>
<H2>EXAMPLE</H2>

<A NAME="ixAAG"></A>
This is example connects to a webserver on the local host and attempts
to retrieve a page and copy the result to standard output.
<P>



<PRE>
 BIO *cbio, *out;
 int len;
 char tmpbuf[1024];
 ERR_load_crypto_strings();
 cbio = BIO_new_connect(&quot;localhost:http&quot;);
 out = BIO_new_fp(stdout, BIO_NOCLOSE);
 if(BIO_do_connect(cbio) &lt;= 0) {
        fprintf(stderr, &quot;Error connecting to server\n&quot;);
        ERR_print_errors_fp(stderr);
        /* whatever ... */
        }
 BIO_puts(cbio, &quot;GET / HTTP/1.0\n\n&quot;);
 for(;;) {      
        len = BIO_read(cbio, tmpbuf, 1024);
        if(len &lt;= 0) break;
        BIO_write(out, tmpbuf, len);
 }
 BIO_free(cbio);
 BIO_free(out);

</PRE>


<A NAME="lbAH">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAAH"></A>
<FONT SIZE="-1">TBA</FONT>
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">NOTES</A><DD>
<DT><A HREF="#lbAF">RETURN VALUES</A><DD>
<DT><A HREF="#lbAG">EXAMPLE</A><DD>
<DT><A HREF="#lbAH">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:13 GMT, December 24, 2015
</div></div>
</body>
</HTML>
