<!DOCTYPE html>

<HTML><head><TITLE>Manpage of sepol_genusers</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux man pages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>sepol_genusers</H1>
Section: SE Linux binary policy API documentation (3)<BR>Updated: 15 March 2005<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

sepol_genusers - Generate a new binary policy image with a customized user configuration
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>#include &lt;<A HREF="file:/usr/include/sepol/sepol.h">sepol/sepol.h</A>&gt;</B>

<P>
<B>int sepol_genusers(void *</B><I>data</I><B>, size_t len</B><I>, const char *</I><B>usersdir</B><I>, void *</I><B>newdata</B><I>, size_t *</I><B>newlen);</B>

<P>
<B>void sepol_set_delusers(int </B><I>on</I><B>);</B>

<P>
<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<B>sepol_genusers</B>

generates a new binary policy image from 
an existing binary policy image stored in the memory region described by
the starting address
<I>data</I>

and the length
<I>len</I>

and a pair of user configuration files named 
<B>system.users </B>

and
<B>local.users</B>

from the directory specified by
<I>usersdir.</I>

The resulting binary policy is placed into dynamically allocated
memory and the variables
<I>newdata</I>

and
<I>newlen</I>

are set to refer to the new binary image's starting address and length.
The original binary policy image is not modified.
<P>
By default, 
<B>sepol_genusers</B>

will preserve user entries that are defined in the original binary policy image
but not defined in the user configuration files.  If such user entries
should instead by omitted entirely from the new binary policy image, then
the
<B>sepol_set_delusers</B>

function may be called with 
<I>on</I>

set to 1 prior to calling
<B>sepol_genusers</B>

in order to enable deletion of such users.
<P>
<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUE</H2>

Returns 0 on success or -1 otherwise, with errno set appropriately.
An errno of ENOENT indicates that one or both of the user
configuration files did not exist.  An errno of EINVAL indicates that
either the original binary policy image or the generated one were
invalid.  An errno of ENOMEM indicates that insufficient memory was
available to process the original binary policy image or to generate
the new policy image.  Invalid entries in the user configuration files
are skipped with a warning.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">RETURN VALUE</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:39 GMT, December 24, 2015
</div></body>
</HTML>
