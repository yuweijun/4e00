<!DOCTYPE html>

<HTML><head><TITLE>Manpage of EVP_DigestInit</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux man pages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>EVP_DigestInit</H1>
Section: OpenSSL (3)<BR>Updated: 2012-08-23<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

EVP_MD_CTX_init, EVP_MD_CTX_create, EVP_DigestInit_ex, EVP_DigestUpdate,
EVP_DigestFinal_ex, EVP_MD_CTX_cleanup, EVP_MD_CTX_destroy, EVP_MAX_MD_SIZE,
EVP_MD_CTX_copy_ex, EVP_MD_CTX_copy, EVP_MD_type, EVP_MD_pkey_type, EVP_MD_size,
EVP_MD_block_size, EVP_MD_CTX_md, EVP_MD_CTX_size, EVP_MD_CTX_block_size, EVP_MD_CTX_type,
EVP_md_null, EVP_md2, EVP_md5, EVP_sha, EVP_sha1, EVP_sha224,
EVP_sha256, EVP_sha384, EVP_sha512, EVP_dss, EVP_dss1, EVP_mdc2,
EVP_ripemd160, EVP_get_digestbyname, EVP_get_digestbynid, EVP_get_digestbyobj -
EVP digest routines
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAC"></A>


<PRE>
 #include &lt;<A HREF="file:/usr/include/openssl/evp.h">openssl/evp.h</A>&gt;

 void EVP_MD_CTX_init(EVP_MD_CTX *ctx);
 EVP_MD_CTX *EVP_MD_CTX_create(void);

 int EVP_DigestInit_ex(EVP_MD_CTX *ctx, const EVP_MD *type, ENGINE *impl);
 int EVP_DigestUpdate(EVP_MD_CTX *ctx, const void *d, size_t cnt);
 int EVP_DigestFinal_ex(EVP_MD_CTX *ctx, unsigned char *md,
        unsigned int *s);

 int EVP_MD_CTX_cleanup(EVP_MD_CTX *ctx);
 void EVP_MD_CTX_destroy(EVP_MD_CTX *ctx);

 int EVP_MD_CTX_copy_ex(EVP_MD_CTX *out,const EVP_MD_CTX *in);  

 int EVP_DigestInit(EVP_MD_CTX *ctx, const EVP_MD *type);
 int EVP_DigestFinal(EVP_MD_CTX *ctx, unsigned char *md,
        unsigned int *s);

 int EVP_MD_CTX_copy(EVP_MD_CTX *out,EVP_MD_CTX *in);  

 #define EVP_MAX_MD_SIZE (16+20) /* The SSLv3 md5+sha1 type */


 #define EVP_MD_type(e)                 ((e)-&gt;type)
 #define EVP_MD_pkey_type(e)            ((e)-&gt;pkey_type)
 #define EVP_MD_size(e)                 ((e)-&gt;md_size)
 #define EVP_MD_block_size(e)           ((e)-&gt;block_size)

 #define EVP_MD_CTX_md(e)               (e)-&gt;digest)
 #define EVP_MD_CTX_size(e)             EVP_MD_size((e)-&gt;digest)
 #define EVP_MD_CTX_block_size(e)       EVP_MD_block_size((e)-&gt;digest)
 #define EVP_MD_CTX_type(e)             EVP_MD_type((e)-&gt;digest)

 const EVP_MD *EVP_md_null(void);
 const EVP_MD *EVP_md2(void);
 const EVP_MD *EVP_md5(void);
 const EVP_MD *EVP_sha(void);
 const EVP_MD *EVP_sha1(void);
 const EVP_MD *EVP_sha224(void);
 const EVP_MD *EVP_sha256(void);
 const EVP_MD *EVP_sha384(void);
 const EVP_MD *EVP_sha512(void);
 const EVP_MD *EVP_dss(void);
 const EVP_MD *EVP_dss1(void);
 const EVP_MD *EVP_mdc2(void);
 const EVP_MD *EVP_ripemd160(void);

 const EVP_MD *EVP_get_digestbyname(const char *name);
 #define EVP_get_digestbynid(a) EVP_get_digestbyname(OBJ_nid2sn(a))
 #define EVP_get_digestbyobj(a) EVP_get_digestbynid(OBJ_obj2nid(a))

</PRE>


<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>
The <FONT SIZE="-1">EVP</FONT> digest routines are a high level interface to message digests.
<P>

<I>EVP_MD_CTX_init()</I> initializes digest context <B>ctx</B>.
<P>

<I>EVP_MD_CTX_create()</I> allocates, initializes and returns a digest context.
<P>

<I>EVP_DigestInit_ex()</I> sets up digest context <B>ctx</B> to use a digest
<B>type</B> from <FONT SIZE="-1">ENGINE</FONT> <B>impl</B>. <B>ctx</B> must be initialized before calling this
function. <B>type</B> will typically be supplied by a function such as <I>EVP_sha1()</I>.
If <B>impl</B> is <FONT SIZE="-1">NULL</FONT> then the default implementation of digest <B>type</B> is used.
<P>

<I>EVP_DigestUpdate()</I> hashes <B>cnt</B> bytes of data at <B>d</B> into the
digest context <B>ctx</B>. This function can be called several times on the
same <B>ctx</B> to hash additional data.
<P>

<I>EVP_DigestFinal_ex()</I> retrieves the digest value from <B>ctx</B> and places
it in <B>md</B>. If the <B>s</B> parameter is not <FONT SIZE="-1">NULL</FONT> then the number of
bytes of data written (i.e. the length of the digest) will be written
to the integer at <B>s</B>, at most <B></B><FONT SIZE="-1"><B>EVP_MAX_MD_SIZE</B></FONT><B></B> bytes will be written.
After calling <I>EVP_DigestFinal_ex()</I> no additional calls to <I>EVP_DigestUpdate()</I>
can be made, but <I>EVP_DigestInit_ex()</I> can be called to initialize a new
digest operation.
<P>

<I>EVP_MD_CTX_cleanup()</I> cleans up digest context <B>ctx</B>, it should be called
after a digest context is no longer needed.
<P>

<I>EVP_MD_CTX_destroy()</I> cleans up digest context <B>ctx</B> and frees up the
space allocated to it, it should be called only on a context created
using <I>EVP_MD_CTX_create()</I>.
<P>

<I>EVP_MD_CTX_copy_ex()</I> can be used to copy the message digest state from
<B>in</B> to <B>out</B>. This is useful if large amounts of data are to be
hashed which only differ in the last few bytes. <B>out</B> must be initialized
before calling this function.
<P>

<I>EVP_DigestInit()</I> behaves in the same way as <I>EVP_DigestInit_ex()</I> except
the passed context <B>ctx</B> does not have to be initialized, and it always
uses the default digest implementation.
<P>

<I>EVP_DigestFinal()</I> is similar to <I>EVP_DigestFinal_ex()</I> except the digest
context <B>ctx</B> is automatically cleaned up.
<P>

<I>EVP_MD_CTX_copy()</I> is similar to <I>EVP_MD_CTX_copy_ex()</I> except the destination
<B>out</B> does not have to be initialized.
<P>

<I>EVP_MD_size()</I> and <I>EVP_MD_CTX_size()</I> return the size of the message digest
when passed an <B></B><FONT SIZE="-1"><B>EVP_MD</B></FONT><B></B> or an <B></B><FONT SIZE="-1"><B>EVP_MD_CTX</B></FONT><B></B> structure, i.e. the size of the
hash.
<P>

<I>EVP_MD_block_size()</I> and <I>EVP_MD_CTX_block_size()</I> return the block size of the
message digest when passed an <B></B><FONT SIZE="-1"><B>EVP_MD</B></FONT><B></B> or an <B></B><FONT SIZE="-1"><B>EVP_MD_CTX</B></FONT><B></B> structure.
<P>

<I>EVP_MD_type()</I> and <I>EVP_MD_CTX_type()</I> return the <FONT SIZE="-1">NID</FONT> of the <FONT SIZE="-1">OBJECT</FONT> <FONT SIZE="-1">IDENTIFIER</FONT>
representing the given message digest when passed an <B></B><FONT SIZE="-1"><B>EVP_MD</B></FONT><B></B> structure.
For example EVP_MD_type(<I>EVP_sha1()</I>) returns <B>NID_sha1</B>. This function is
normally used when setting <FONT SIZE="-1">ASN1</FONT> OIDs.
<P>

<I>EVP_MD_CTX_md()</I> returns the <B></B><FONT SIZE="-1"><B>EVP_MD</B></FONT><B></B> structure corresponding to the passed
<B></B><FONT SIZE="-1"><B>EVP_MD_CTX</B></FONT><B></B>.
<P>

<I>EVP_MD_pkey_type()</I> returns the <FONT SIZE="-1">NID</FONT> of the public key signing algorithm associated
with this digest. For example <I>EVP_sha1()</I> is associated with <FONT SIZE="-1">RSA</FONT> so this will
return <B>NID_sha1WithRSAEncryption</B>. This ``link'' between digests and signature
algorithms may not be retained in future versions of OpenSSL.
<P>

<I>EVP_md2()</I>, <I>EVP_md5()</I>, <I>EVP_sha()</I>, <I>EVP_sha1()</I>, <I>EVP_sha224()</I>, <I>EVP_sha256()</I>,
<I>EVP_sha384()</I>, <I>EVP_sha512()</I>, <I>EVP_mdc2()</I> and <I>EVP_ripemd160()</I>
return <B></B><FONT SIZE="-1"><B>EVP_MD</B></FONT><B></B> structures for the <FONT SIZE="-1">MD2</FONT>, <FONT SIZE="-1">MD5</FONT>, <FONT SIZE="-1">SHA</FONT>, <FONT SIZE="-1">SHA1</FONT>, <FONT SIZE="-1">SHA224</FONT>, <FONT SIZE="-1">SHA256</FONT>, <FONT SIZE="-1">SHA384</FONT>,
<FONT SIZE="-1">SHA512</FONT>, <FONT SIZE="-1">MDC2</FONT> and <FONT SIZE="-1">RIPEMD160</FONT> digest algorithms respectively. The associated
signature algorithm is <FONT SIZE="-1">RSA</FONT> in each case.
<P>

<I>EVP_dss()</I> and <I>EVP_dss1()</I> return <B></B><FONT SIZE="-1"><B>EVP_MD</B></FONT><B></B> structures for <FONT SIZE="-1">SHA</FONT> and <FONT SIZE="-1">SHA1</FONT> digest
algorithms but using <FONT SIZE="-1">DSS</FONT> (<FONT SIZE="-1">DSA</FONT>) for the signature algorithm. Note: there is 
no need to use these pseudo-digests in OpenSSL 1.0.0 and later, they are
however retained for compatibility.
<P>

<I>EVP_md_null()</I> is a ``null'' message digest that does nothing: i.e. the hash it
returns is of zero length.
<P>

<I>EVP_get_digestbyname()</I>, <I>EVP_get_digestbynid()</I> and <I>EVP_get_digestbyobj()</I>
return an <B></B><FONT SIZE="-1"><B>EVP_MD</B></FONT><B></B> structure when passed a digest name, a digest <FONT SIZE="-1">NID</FONT> or
an <FONT SIZE="-1">ASN1_OBJECT</FONT> structure respectively. The digest table must be initialized
using, for example, <I>OpenSSL_add_all_digests()</I> for these functions to work.
<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUES</H2>

<A NAME="ixAAE"></A>
<I>EVP_DigestInit_ex()</I>, <I>EVP_DigestUpdate()</I> and <I>EVP_DigestFinal_ex()</I> return 1 for
success and 0 for failure.
<P>

<I>EVP_MD_CTX_copy_ex()</I> returns 1 if successful or 0 for failure.
<P>

<I>EVP_MD_type()</I>, <I>EVP_MD_pkey_type()</I> and <I>EVP_MD_type()</I> return the <FONT SIZE="-1">NID</FONT> of the
corresponding <FONT SIZE="-1">OBJECT</FONT> <FONT SIZE="-1">IDENTIFIER</FONT> or NID_undef if none exists.
<P>

<I>EVP_MD_size()</I>, <I>EVP_MD_block_size()</I>, EVP_MD_CTX_size(e), <I>EVP_MD_size()</I>,
<I>EVP_MD_CTX_block_size()</I><TT>&nbsp;</TT>and <I>EVP_MD_block_size()</I> return the digest or block<BR>
size in bytes.
<P>

<I>EVP_md_null()</I>, <I>EVP_md2()</I>, <I>EVP_md5()</I>, <I>EVP_sha()</I>, <I>EVP_sha1()</I>,
<I>EVP_sha224()</I>, <I>EVP_sha256()</I>, <I>EVP_sha384()</I>, <I>EVP_sha512()</I>, <I>EVP_dss()</I>,
<I>EVP_dss1()</I>, <I>EVP_mdc2()</I> and <I>EVP_ripemd160()</I> return pointers to the
corresponding <FONT SIZE="-1">EVP_MD</FONT> structures.
<P>

<I>EVP_get_digestbyname()</I>, <I>EVP_get_digestbynid()</I> and <I>EVP_get_digestbyobj()</I>
return either an <B></B><FONT SIZE="-1"><B>EVP_MD</B></FONT><B></B> structure or <FONT SIZE="-1">NULL</FONT> if an error occurs.
<A NAME="lbAF">&nbsp;</A>
<H2>NOTES</H2>

<A NAME="ixAAF"></A>
The <B></B><FONT SIZE="-1"><B>EVP</B></FONT><B></B> interface to message digests should almost always be used in
preference to the low level interfaces. This is because the code then becomes
transparent to the digest used and much more flexible.
<P>

<FONT SIZE="-1">SHA1</FONT> is the digest of choice for new applications. The other digest algorithms
are still in common use.
<P>

For most applications the <B>impl</B> parameter to <I>EVP_DigestInit_ex()</I> will be
set to <FONT SIZE="-1">NULL</FONT> to use the default digest implementation.
<P>

The functions <I>EVP_DigestInit()</I>, <I>EVP_DigestFinal()</I> and <I>EVP_MD_CTX_copy()</I> are 
obsolete but are retained to maintain compatibility with existing code. New
applications should use <I>EVP_DigestInit_ex()</I>, <I>EVP_DigestFinal_ex()</I> and 
<I>EVP_MD_CTX_copy_ex()</I> because they can efficiently reuse a digest context
instead of initializing and cleaning it up on each call and allow non default
implementations of digests to be specified.
<P>

In OpenSSL 0.9.7 and later if digest contexts are not cleaned up after use
memory leaks will occur.
<A NAME="lbAG">&nbsp;</A>
<H2>EXAMPLE</H2>

<A NAME="ixAAG"></A>
This example digests the data ``Test Message\n'' and ``Hello World\n'', using the
digest name passed on the command line.
<P>



<PRE>
 #include &lt;<A HREF="file:/usr/include/stdio.h">stdio.h</A>&gt;
 #include &lt;<A HREF="file:/usr/include/openssl/evp.h">openssl/evp.h</A>&gt;

 main(int argc, char *argv[])
 {
 EVP_MD_CTX mdctx;
 const EVP_MD *md;
 char mess1[] = &quot;Test Message\n&quot;;
 char mess2[] = &quot;Hello World\n&quot;;
 unsigned char md_value[EVP_MAX_MD_SIZE];
 int md_len, i;

 OpenSSL_add_all_digests();

 if(!argv[1]) {
        printf(&quot;Usage: mdtest digestname\n&quot;);
        <A HREF="/manpages/index.html?1+exit">exit</A>(1);
 }

 md = EVP_get_digestbyname(argv[1]);

 if(!md) {
        printf(&quot;Unknown message digest %s\n&quot;, argv[1]);
        <A HREF="/manpages/index.html?1+exit">exit</A>(1);
 }

 EVP_MD_CTX_init(&amp;mdctx);
 EVP_DigestInit_ex(&amp;mdctx, md, NULL);
 EVP_DigestUpdate(&amp;mdctx, mess1, strlen(mess1));
 EVP_DigestUpdate(&amp;mdctx, mess2, strlen(mess2));
 EVP_DigestFinal_ex(&amp;mdctx, md_value, &amp;md_len);
 EVP_MD_CTX_cleanup(&amp;mdctx);

 printf(&quot;Digest is: &quot;);
 for(i = 0; i &lt; md_len; i++) printf(&quot;%02x&quot;, md_value[i]);
 printf(&quot;\n&quot;);
 }

</PRE>


<A NAME="lbAH">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAAH"></A>
<I><A HREF="/manpages/index.html?3+evp">evp</A></I>(3), <I><A HREF="http://localhost/cgi-bin/man/man2html?3+hmac">hmac</A></I>(3), <I><A HREF="http://localhost/cgi-bin/man/man2html?3+md2">md2</A></I>(3),
<I><A HREF="/manpages/index.html?3+md5">md5</A></I>(3), <I><A HREF="http://localhost/cgi-bin/man/man2html?3+mdc2">mdc2</A></I>(3), <I><A HREF="http://localhost/cgi-bin/man/man2html?3+ripemd">ripemd</A></I>(3),
<I><A HREF="/manpages/index.html?3+sha">sha</A></I>(3), <I><A HREF="http://localhost/cgi-bin/man/man2html?1+dgst">dgst</A></I>(1)
<A NAME="lbAI">&nbsp;</A>
<H2>HISTORY</H2>

<A NAME="ixAAI"></A>
<I>EVP_DigestInit()</I>, <I>EVP_DigestUpdate()</I> and <I>EVP_DigestFinal()</I> are
available in all versions of SSLeay and OpenSSL.
<P>

<I>EVP_MD_CTX_init()</I>, <I>EVP_MD_CTX_create()</I>, <I>EVP_MD_CTX_copy_ex()</I>,
<I>EVP_MD_CTX_cleanup()</I>, <I>EVP_MD_CTX_destroy()</I>, <I>EVP_DigestInit_ex()</I>
and <I>EVP_DigestFinal_ex()</I> were added in OpenSSL 0.9.7.
<P>

<I>EVP_md_null()</I>, <I>EVP_md2()</I>, <I>EVP_md5()</I>, <I>EVP_sha()</I>, <I>EVP_sha1()</I>,
<I>EVP_dss()</I>, <I>EVP_dss1()</I>, <I>EVP_mdc2()</I> and <I>EVP_ripemd160()</I> were
changed to return truely const <FONT SIZE="-1">EVP_MD</FONT> * in OpenSSL 0.9.7.
<P>

The link between digests and signing algorithms was fixed in OpenSSL 1.0 and
later, so now <I>EVP_sha1()</I> can be used with <FONT SIZE="-1">RSA</FONT> and <FONT SIZE="-1">DSA</FONT>, there is no need to
use <I>EVP_dss1()</I> any more.
<P>

OpenSSL 1.0 and later does not include the <FONT SIZE="-1">MD2</FONT> digest algorithm in the
default configuration due to its security weaknesses.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">RETURN VALUES</A><DD>
<DT><A HREF="#lbAF">NOTES</A><DD>
<DT><A HREF="#lbAG">EXAMPLE</A><DD>
<DT><A HREF="#lbAH">SEE ALSO</A><DD>
<DT><A HREF="#lbAI">HISTORY</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:26 GMT, December 24, 2015
</div></body>
</HTML>
