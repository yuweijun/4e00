<!DOCTYPE html>

<HTML><head><TITLE>Manpage of KEYCTL_SEARCH</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux manpages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>KEYCTL_SEARCH</H1>
Section: Linux Key Management Calls (3)<BR>Updated: 4 May 2006<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>


<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

keyctl_search - Search a keyring for a key

<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<PRE>
<B>#include &lt;<A HREF="file:/usr/include/keyutils.h">keyutils.h</A>&gt;</B>

<B>long keyctl_search(key_serial_t </B><I>keyring</I><B>, const char *</B><I>type</I><B>,</B>
<B>const char *</B><I>description</I><B>, key_serial_t </B><I>destination</I><B>);</B>
</PRE><A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<B>keyctl_search</B>()

recursively searches the
<I>keyring</I>

for a key of the specified
<I>type</I>

and
<I>description</I>.


If found, the key will be attached to the
<I>destination</I>

keyring (if given), and its serial number will be returned.

The source keyring must grant
<B>search</B>

permission to the caller, and for a key to be found, it must also grant
<B>search</B>

permission to the caller.  Child keyrings will be only be recursively searched
if they grant
<B>search</B>

permission to the caller as well.

If the destination keyring is
<B>zero</B>,

no attempt will be made to forge a link to the key, and just the serial number
will be returned.

If the destination keyring is given, then the link may only be formed if the
found key grants the caller
<B>link</B>

permission and the destination keyring grants the caller
<B>write</B>

permission.

If the search is successful, and if the destination keyring already contains a
link to a key that matches the specified
<I>type</I> and <I>description</I>,

then that link will be replaced by a link to the found key.

The source keyring and destination keyring serial numbers may be those of
valid keyrings to which the caller has appropriate permission, or they may be
special keyring IDs:
<DL COMPACT>
<DT><B>KEY_SPEC_THREAD_KEYRING</B>

<DD>
This specifies the caller's thread-specific keyring.
<DT><B>KEY_SPEC_PROCESS_KEYRING</B>

<DD>
This specifies the caller's process-specific keyring.
<DT><B>KEY_SPEC_SESSION_KEYRING</B>

<DD>
This specifies the caller's session-specific keyring.
<DT><B>KEY_SPEC_USER_KEYRING</B>

<DD>
This specifies the caller's UID-specific keyring.
<DT><B>KEY_SPEC_USER_SESSION_KEYRING</B>

<DD>
This specifies the caller's UID-session keyring.

</DL>
<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUE</H2>

On success
<B>keyctl_search</B>()

returns the serial number of the key it found.  On error, the value
<B>-1</B>

will be returned and errno will have been set to an appropriate error.

<A NAME="lbAF">&nbsp;</A>
<H2>ERRORS</H2>

<DL COMPACT>
<DT><B>ENOKEY</B>

<DD>
One of the keyrings doesn't exist, no key was found by the search, or the only
key found by the search was a negative key.
<DT><B>ENOTDIR</B>

<DD>
One of the keyrings is a valid key that isn't a keyring.
<DT><B>EKEYEXPIRED</B>

<DD>
One of the keyrings has expired, or the only key found was expired.
<DT><B>EKEYREVOKED</B>

<DD>
One of the keyrings has been revoked, or the only key found was revoked.
<DT><B>ENOMEM</B>

<DD>
Insufficient memory to expand the destination keyring.
<DT><B>EDQUOT</B>

<DD>
The key quota for this user would be exceeded by creating a link to the found
key in the destination keyring.
<DT><B>EACCES</B>

<DD>
The source keyring didn't grant
<B>search</B>

permission, the destination keyring didn't grant
<B>write</B>

permission or the found key didn't grant
<B>link</B>

permission to the caller.

</DL>
<A NAME="lbAG">&nbsp;</A>
<H2>LINKING</H2>

Although this is a Linux system call, it is not present in
<I>libc</I>

but can be found rather in
<I>libkeyutils</I>.

When linking,
<B>-lkeyutils</B>

should be specified to the linker.

<A NAME="lbAH">&nbsp;</A>
<H2>SEE ALSO</H2>

<B><A HREF="/manpages/index.html?1+keyctl">keyctl</A></B>(1),

<BR>

<B><A HREF="/manpages/index.html?2+add_key">add_key</A></B>(2),

<BR>

<B><A HREF="/manpages/index.html?2+keyctl">keyctl</A></B>(2),

<BR>

<B><A HREF="/manpages/index.html?2+request_key">request_key</A></B>(2),

<BR>

<B><A HREF="/manpages/index.html?3+keyctl">keyctl</A></B>(3),

<BR>

<B><A HREF="/manpages/index.html?8+request-key">request-key</A></B>(8)

<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">RETURN VALUE</A><DD>
<DT><A HREF="#lbAF">ERRORS</A><DD>
<DT><A HREF="#lbAG">LINKING</A><DD>
<DT><A HREF="#lbAH">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:30 GMT, December 24, 2015
</div></body>
</HTML>
