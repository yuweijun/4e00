<!DOCTYPE html>

<HTML><head><TITLE>Manpage of get_ordered_context_list</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux man pages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>get_ordered_context_list</H1>
Section: SELinux (3)<BR>Updated: 1 January 2004<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

get_ordered_context_list, get_ordered_context_list_with_level, get_default_context, get_default_context_with_level, get_default_context_with_role, get_default_context_with_rolelevel, query_user_context, manual_user_enter_context, get_default_role - determine SELinux context(s) for user sessions
<P>
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>#include &lt;<A HREF="file:/usr/include/selinux/selinux.h">selinux/selinux.h</A>&gt;</B>

<P>
<B>#include &lt;<A HREF="file:/usr/include/selinux/get_context_list.h">selinux/get_context_list.h</A>&gt;</B>

<P>
<B>int get_ordered_context_list(const char *</B><I>user</I><B>, security_context_t fromcon</B><I>, security_context_t **</I><B>list</B><I>);</I>

<P>
<B>int get_ordered_context_list_with_level(const char *</B><I>user</I><B>, const char *</B><I>level</I><B>, security_context_t fromcon</B><I>, security_context_t **</I><B>list</B><I>);</I>

<P>
<B>int get_default_context(const char *</B><I>user</I><B>, security_context_t fromcon</B><I>, security_context_t *</I><B>newcon</B><I>);</I>

<P>
<B>int get_default_context_with_level(const char *</B><I>user</I><B>, const char *</B><I>level</I><B>, security_context_t fromcon</B><I>, security_context_t *</I><B>newcon</B><I>);</I>

<P>
<B>int get_default_context_with_role(const char* </B><I>user</I><B>, const char *</B><I>role</I><B>, security_context_t </B><I>fromcon</I><B>, security_context_t *</B><I>newcon</I><B>);</B>

<P>
<B>int get_default_context_with_rolelevel(const char* </B><I>user</I><B>, const char* </B><I>level</I><B>, const char *</B><I>role</I><B>, security_context_t </B><I>fromcon</I><B>, security_context_t *</B><I>newcon</I><B>);</B>

<P>
<B>int query_user_context(security_context_t *</B><I>list</I><B>, security_context_t *</B><I>newcon</I><B>);</B>

<P>
<B>int manual_user_enter_context(const char *</B><I>user</I><B>, security_context_t *</B><I>newcon</I><B>);</B>

<P>
<B>int get_default_type(const char *</B><I>role</I><B>, char **</B><I>type</I><B>);</B>

<P>
<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<B>get_ordered_context_list</B>

invokes the 
<B>security_compute_user</B>

function to obtain the list of contexts for the specified
<I>user</I>

that are reachable from the specified
<I>fromcon</I>

context.  The function then orders the resulting list based on the global
<B>/etc/selinux/&lt;SELINUXTYPE&gt;/contexts/default_contexts</B>

file and the per-user
<B>/etc/selinux/&lt;SELINUXTYPE&gt;/contexts/users/&lt;username&gt;</B>

file if it exists.  The 
<I>fromcon</I>

parameter may be NULL to indicate that the current context should
be used.  The function returns the number of contexts in the
list, or -1 upon errors.  The list must be freed using the
<B>freeconary</B>

function.
<P>
<B>get_ordered_context_list_with_level</B>

invokes the get_ordered_context_list function and applies the specified level.
<P>
<B>get_default_context</B>

is the same as get_ordered_context_list but only returns a single context
which has to be freed with freecon.
<P>
<B>get_default_context_with_level</B>

invokes the get_default_context function and applies the specified level.
<P>
<B>get_default_context_with_role</B>

is the same as get_default_context but only returns a context with the specified role, returning -1 if no such context is reachable for the user.
<P>
<B>get_default_context_with_rolelevel</B>

invokes the get_default_context_with_role function and applies the specified level.
<P>
<B>query_user_context</B>

takes a list of contexts, queries the user via stdin/stdout as to which context
they want, and returns a new context as selected by the user (which has to be
freed with freecon).
<P>
<B>manual_user_enter_context</B>

allows the user to manually enter a context as a fallback if a list of authorized contexts could not be obtained. Caller must free via freecon.
<P>
<B>get_default_type</B>

Get the default type (domain) for 'role' and set 'type' to refer to it, which has to be freed with free.
<P>
<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUE</H2>

get_ordered_context_list and get_ordered_context_list_with_level return the number of contexts in the list upon success or -1 upon errors.
The other functions return 0 for success or -1 for errors.
<P>
<A NAME="lbAF">&nbsp;</A>
<H2>SEE ALSO</H2>

<B><A HREF="/manpages/index.html?8+selinux">selinux</A></B>(8), <B><A HREF="http://localhost/cgi-bin/man/man2html?3+freeconary">freeconary</A></B>(3), <B><A HREF="http://localhost/cgi-bin/man/man2html?3+freecon">freecon</A></B>(3), <B><A HREF="http://localhost/cgi-bin/man/man2html?3+security_compute_av">security_compute_av</A></B>(3),<B><A HREF="http://localhost/cgi-bin/man/man2html?3+getseuserbyname">getseuserbyname</A>(3)</B>

<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">RETURN VALUE</A><DD>
<DT><A HREF="#lbAF">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:28 GMT, December 24, 2015
</div></body>
</HTML>
