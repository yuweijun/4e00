<!DOCTYPE html>

<HTML><head><TITLE>Manpage of X509_STORE_CTX_new</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux man pages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>X509_STORE_CTX_new</H1>
Section: OpenSSL (3)<BR>Updated: 2009-10-18<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

X509_STORE_CTX_new, X509_STORE_CTX_cleanup, X509_STORE_CTX_free, X509_STORE_CTX_init, X509_STORE_CTX_trusted_stack, X509_STORE_CTX_set_cert, X509_STORE_CTX_set_chain, X509_STORE_CTX_set0_crls, X509_STORE_CTX_get0_param, X509_STORE_CTX_set0_param, X509_STORE_CTX_set_default - X509_STORE_CTX initialisation
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAC"></A>


<PRE>
 #include &lt;<A HREF="file:/usr/include/openssl/x509_vfy.h">openssl/x509_vfy.h</A>&gt;

 X509_STORE_CTX *X509_STORE_CTX_new(void);
 void X509_STORE_CTX_cleanup(X509_STORE_CTX *ctx);
 void X509_STORE_CTX_free(X509_STORE_CTX *ctx);

 int X509_STORE_CTX_init(X509_STORE_CTX *ctx, X509_STORE *store,
                         X509 *x509, STACK_OF(X509) *chain);

 void X509_STORE_CTX_trusted_stack(X509_STORE_CTX *ctx, STACK_OF(X509) *sk);

 void   X509_STORE_CTX_set_cert(X509_STORE_CTX *ctx,X509 *x);
 void   X509_STORE_CTX_set_chain(X509_STORE_CTX *ctx,STACK_OF(X509) *sk);
 void   X509_STORE_CTX_set0_crls(X509_STORE_CTX *ctx, STACK_OF(X509_CRL) *sk);

 X509_VERIFY_PARAM *X509_STORE_CTX_get0_param(X509_STORE_CTX *ctx);
 void X509_STORE_CTX_set0_param(X509_STORE_CTX *ctx, X509_VERIFY_PARAM *param);
 int X509_STORE_CTX_set_default(X509_STORE_CTX *ctx, const char *name);

</PRE>


<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>
These functions initialise an <B>X509_STORE_CTX</B> structure for subsequent use
by <I>X509_verify_cert()</I>.
<P>

<I>X509_STORE_CTX_new()</I> returns a newly initialised <B>X509_STORE_CTX</B> structure.
<P>

<I>X509_STORE_CTX_cleanup()</I> internally cleans up an <B>X509_STORE_CTX</B> structure.
The context can then be reused with an new call to <I>X509_STORE_CTX_init()</I>.
<P>

<I>X509_STORE_CTX_free()</I> completely frees up <B>ctx</B>. After this call <B>ctx</B>
is no longer valid.
<P>

<I>X509_STORE_CTX_init()</I> sets up <B>ctx</B> for a subsequent verification operation.
The trusted certificate store is set to <B>store</B>, the end entity certificate
to be verified is set to <B>x509</B> and a set of additional certificates (which
will be untrusted but may be used to build the chain) in <B>chain</B>. Any or
all of the <B>store</B>, <B>x509</B> and <B>chain</B> parameters can be <B></B><FONT SIZE="-1"><B>NULL</B></FONT><B></B>.
<P>

<I>X509_STORE_CTX_trusted_stack()</I> sets the set of trusted certificates of <B>ctx</B>
to <B>sk</B>. This is an alternative way of specifying trusted certificates 
instead of using an <B>X509_STORE</B>.
<P>

<I>X509_STORE_CTX_set_cert()</I> sets the certificate to be vertified in <B>ctx</B> to
<B>x</B>.
<P>

<I>X509_STORE_CTX_set_chain()</I> sets the additional certificate chain used by <B>ctx</B>
to <B>sk</B>.
<P>

<I>X509_STORE_CTX_set0_crls()</I> sets a set of CRLs to use to aid certificate
verification to <B>sk</B>. These CRLs will only be used if <FONT SIZE="-1">CRL</FONT> verification is
enabled in the associated <B>X509_VERIFY_PARAM</B> structure. This might be
used where additional ``useful'' CRLs are supplied as part of a protocol,
for example in a PKCS#7 structure.
<P>

X509_VERIFY_PARAM *<I>X509_STORE_CTX_get0_param()</I> retrieves an intenal pointer
to the verification parameters associated with <B>ctx</B>.
<P>

<I>X509_STORE_CTX_set0_param()</I> sets the intenal verification parameter pointer
to <B>param</B>. After this call <B>param</B> should not be used.
<P>

<I>X509_STORE_CTX_set_default()</I> looks up and sets the default verification
method to <B>name</B>. This uses the function <I>X509_VERIFY_PARAM_lookup()</I> to
find an appropriate set of parameters from <B>name</B>.
<A NAME="lbAE">&nbsp;</A>
<H2>NOTES</H2>

<A NAME="ixAAE"></A>
The certificates and CRLs in a store are used internally and should <B>not</B>
be freed up until after the associated <B>X509_STORE_CTX</B> is freed. Legacy
applications might implicitly use an <B>X509_STORE_CTX</B> like this:
<P>



<PRE>
  X509_STORE_CTX ctx;
  X509_STORE_CTX_init(&amp;ctx, store, cert, chain);

</PRE>


<P>

this is <B>not</B> recommended in new applications they should instead do:
<P>



<PRE>
  X509_STORE_CTX *ctx;
  ctx = X509_STORE_CTX_new();
  if (ctx == NULL)
        /* Bad error */
  X509_STORE_CTX_init(ctx, store, cert, chain);

</PRE>


<A NAME="lbAF">&nbsp;</A>
<H2>BUGS</H2>

<A NAME="ixAAF"></A>
The certificates and CRLs in a context are used internally and should <B>not</B>
be freed up until after the associated <B>X509_STORE_CTX</B> is freed. Copies
should be made or reference counts increased instead.
<A NAME="lbAG">&nbsp;</A>
<H2>RETURN VALUES</H2>

<A NAME="ixAAG"></A>
<I>X509_STORE_CTX_new()</I> returns an newly allocates context or <B></B><FONT SIZE="-1"><B>NULL</B></FONT><B></B> is an
error occurred.
<P>

<I>X509_STORE_CTX_init()</I> returns 1 for success or 0 if an error occurred.
<P>

<I>X509_STORE_CTX_get0_param()</I> returns a pointer to an <B>X509_VERIFY_PARAM</B>
structure or <B></B><FONT SIZE="-1"><B>NULL</B></FONT><B></B> if an error occurred.
<P>

<I>X509_STORE_CTX_cleanup()</I>, <I>X509_STORE_CTX_free()</I>, <I>X509_STORE_CTX_trusted_stack()</I>,
<I>X509_STORE_CTX_set_cert()</I>, <I>X509_STORE_CTX_set_chain()</I>,
<I>X509_STORE_CTX_set0_crls()</I> and <I>X509_STORE_CTX_set0_param()</I> do not return
values.
<P>

<I>X509_STORE_CTX_set_default()</I> returns 1 for success or 0 if an error occurred.
<A NAME="lbAH">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAAH"></A>
<I><A HREF="/manpages/index.html?3+X509_verify_cert">X509_verify_cert</A></I>(3)
<I><A HREF="/manpages/index.html?3+X509_VERIFY_PARAM_set_flags">X509_VERIFY_PARAM_set_flags</A></I>(3)
<A NAME="lbAI">&nbsp;</A>
<H2>HISTORY</H2>

<A NAME="ixAAI"></A>
<I>X509_STORE_CTX_set0_crls()</I> was first added to OpenSSL 1.0.0
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">NOTES</A><DD>
<DT><A HREF="#lbAF">BUGS</A><DD>
<DT><A HREF="#lbAG">RETURN VALUES</A><DD>
<DT><A HREF="#lbAH">SEE ALSO</A><DD>
<DT><A HREF="#lbAI">HISTORY</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:45 GMT, December 24, 2015
</div></body>
</HTML>
