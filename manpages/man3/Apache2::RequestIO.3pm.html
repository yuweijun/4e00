<!DOCTYPE html>

<HTML><head><TITLE>Manpage of docs::api::Apache2::RequestIO</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux man pages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>docs::api::Apache2::RequestIO</H1>
Section: User Contributed Perl Documentation (3)<BR>Updated: 2007-11-12<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

Apache2::RequestIO - Perl API for Apache request record IO
<A NAME="lbAC">&nbsp;</A>
<H2>Synopsis</H2>

<A NAME="ixAAC"></A>


<PRE>
  use Apache2::RequestIO ();
  
  $rc = $r-&gt;discard_request_body();
  
  $r-&gt;print(&quot;foo&quot;, &quot;bar&quot;);
  $r-&gt;puts(&quot;foo&quot;, &quot;bar&quot;); # same as print, but no flushing
  $r-&gt;printf(&quot;%s $d&quot;, &quot;foo&quot;, 5);
  
  $r-&gt;read($buffer, $len);
  
  $r-&gt;rflush();
  
  $r-&gt;sendfile($filename);
  
  $r-&gt;write(&quot;foobartarcar&quot;, 3, 5);

</PRE>


<A NAME="lbAD">&nbsp;</A>
<H2>Description</H2>

<A NAME="ixAAD"></A>
<TT>&quot;Apache2::RequestIO&quot;</TT> provides the <FONT SIZE="-1">API</FONT> to perform <FONT SIZE="-1">IO</FONT> on the Apache
request object.
<A NAME="lbAE">&nbsp;</A>
<H2>API</H2>

<A NAME="ixAAE"></A>
<TT>&quot;Apache2::RequestIO&quot;</TT> provides the following functions and/or methods:
<A NAME="lbAF">&nbsp;</A>
<H3>discard_request_body</H3>



<A NAME="ixAAF"></A>
In <FONT SIZE="-1">HTTP/1</FONT>.1, any method can have a body.  However, most <FONT SIZE="-1">GET</FONT> handlers
wouldn't know what to do with a request body if they received one.
This helper routine tests for and reads any message body in the
request, simply discarding whatever it receives.  We need to do this
because failing to read the request body would cause it to be
interpreted as the next request on a persistent connection.
<P>



<PRE>
  $rc = $r-&gt;discard_request_body();

</PRE>


<DL COMPACT>
<DT>obj: $r ( Apache2::RequestRec object )<DD>


<A NAME="ixAAG"></A>
The current request
<DT>ret: $rc ( integer )<DD>


<A NAME="ixAAH"></A>
<TT>&quot;APR::Const status constant&quot;</TT> if request
is malformed, <TT>&quot;Apache2::Const::OK&quot;</TT> otherwise.
<DT>since: 2.0.00<DD>
<A NAME="ixAAI"></A>
</DL>
<P>

Since we return an error status if the request is malformed, this
routine should be called at the beginning of a no-body handler, e.g.,
<P>



<PRE>
   use Apache2::Const -compile =&gt; qw(OK);
   $rc = $r-&gt;discard_request_body;
   return $rc if $rc != Apache2::Const::OK;

</PRE>


<A NAME="lbAG">&nbsp;</A>
<H3>print</H3>



<A NAME="ixAAJ"></A>
Send data to the client.
<P>



<PRE>
  $cnt = $r-&gt;print(@msg);

</PRE>


<DL COMPACT>
<DT>obj: $r ( Apache2::RequestRec object )<DD>


<A NAME="ixAAK"></A>

<DT>arg1: @msg ( <FONT SIZE="-1">ARRAY</FONT> )<DD>


<A NAME="ixAAL"></A>

Data to send
<DT>ret: $cnt ( number )<DD>


<A NAME="ixAAM"></A>
How many bytes were sent (or buffered).  If zero bytes were
sent, <TT>&quot;print&quot;</TT> will return <TT>0E0</TT>, or ``zero but true,'' which
will still evaluate to <TT>0</TT> in a numerical context.
<DT>excpt: APR::Error<DD>


<A NAME="ixAAN"></A>

<DT>since: 2.0.00<DD>
<A NAME="ixAAO"></A>

</DL>
<P>

The data is flushed only if <FONT SIZE="-1">STDOUT</FONT> stream's <TT>$|</TT> is true. Otherwise
it's buffered up to the size of the buffer, flushing only excessive
data.
<A NAME="lbAH">&nbsp;</A>
<H3>printf</H3>



<A NAME="ixAAP"></A>
Format and send data to the client (same as <TT>&quot;printf&quot;</TT>).
<P>



<PRE>
  $cnt = $r-&gt;printf($format, @args);

</PRE>


<DL COMPACT>
<DT>obj: $r ( Apache2::RequestRec object )<DD>


<A NAME="ixAAQ"></A>

<DT>arg1: $format ( string )<DD>


<A NAME="ixAAR"></A>

Format string, as in the Perl core <TT>&quot;printf&quot;</TT> function.
<DT>arg2: @args ( <FONT SIZE="-1">ARRAY</FONT> )<DD>


<A NAME="ixAAS"></A>
Arguments to be formatted, as in the Perl core <TT>&quot;printf&quot;</TT> function.
<DT>ret: $cnt ( number )<DD>


<A NAME="ixAAT"></A>
How many bytes were sent (or buffered)
<DT>excpt: APR::Error<DD>


<A NAME="ixAAU"></A>

<DT>since: 2.0.00<DD>
<A NAME="ixAAV"></A>

</DL>
<P>

The data is flushed only if <FONT SIZE="-1">STDOUT</FONT> stream's <TT>$|</TT> is true. Otherwise
it's buffered up to the size of the buffer, flushing only excessive
data.
<A NAME="lbAI">&nbsp;</A>
<H3>puts</H3>



<A NAME="ixAAW"></A>
Send data to the client
<P>



<PRE>
  $cnt = $r-&gt;puts(@msg);

</PRE>


<DL COMPACT>
<DT>obj: $r ( Apache2::RequestRec object )<DD>


<A NAME="ixAAX"></A>

<DT>arg1: @msg ( <FONT SIZE="-1">ARRAY</FONT> )<DD>


<A NAME="ixAAY"></A>

Data to send
<DT>ret: $cnt ( number )<DD>


<A NAME="ixAAZ"></A>
How many bytes were sent (or buffered)
<DT>excpt: APR::Error<DD>


<A NAME="ixABA"></A>

<DT>since: 2.0.00<DD>
<A NAME="ixABB"></A>

</DL>
<P>

<TT>&quot;puts()&quot;</TT> is similar to <TT>&quot;print()&quot;</TT>, but it won't attempt
to flush data, no matter what the value of <FONT SIZE="-1">STDOUT</FONT> stream's <TT>$|</TT>
is. Therefore assuming that <FONT SIZE="-1">STDOUT</FONT> stream's <TT>$|</TT> is true, this method
should be a tiny bit faster than <TT>&quot;print()&quot;</TT>, especially
if small strings are printed.
<A NAME="lbAJ">&nbsp;</A>
<H3>read</H3>



<A NAME="ixABC"></A>
Read data from the client.
<P>



<PRE>
  $cnt = $r-&gt;read($buffer, $len);
  $cnt = $r-&gt;read($buffer, $len, $offset);

</PRE>


<DL COMPACT>
<DT>obj: $r ( Apache2::RequestRec object )<DD>


<A NAME="ixABD"></A>

<DT>arg1: $buffer ( <FONT SIZE="-1">SCALAR</FONT> )<DD>


<A NAME="ixABE"></A>

The buffer to populate with the read data
<DT>arg2: $len ( number )<DD>


<A NAME="ixABF"></A>
How many bytes to attempt to read
<DT>opt arg3: $offset ( number )<DD>


<A NAME="ixABG"></A>
If a non-zero <TT>$offset</TT> is specified, the read data will be placed at
that offset in the <TT>$buffer</TT>.


<P>


<FONT SIZE="-1">META:</FONT> negative offset and \0 padding are not supported at the moment
<DT>ret: $cnt ( number )<DD>


<A NAME="ixABH"></A>
How many characters were actually read
<DT>excpt: APR::Error<DD>


<A NAME="ixABI"></A>

<DT>since: 2.0.00<DD>
<A NAME="ixABJ"></A>

</DL>
<P>

This method shares a lot of similarities with the Perl core <TT>&quot;read()&quot;</TT>
function. The main difference in the error handling, which is done via
<TT>&quot;APR::Error exceptions&quot;</TT>
<A NAME="lbAK">&nbsp;</A>
<H3>rflush</H3>



<A NAME="ixABK"></A>
Flush any buffered data to the client.
<P>



<PRE>
  $r-&gt;rflush();

</PRE>


<DL COMPACT>
<DT>obj: $r ( Apache2::RequestRec object )<DD>


<A NAME="ixABL"></A>

<DT>ret: no return value<DD>
<A NAME="ixABM"></A>
<DT>since: 2.0.00<DD>
<A NAME="ixABN"></A>

</DL>
<P>

Unless <FONT SIZE="-1">STDOUT</FONT> stream's <TT>$|</TT> is false, data sent via
<TT>&quot;$r-&gt;print()&quot;</TT> is buffered. This method flushes that
data to the client.
<A NAME="lbAL">&nbsp;</A>
<H3>sendfile</H3>



<A NAME="ixABO"></A>
Send a file or a part of it
<P>



<PRE>
  $rc = $r-&gt;sendfile($filename);
  $rc = $r-&gt;sendfile($filename, $offset);
  $rc = $r-&gt;sendfile($filename, $offset, $len);

</PRE>


<DL COMPACT>
<DT>obj: $r ( Apache2::RequestRec object )<DD>


<A NAME="ixABP"></A>

<DT>arg1: $filename ( string )<DD>


<A NAME="ixABQ"></A>

The full path to the file (using <TT>&quot;/&quot;</TT> on all systems)
<DT>opt arg2: $offset ( integer )<DD>


<A NAME="ixABR"></A>
Offset into the file to start sending.


<P>


No offset is used if <TT>$offset</TT> is not specified.
<DT>opt arg3: $len ( integer )<DD>


<A NAME="ixABS"></A>
How many bytes to send.


<P>


If not specified the whole file is sent (or a part of it, if
<TT>$offset</TT> if specified)
<DT>ret: $rc ( APR::Const status constant )<DD>


<A NAME="ixABT"></A>
On success,
<TT>&quot;APR::Const::SUCCESS&quot;</TT> is
returned.


<P>


In case of a failure --- a failure code is returned, in which case
normally it should be returned to the caller.
<DT>excpt: APR::Error<DD>


<A NAME="ixABU"></A>
Exceptions are thrown only when this function is called in the <FONT SIZE="-1">VOID</FONT>
context. So if you don't want to handle the errors, just don't ask for
a return value and the function will handle all the errors on its own.
<DT>since: 2.0.00<DD>
<A NAME="ixABV"></A>
</DL>
<A NAME="lbAM">&nbsp;</A>
<H3>write</H3>



<A NAME="ixABW"></A>
Send partial string to the client
<P>



<PRE>
  $cnt = $r-&gt;write($buffer);
  $cnt = $r-&gt;write($buffer, $len);
  $cnt = $r-&gt;write($buffer, $len, $offset);

</PRE>


<DL COMPACT>
<DT>obj: $r ( Apache2::RequestRec object )<DD>


<A NAME="ixABX"></A>

<DT>arg1: $buffer ( <FONT SIZE="-1">SCALAR</FONT> )<DD>


<A NAME="ixABY"></A>

The string with data
<DT>opt arg2: $len ( <FONT SIZE="-1">SCALAR</FONT> )<DD>


<A NAME="ixABZ"></A>
How many bytes to send. If not specified, or -1 is specified, all the
data in <TT>$buffer</TT> (or starting from <TT>$offset</TT>) will be sent.
<DT>opt arg3: $offset ( number )<DD>


<A NAME="ixACA"></A>
Offset into the <TT>$buffer</TT> string.
<DT>ret: $cnt ( number )<DD>


<A NAME="ixACB"></A>
How many bytes were sent (or buffered)
<DT>excpt: APR::Error<DD>


<A NAME="ixACC"></A>

<DT>since: 2.0.00<DD>
<A NAME="ixACD"></A>

</DL>
<P>

Examples:
<P>

Assuming that we have a string:
<P>



<PRE>
  $string = &quot;123456789&quot;;

</PRE>


<P>

Then:
<P>



<PRE>
  $r-&gt;write($string);

</PRE>


<P>

sends:
<P>



<PRE>
  123456789

</PRE>


<P>

Whereas:
<P>



<PRE>
  $r-&gt;write($string, 3);

</PRE>


<P>

sends:
<P>



<PRE>
  123

</PRE>


<P>

And:
<P>



<PRE>
  $r-&gt;write($string, 3, 5);

</PRE>


<P>

sends:
<P>



<PRE>
  678

</PRE>


<P>

Finally:
<P>



<PRE>
  $r-&gt;write($string, -1, 5);

</PRE>


<P>

sends:
<P>



<PRE>
  6789

</PRE>


<A NAME="lbAN">&nbsp;</A>
<H2>TIE Interface</H2>

<A NAME="ixACE"></A>
The <FONT SIZE="-1">TIE</FONT> interface implementation. This interface is used for <FONT SIZE="-1">HTTP</FONT>
request handlers, when running under <TT>&quot;SetHandler
perl-script&quot;</TT> and
Perl doesn't have perlio enabled.
<P>

See the <I>perltie</I> manpage for more information.
<A NAME="lbAO">&nbsp;</A>
<H3>BINMODE</H3>



<A NAME="ixACF"></A>
<DL COMPACT>
<DT>since: 2.0.00<DD>
<A NAME="ixACG"></A>
</DL>
<P>

NoOP
<P>

See the <I>binmode</I> Perl entry in the <I>perlfunc</I> manpage
<A NAME="lbAP">&nbsp;</A>
<H3>CLOSE</H3>



<A NAME="ixACH"></A>
<DL COMPACT>
<DT>since: 2.0.00<DD>
<A NAME="ixACI"></A>
</DL>
<P>

NoOP
<P>

See the <I>close</I> Perl entry in the <I>perlfunc</I> manpage
<A NAME="lbAQ">&nbsp;</A>
<H3>FILENO</H3>



<A NAME="ixACJ"></A>
<DL COMPACT>
<DT>since: 2.0.00<DD>
<A NAME="ixACK"></A>
</DL>
<P>

See the <I>fileno</I> Perl entry in the <I>perlfunc</I> manpage
<A NAME="lbAR">&nbsp;</A>
<H3>GETC</H3>



<A NAME="ixACL"></A>
<DL COMPACT>
<DT>since: 2.0.00<DD>
<A NAME="ixACM"></A>
</DL>
<P>

See the <I>getc</I> Perl entry in the <I>perlfunc</I> manpage
<A NAME="lbAS">&nbsp;</A>
<H3>OPEN</H3>



<A NAME="ixACN"></A>
<DL COMPACT>
<DT>since: 2.0.00<DD>
<A NAME="ixACO"></A>
</DL>
<P>

See the <I>open</I> Perl entry in the <I>perlfunc</I> manpage
<A NAME="lbAT">&nbsp;</A>
<H3>PRINT</H3>



<A NAME="ixACP"></A>
<DL COMPACT>
<DT>since: 2.0.00<DD>
<A NAME="ixACQ"></A>
</DL>
<P>

See the <I>print</I> Perl entry in the <I>perlfunc</I> manpage
<A NAME="lbAU">&nbsp;</A>
<H3>PRINTF</H3>



<A NAME="ixACR"></A>
<DL COMPACT>
<DT>since: 2.0.00<DD>
<A NAME="ixACS"></A>
</DL>
<P>

See the <I>printf</I> Perl entry in the <I>perlfunc</I> manpage
<A NAME="lbAV">&nbsp;</A>
<H3>READ</H3>



<A NAME="ixACT"></A>
<DL COMPACT>
<DT>since: 2.0.00<DD>
<A NAME="ixACU"></A>
</DL>
<P>

See the <I>read</I> Perl entry in the <I>perlfunc</I> manpage
<A NAME="lbAW">&nbsp;</A>
<H3>TIEHANDLE</H3>



<A NAME="ixACV"></A>
<DL COMPACT>
<DT>since: 2.0.00<DD>
<A NAME="ixACW"></A>
</DL>
<P>

See the <I>tie</I> Perl entry in the <I>perlfunc</I> manpage
<A NAME="lbAX">&nbsp;</A>
<H3>UNTIE</H3>



<A NAME="ixACX"></A>
<DL COMPACT>
<DT>since: 2.0.00<DD>
<A NAME="ixACY"></A>
</DL>
<P>

NoOP
<P>

See the <I>untie</I> Perl entry in the <I>perlfunc</I> manpage
<A NAME="lbAY">&nbsp;</A>
<H3>WRITE</H3>



<A NAME="ixACZ"></A>
<DL COMPACT>
<DT>since: 2.0.00<DD>
<A NAME="ixADA"></A>
</DL>
<P>

See the <I>write</I> Perl entry in the <I>perlfunc</I> manpage
<A NAME="lbAZ">&nbsp;</A>
<H2>Deprecated API</H2>

<A NAME="ixADB"></A>
The following methods are deprecated, Apache plans to remove those in
the future, therefore avoid using them.
<A NAME="lbBA">&nbsp;</A>
<H3>get_client_block</H3>



<A NAME="ixADC"></A>
This method is deprecated since the C implementation is buggy and we
don't want you to use it at all. Instead use the plain
<TT>&quot;$r-&gt;read()&quot;</TT>.
<A NAME="lbBB">&nbsp;</A>
<H3>setup_client_block</H3>



<A NAME="ixADD"></A>
This method is deprecated since
<TT>&quot;$r-&gt;get_client_block&quot;</TT> is deprecated.
<A NAME="lbBC">&nbsp;</A>
<H3>should_client_block</H3>



<A NAME="ixADE"></A>
This method is deprecated since
<TT>&quot;$r-&gt;get_client_block&quot;</TT> is deprecated.
<A NAME="lbBD">&nbsp;</A>
<H2>See Also</H2>

<A NAME="ixADF"></A>
mod_perl 2.0 documentation.
<A NAME="lbBE">&nbsp;</A>
<H2>Copyright</H2>

<A NAME="ixADG"></A>
mod_perl 2.0 and its core modules are copyrighted under
The Apache Software License, Version 2.0.
<A NAME="lbBF">&nbsp;</A>
<H2>Authors</H2>

<A NAME="ixADH"></A>
The mod_perl development team and numerous
contributors.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">Synopsis</A><DD>
<DT><A HREF="#lbAD">Description</A><DD>
<DT><A HREF="#lbAE">API</A><DD>
<DL>
<DT><A HREF="#lbAF">discard_request_body</A><DD>
<DT><A HREF="#lbAG">print</A><DD>
<DT><A HREF="#lbAH">printf</A><DD>
<DT><A HREF="#lbAI">puts</A><DD>
<DT><A HREF="#lbAJ">read</A><DD>
<DT><A HREF="#lbAK">rflush</A><DD>
<DT><A HREF="#lbAL">sendfile</A><DD>
<DT><A HREF="#lbAM">write</A><DD>
</DL>
<DT><A HREF="#lbAN">TIE Interface</A><DD>
<DL>
<DT><A HREF="#lbAO">BINMODE</A><DD>
<DT><A HREF="#lbAP">CLOSE</A><DD>
<DT><A HREF="#lbAQ">FILENO</A><DD>
<DT><A HREF="#lbAR">GETC</A><DD>
<DT><A HREF="#lbAS">OPEN</A><DD>
<DT><A HREF="#lbAT">PRINT</A><DD>
<DT><A HREF="#lbAU">PRINTF</A><DD>
<DT><A HREF="#lbAV">READ</A><DD>
<DT><A HREF="#lbAW">TIEHANDLE</A><DD>
<DT><A HREF="#lbAX">UNTIE</A><DD>
<DT><A HREF="#lbAY">WRITE</A><DD>
</DL>
<DT><A HREF="#lbAZ">Deprecated API</A><DD>
<DL>
<DT><A HREF="#lbBA">get_client_block</A><DD>
<DT><A HREF="#lbBB">setup_client_block</A><DD>
<DT><A HREF="#lbBC">should_client_block</A><DD>
</DL>
<DT><A HREF="#lbBD">See Also</A><DD>
<DT><A HREF="#lbBE">Copyright</A><DD>
<DT><A HREF="#lbBF">Authors</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:11 GMT, December 24, 2015
</div></body>
</HTML>
