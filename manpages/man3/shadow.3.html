<!DOCTYPE html>

<HTML><head><TITLE>Manpage of SHADOW</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux man pages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>SHADOW</H1>
Section: Library Calls (3)<BR>Updated: 07/24/2009<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>











<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

shadow, getspnam - encrypted password file routines
<A NAME="lbAC">&nbsp;</A>
<H2>SYNTAX</H2>

<P>

<P>
<I>#include &lt;<A HREF="file:/usr/include/shadow.h">shadow.h</A>&gt;</I>
<P>

<P>
<I>struct spwd *getspent();</I>
<P>

<P>
<I>struct spwd *getspnam(char</I>
<I>*name</I><I>);</I>
<P>

<P>
<I>void setspent();</I>
<P>

<P>
<I>void endspent();</I>
<P>

<P>
<I>struct spwd *fgetspent(FILE</I>
<I>*fp</I><I>);</I>
<P>

<P>
<I>struct spwd *sgetspent(char</I>
<I>*cp</I><I>);</I>
<P>

<P>
<I>int putspent(struct spwd</I>
<I>*p,</I>
<I>FILE</I>
<I>*fp</I><I>);</I>
<P>

<P>
<I>int lckpwdf();</I>
<P>

<P>
<I>int ulckpwdf();</I>
<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<P>

<P>
<I>shadow</I>
manipulates the contents of the shadow password file,
/etc/shadow. The structure in the
<I>#include</I>
file is:
<P>
<DL COMPACT><DT><DD>



<PRE>
struct spwd {
      char              *sp_namp; /* user login name */
      char              *sp_pwdp; /* encrypted password */
      long int          sp_lstchg; /* last password change */
      long int          sp_min; /* days until change allowed. */
      long int          sp_max; /* days before change required */
      long int          sp_warn; /* days warning for expiration */
      long int          sp_inact; /* days before account inactive */
      long int          sp_expire; /* date when account expires */
      unsigned long int sp_flag; /* reserved for future use */
}
    
</PRE>

</DL>




<P>

The meanings of each field are:
<P>
<DL COMPACT><DT><DD>
*


sp_namp - pointer to null-terminated user name
</DL>

<P>
<DL COMPACT><DT><DD>
*


sp_pwdp - pointer to null-terminated password
</DL>

<P>
<DL COMPACT><DT><DD>
*


sp_lstchg - days since Jan 1, 1970 password was last changed
</DL>

<P>
<DL COMPACT><DT><DD>
*


sp_min - days before which password may not be changed
</DL>

<P>
<DL COMPACT><DT><DD>
*


sp_max - days after which password must be changed
</DL>

<P>
<DL COMPACT><DT><DD>
*


sp_warn - days before password is to expire that user is warned of pending password expiration
</DL>

<P>
<DL COMPACT><DT><DD>
*


sp_inact - days after password expires that account is considered inactive and disabled
</DL>

<P>
<DL COMPACT><DT><DD>
*


sp_expire - days since Jan 1, 1970 when account will be disabled
</DL>

<P>
<DL COMPACT><DT><DD>
*


sp_flag - reserved for future use
</DL>

<A NAME="lbAE">&nbsp;</A>
<H2>DESCRIPTION</H2>

<P>

<P>
<I>getspent</I>,
<I>getspname</I>,
<I>fgetspent</I>, and
<I>sgetspent</I>
each return a pointer to a
<I>struct spwd</I>.
<I>getspent</I>
returns the next entry from the file, and
<I>fgetspent</I>
returns the next entry from the given stream, which is assumed to be a file of the proper format.
<I>sgetspent</I>
returns a pointer to a
<I>struct spwd</I>
using the provided string as input.
<I>getspnam</I>
searches from the current position in the file for an entry matching
<I>name</I>.
<P>

<P>
<I>setspent</I>
and
<I>endspent</I>
may be used to begin and end, respectively, access to the shadow password file.
<P>

The
<I>lckpwdf</I>
and
<I>ulckpwdf</I>
routines should be used to insure exclusive access to the
/etc/shadow
file.
<I>lckpwdf</I>
attempts to acquire a lock using
<I>pw_lock</I>
for up to 15 seconds. It continues by attempting to acquire a second lock using
<I>spw_lock</I>
for the remainder of the initial 15 seconds. Should either attempt fail after a total of 15 seconds,
<I>lckpwdf</I>
returns -1. When both locks are acquired 0 is returned.
<A NAME="lbAF">&nbsp;</A>
<H2>DIAGNOSTICS</H2>

<P>

Routines return NULL if no more entries are available or if an error occurs during processing. Routines which have
<I>int</I>
as the return value return 0 for success and -1 for failure.
<A NAME="lbAG">&nbsp;</A>
<H2>CAVEATS</H2>

<P>

These routines may only be used by the superuser as access to the shadow password file is restricted.
<A NAME="lbAH">&nbsp;</A>
<H2>FILES</H2>

<P>

/etc/shadow
<DL COMPACT><DT><DD>
Secure user account information.
</DL>

<A NAME="lbAI">&nbsp;</A>
<H2>SEE ALSO</H2>

<P>

<P>
<B><A HREF="/manpages/index.html?3+getpwent">getpwent</A></B>(3),
<B><A HREF="/manpages/index.html?5+shadow">shadow</A></B>(5).
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNTAX</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">DESCRIPTION</A><DD>
<DT><A HREF="#lbAF">DIAGNOSTICS</A><DD>
<DT><A HREF="#lbAG">CAVEATS</A><DD>
<DT><A HREF="#lbAH">FILES</A><DD>
<DT><A HREF="#lbAI">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:40 GMT, December 24, 2015
</div></body>
</HTML>
