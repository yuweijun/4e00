<!DOCTYPE html>

<HTML><head><TITLE>Manpage of LBER_SOCKBUF</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux man pages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>LBER_SOCKBUF</H1>
Section: C Library Functions (3)<BR>Updated: 2010/06/30<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>




<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

ber_sockbuf_alloc, ber_sockbuf_free, ber_sockbuf_ctrl, ber_sockbuf_add_io, ber_sockbuf_remove_io, Sockbuf_IO - OpenLDAP LBER I/O infrastructure
<A NAME="lbAC">&nbsp;</A>
<H2>LIBRARY</H2>

OpenLDAP LBER (liblber, -llber)
<A NAME="lbAD">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>#include &lt;<A HREF="file:/usr/include/lber.h">lber.h</A>&gt;</B>

<P>

<B>Sockbuf *ber_sockbuf_alloc( void );</B>

<P>

<B>void ber_sockbuf_free(Sockbuf *</B><I>sb</I><B>);</B>

<P>

<B>int ber_sockbuf_ctrl(Sockbuf *</B><I>sb</I><B>, int </B><I>opt</I><B>, void *</B><I>arg</I><B>);</B>

<P>

<B>int ber_sockbuf_add_io(Sockbuf *</B><I>sb</I><B>, Sockbuf_IO *</B><I>sbio</I><B>, int </B><I>layer</I><B>, void *</B><I>arg</I><B>);</B>

<P>

<B>int ber_sockbuf_remove_io(Sockbuf *</B><I>sb</I><B>, Sockbuf_IO *</B><I>sbio</I><B>, int </B><I>layer</I><B>);</B>

<P>

<PRE>
<B>typedef struct sockbuf_io_desc {</B>
<B>int </B><I>sbiod_level</I><B>;</B>
<B>Sockbuf *</B><I>sbiod_sb</I><B>;</B>
<B>Sockbuf_IO *</B><I>sbiod_io</I><B>;</B>
<B>void *</B><I>sbiod_pvt</I><B>;</B>
<B>struct sockbuf_io_desc *</B><I>sbiod_next</I><B>;</B>
<B>} Sockbuf_IO_Desc;</B>

<B>typedef struct sockbuf_io {</B>
<B>int (*</B><I>sbi_setup</I><B>)(Sockbuf_IO_Desc *</B><I>sbiod</I><B>, void *</B><I>arg</I><B>);</B>
<B>int (*</B><I>sbi_remove</I><B>)(Sockbuf_IO_Desc *</B><I>sbiod</I><B>);</B>
<B>int (*</B><I>sbi_ctrl</I><B>)(Sockbuf_IO_Desc *</B><I>sbiod</I><B>, int </B><I>opt</I><B>, void *</B><I>arg</I><B>);</B>
<B>ber_slen_t (*</B><I>sbi_read</I><B>)(Sockbuf_IO_Desc *</B><I>sbiod</I><B>, void *</B><I>buf</I><B>, ber_len_t </B><I>len</I><B>);</B>
<B>ber_slen_t (*</B><I>sbi_write</I><B>)(Sockbuf_IO_Desc *</B><I>sbiod</I><B>, void *</B><I>buf</I><B>, ber_len_t </B><I>len</I><B>);</B>
<B>int (*</B><I>sbi_close</I><B>)(Sockbuf_IO_Desc *</B><I>sbiod</I><B>);</B>
<B>} Sockbuf_IO;</B>

</PRE><A NAME="lbAE">&nbsp;</A>
<H2>DESCRIPTION</H2>

<P>

These routines are used to manage the low level I/O operations performed
by the Lightweight BER library. They are called implicitly by the other
libraries and usually do not need to be called directly from applications.
The I/O framework is modularized and new transport layers can be supported
by appropriately defining a
<B>Sockbuf_IO</B>

structure and installing it onto an existing
<B>Sockbuf</B>.

<B>Sockbuf</B>

structures are allocated and freed by
<B>ber_sockbuf_alloc</B>()

and
<B>ber_sockbuf_free</B>(),

respectively. The
<B>ber_sockbuf_ctrl</B>()

function is used to get and set options related to a
<B>Sockbuf</B>

or to a specific I/O layer of the
<B>Sockbuf</B>.

The
<B>ber_sockbuf_add_io</B>()

and
<B>ber_sockbuf_remove_io</B>()

functions are used to add and remove specific I/O layers on a
<B>Sockbuf</B>.

<P>
Options for
<B>ber_sockbuf_ctrl</B>()

include:
<DL COMPACT>
<DT><B>LBER_SB_OPT_HAS_IO</B>

<DD>
Takes a
<B>Sockbuf_IO *</B>

argument and returns 1 if the given handler is installed
on the
<B>Sockbuf</B>,

otherwise returns 0.
<DT><B>LBER_SB_OPT_GET_FD</B>

<DD>
Retrieves the file descriptor associated to the
<B>Sockbuf</B>;

<B>arg</B>

must be a
<B>ber_socket_t *</B>.

The return value will be 1 if a valid descriptor was present, -1 otherwise.
<DT><B>LBER_SB_OPT_SET_FD</B>

<DD>
Sets the file descriptor of the
<B>Sockbuf</B>

to the descriptor pointed to by
<B>arg</B>;

<B>arg</B>

must be a
<B>ber_socket_t *</B>.

The return value will always be 1.
<DT><B>LBER_SB_OPT_SET_NONBLOCK</B>

<DD>
Toggles the non-blocking state of the file descriptor associated to
the
<B>Sockbuf</B>.

<B>arg</B>

should be NULL to disable and non-NULL to enable the non-blocking state.
The return value will be 1 for success, -1 otherwise.
<DT><B>LBER_SB_OPT_DRAIN</B>

<DD>
Flush (read and discard) all available input on the
<B>Sockbuf</B>.

The return value will be 1.
<DT><B>LBER_SB_OPT_NEEDS_READ</B>

<DD>
Returns non-zero if input is waiting to be read.
<DT><B>LBER_SB_OPT_NEEDS_WRITE</B>

<DD>
Returns non-zero if the
<B>Sockbuf</B>

is ready to be written.
<DT><B>LBER_SB_OPT_GET_MAX_INCOMING</B>

<DD>
Returns the maximum allowed size of an incoming message;
<B>arg</B>

must be a
<B>ber_len_t *</B>.

The return value will be 1.
<DT><B>LBER_SB_OPT_SET_MAX_INCOMING</B>

<DD>
Sets the maximum allowed size of an incoming message;
<B>arg</B>

must be a
<B>ber_len_t *</B>.

The return value will be 1.
<P>
</DL>
<P>

Options not in this list will be passed down to each
<B>Sockbuf_IO</B>

handler in turn until one of them processes it. If the option is not handled
<B>ber_sockbuf_ctrl</B>()

will return 0.
<P>
<P>

Multiple
<B>Sockbuf_IO</B>

handlers can be stacked in multiple layers to provide various functionality.
Currently defined layers include
<DL COMPACT>
<DT><B>LBER_SBIOD_LEVEL_PROVIDER</B>

<DD>
the lowest layer, talking directly to a network 
<DT><B>LBER_SBIOD_LEVEL_TRANSPORT</B>

<DD>
an intermediate layer
<DT><B>LBER_SBIOD_LEVEL_APPLICATION</B>

<DD>
a higher layer
</DL>
<P>

Currently defined
<B>Sockbuf_IO</B>

handlers in liblber include
<DL COMPACT>
<DT><B>ber_sockbuf_io_tcp</B>

<DD>
The default stream-oriented provider
<DT><B>ber_sockbuf_io_fd</B>

<DD>
A stream-oriented provider for local IPC sockets
<DT><B>ber_sockbuf_io_dgram</B>

<DD>
A datagram-oriented provider. This handler is only present if the liblber
library was built with LDAP_CONNECTIONLESS defined.
<DT><B>ber_sockbuf_io_readahead</B>

<DD>
A buffering layer, usually used with a datagram provider to hide the
datagram semantics from upper layers.
<DT><B>ber_sockbuf_io_debug</B>

<DD>
A generic handler that outputs hex dumps of all traffic. This handler
may be inserted multiple times at arbitrary layers to show the flow
of data between other handlers.
</DL>
<P>

Additional handlers may be present in libldap if support for them was
enabled:
<DL COMPACT>
<DT><B>ldap_pvt_sockbuf_io_sasl</B>

<DD>
An application layer handler for SASL encoding/decoding.
<DT><B>sb_tls_sbio</B>

<DD>
A transport layer handler for SSL/TLS encoding/decoding. Note that this
handler is private to the library and is not exposed in the API.
</DL>
<P>

The provided handlers are all instantiated implicitly by libldap, and
applications generally will not need to directly manipulate them.
<P>
<A NAME="lbAF">&nbsp;</A>
<H2>SEE ALSO</H2>

<B><A HREF="/manpages/index.html?3+lber-decode">lber-decode</A></B>(3),

<B><A HREF="/manpages/index.html?3+lber-encode">lber-encode</A></B>(3),

<B><A HREF="/manpages/index.html?3+lber-types">lber-types</A></B>(3),

<B><A HREF="/manpages/index.html?3+ldap_get_option">ldap_get_option</A></B>(3)

<P>
<P>

<A NAME="lbAG">&nbsp;</A>
<H2>ACKNOWLEDGEMENTS</H2>



<B>OpenLDAP Software</B>

is developed and maintained by The OpenLDAP Project &lt;<A HREF="http://www.openldap.org/">http://www.openldap.org/</A>&gt;.
<B>OpenLDAP Software</B>

is derived from University of Michigan LDAP 3.3 Release.  

<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">LIBRARY</A><DD>
<DT><A HREF="#lbAD">SYNOPSIS</A><DD>
<DT><A HREF="#lbAE">DESCRIPTION</A><DD>
<DT><A HREF="#lbAF">SEE ALSO</A><DD>
<DT><A HREF="#lbAG">ACKNOWLEDGEMENTS</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:30 GMT, December 24, 2015
</div></body>
</HTML>
