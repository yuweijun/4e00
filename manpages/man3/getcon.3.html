<!DOCTYPE html>

<HTML><head><TITLE>Manpage of getcon</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux manpages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>getcon</H1>
Section: SELinux API documentation (3)<BR>Updated: 1 January 2004<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

getcon, getprevcon, getpidcon - get SELinux security context of a process.
<P>
getpeercon - get security context of a peer socket.
<P>
setcon - set current security context of a process.
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>#include &lt;<A HREF="file:/usr/include/selinux/selinux.h">selinux/selinux.h</A>&gt;</B>

<P>
<B>int getcon(security_context_t *</B><I>context</I><B>);</B>

<P>
<B>int getprevcon(security_context_t *</B><I>context</I><B>);</B>

<P>
<B>int getpidcon(pid_t </B><I>pid</I><B>, security_context_t *</B><I>context</I><B>);</B>

<P>
<B>int getpeercon(int </B><I>fd</I><B>, security_context_t *</B><I>context);</I>

<P>
<B>int setcon(security_context_t </B><I>context);</I>

<P>
<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<B>getcon</B>

retrieves the context of the current process, which must be free'd with
freecon.
<P>
<B>getprevcon</B>

same as getcon but gets the context before the last exec.
<P>
<B>getpidcon</B>

returns the process context for the specified PID.
<P>
<B>getpeercon</B>

retrieves context of peer socket, and set *context to refer to it, which must be free'd with freecon.
<P>
<B>setcon</B>

sets the current security context of the process to a new value.  Note
that use of this function requires that the entire application be
trusted to maintain any desired separation between the old and new
security contexts, unlike exec-based transitions performed via
<A HREF="/manpages/index.html?3+setexeccon">setexeccon</A>(3).  When possible, decompose your applicaiton and use
setexeccon() and execve() instead.
<P>
Since access to file descriptors is revalidated upon use by SELinux,
the new context must be explicitly authorized in the policy to use the
descriptors opened by the old context if that is desired.  Otherwise,
attempts by the process to use any existing descriptors (including
stdin, stdout, and stderr) after performing the setcon() will fail.
<P>
A multi-threaded application can perform a setcon() prior to creating
any child threads, in which case all of the child threads will inherit
the new context.  However, setcon() will fail if there are any other
threads running in the same process.
<P>
If the process was being ptraced at the time of the setcon()
operation, ptrace permission will be revalidated against the new
context and the setcon() will fail if it is not allowed by policy.
<P>
<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUE</H2>

On error -1 is returned.  On success 0 is returned.
<P>
<A NAME="lbAF">&nbsp;</A>
<H2>SEE ALSO</H2>

<B><A HREF="/manpages/index.html?8+selinux">selinux</A></B>(8), <B><A HREF="http://localhost/cgi-bin/man/man2html?3+freecon">freecon</A></B>(3), <B><A HREF="http://localhost/cgi-bin/man/man2html?3+setexeccon">setexeccon</A></B>(3)

<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">RETURN VALUE</A><DD>
<DT><A HREF="#lbAF">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:28 GMT, December 24, 2015
</div></body>
</HTML>
