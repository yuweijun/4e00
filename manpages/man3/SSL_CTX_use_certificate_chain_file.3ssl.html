<!DOCTYPE html>

<HTML><head><TITLE>Manpage of SSL_CTX_use_certificate</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux manpages</a></div>
 <div class="site-description">{"type":"documentation"}</div>
 </div>
 </header>
 <div class="page-content"><div class="wrap">
<H1>SSL_CTX_use_certificate</H1>
Section: OpenSSL (3)<BR>Updated: 2005-04-08<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

SSL_CTX_use_certificate, SSL_CTX_use_certificate_ASN1, SSL_CTX_use_certificate_file, SSL_use_certificate, SSL_use_certificate_ASN1, SSL_use_certificate_file, SSL_CTX_use_certificate_chain_file, SSL_CTX_use_PrivateKey, SSL_CTX_use_PrivateKey_ASN1, SSL_CTX_use_PrivateKey_file, SSL_CTX_use_RSAPrivateKey, SSL_CTX_use_RSAPrivateKey_ASN1, SSL_CTX_use_RSAPrivateKey_file, SSL_use_PrivateKey_file, SSL_use_PrivateKey_ASN1, SSL_use_PrivateKey, SSL_use_RSAPrivateKey, SSL_use_RSAPrivateKey_ASN1, SSL_use_RSAPrivateKey_file, SSL_CTX_check_private_key, SSL_check_private_key - load certificate and key data
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAC"></A>


<PRE>
 #include &lt;<A HREF="file:/usr/include/openssl/ssl.h">openssl/ssl.h</A>&gt;

 int SSL_CTX_use_certificate(SSL_CTX *ctx, X509 *x);
 int SSL_CTX_use_certificate_ASN1(SSL_CTX *ctx, int len, unsigned char *d);
 int SSL_CTX_use_certificate_file(SSL_CTX *ctx, const char *file, int type);
 int SSL_use_certificate(SSL *ssl, X509 *x);
 int SSL_use_certificate_ASN1(SSL *ssl, unsigned char *d, int len);
 int SSL_use_certificate_file(SSL *ssl, const char *file, int type);

 int SSL_CTX_use_certificate_chain_file(SSL_CTX *ctx, const char *file);

 int SSL_CTX_use_PrivateKey(SSL_CTX *ctx, EVP_PKEY *pkey);
 int SSL_CTX_use_PrivateKey_ASN1(int pk, SSL_CTX *ctx, unsigned char *d,
                                 long len);
 int SSL_CTX_use_PrivateKey_file(SSL_CTX *ctx, const char *file, int type);
 int SSL_CTX_use_RSAPrivateKey(SSL_CTX *ctx, RSA *rsa);
 int SSL_CTX_use_RSAPrivateKey_ASN1(SSL_CTX *ctx, unsigned char *d, long len);
 int SSL_CTX_use_RSAPrivateKey_file(SSL_CTX *ctx, const char *file, int type);
 int SSL_use_PrivateKey(SSL *ssl, EVP_PKEY *pkey);
 int SSL_use_PrivateKey_ASN1(int pk,SSL *ssl, unsigned char *d, long len);
 int SSL_use_PrivateKey_file(SSL *ssl, const char *file, int type);
 int SSL_use_RSAPrivateKey(SSL *ssl, RSA *rsa);
 int SSL_use_RSAPrivateKey_ASN1(SSL *ssl, unsigned char *d, long len);
 int SSL_use_RSAPrivateKey_file(SSL *ssl, const char *file, int type);

 int SSL_CTX_check_private_key(const SSL_CTX *ctx);
 int SSL_check_private_key(const SSL *ssl);

</PRE>


<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>
These functions load the certificates and private keys into the <FONT SIZE="-1">SSL_CTX</FONT>
or <FONT SIZE="-1">SSL</FONT> object, respectively.
<P>

The SSL_CTX_* class of functions loads the certificates and keys into the
<FONT SIZE="-1">SSL_CTX</FONT> object <B>ctx</B>. The information is passed to <FONT SIZE="-1">SSL</FONT> objects <B>ssl</B>
created from <B>ctx</B> with <I><A HREF="/manpages/index.html?3+SSL_new">SSL_new</A></I>(3) by copying, so that
changes applied to <B>ctx</B> do not propagate to already existing <FONT SIZE="-1">SSL</FONT> objects.
<P>

The SSL_* class of functions only loads certificates and keys into a
specific <FONT SIZE="-1">SSL</FONT> object. The specific information is kept, when
<I><A HREF="/manpages/index.html?3+SSL_clear">SSL_clear</A></I>(3) is called for this <FONT SIZE="-1">SSL</FONT> object.
<P>

<I>SSL_CTX_use_certificate()</I> loads the certificate <B>x</B> into <B>ctx</B>,
<I>SSL_use_certificate()</I> loads <B>x</B> into <B>ssl</B>. The rest of the
certificates needed to form the complete certificate chain can be
specified using the
<I><A HREF="/manpages/index.html?3+SSL_CTX_add_extra_chain_cert">SSL_CTX_add_extra_chain_cert</A></I>(3)
function.
<P>

<I>SSL_CTX_use_certificate_ASN1()</I> loads the <FONT SIZE="-1">ASN1</FONT> encoded certificate from
the memory location <B>d</B> (with length <B>len</B>) into <B>ctx</B>,
<I>SSL_use_certificate_ASN1()</I> loads the <FONT SIZE="-1">ASN1</FONT> encoded certificate into <B>ssl</B>.
<P>

<I>SSL_CTX_use_certificate_file()</I> loads the first certificate stored in <B>file</B>
into <B>ctx</B>. The formatting <B>type</B> of the certificate must be specified
from the known types <FONT SIZE="-1">SSL_FILETYPE_PEM</FONT>, <FONT SIZE="-1">SSL_FILETYPE_ASN1</FONT>.
<I>SSL_use_certificate_file()</I> loads the certificate from <B>file</B> into <B>ssl</B>.
See the <FONT SIZE="-1">NOTES</FONT> section on why <I>SSL_CTX_use_certificate_chain_file()</I>
should be preferred.
<P>

<I>SSL_CTX_use_certificate_chain_file()</I> loads a certificate chain from 
<B>file</B> into <B>ctx</B>. The certificates must be in <FONT SIZE="-1">PEM</FONT> format and must
be sorted starting with the subject's certificate (actual client or server
certificate), followed by intermediate <FONT SIZE="-1">CA</FONT> certificates if applicable, and
ending at the highest level (root) <FONT SIZE="-1">CA</FONT>.
There is no corresponding function working on a single <FONT SIZE="-1">SSL</FONT> object.
<P>

<I>SSL_CTX_use_PrivateKey()</I> adds <B>pkey</B> as private key to <B>ctx</B>.
<I>SSL_CTX_use_RSAPrivateKey()</I> adds the private key <B>rsa</B> of type <FONT SIZE="-1">RSA</FONT>
to <B>ctx</B>. <I>SSL_use_PrivateKey()</I> adds <B>pkey</B> as private key to <B>ssl</B>;
<I>SSL_use_RSAPrivateKey()</I> adds <B>rsa</B> as private key of type <FONT SIZE="-1">RSA</FONT> to <B>ssl</B>.
If a certificate has already been set and the private does not belong
to the certificate an error is returned. To change a certificate, private
key pair the new certificate needs to be set with <I>SSL_use_certificate()</I>
or <I>SSL_CTX_use_certificate()</I> before setting the private key with
<I>SSL_CTX_use_PrivateKey()</I> or <I>SSL_use_PrivateKey()</I>.
<P>

<I>SSL_CTX_use_PrivateKey_ASN1()</I> adds the private key of type <B>pk</B>
stored at memory location <B>d</B> (length <B>len</B>) to <B>ctx</B>.
<I>SSL_CTX_use_RSAPrivateKey_ASN1()</I> adds the private key of type <FONT SIZE="-1">RSA</FONT>
stored at memory location <B>d</B> (length <B>len</B>) to <B>ctx</B>.
<I>SSL_use_PrivateKey_ASN1()</I> and <I>SSL_use_RSAPrivateKey_ASN1()</I> add the private
key to <B>ssl</B>.
<P>

<I>SSL_CTX_use_PrivateKey_file()</I> adds the first private key found in
<B>file</B> to <B>ctx</B>. The formatting <B>type</B> of the certificate must be specified
from the known types <FONT SIZE="-1">SSL_FILETYPE_PEM</FONT>, <FONT SIZE="-1">SSL_FILETYPE_ASN1</FONT>.
<I>SSL_CTX_use_RSAPrivateKey_file()</I> adds the first private <FONT SIZE="-1">RSA</FONT> key found in
<B>file</B> to <B>ctx</B>. <I>SSL_use_PrivateKey_file()</I> adds the first private key found
in <B>file</B> to <B>ssl</B>; <I>SSL_use_RSAPrivateKey_file()</I> adds the first private
<FONT SIZE="-1">RSA</FONT> key found to <B>ssl</B>.
<P>

<I>SSL_CTX_check_private_key()</I> checks the consistency of a private key with
the corresponding certificate loaded into <B>ctx</B>. If more than one
key/certificate pair (<FONT SIZE="-1">RSA/DSA</FONT>) is installed, the last item installed will
be checked. If e.g. the last item was a <FONT SIZE="-1">RSA</FONT> certificate or key, the <FONT SIZE="-1">RSA</FONT>
key/certificate pair will be checked. <I>SSL_check_private_key()</I> performs
the same check for <B>ssl</B>. If no key/certificate was explicitly added for
this <B>ssl</B>, the last item added into <B>ctx</B> will be checked.
<A NAME="lbAE">&nbsp;</A>
<H2>NOTES</H2>

<A NAME="ixAAE"></A>
The internal certificate store of OpenSSL can hold two private key/certificate
pairs at a time: one key/certificate of type <FONT SIZE="-1">RSA</FONT> and one key/certificate
of type <FONT SIZE="-1">DSA</FONT>. The certificate used depends on the cipher select, see
also <I><A HREF="/manpages/index.html?3+SSL_CTX_set_cipher_list">SSL_CTX_set_cipher_list</A></I>(3).
<P>

When reading certificates and private keys from file, files of type
<FONT SIZE="-1">SSL_FILETYPE_ASN1</FONT> (also known as <B></B><FONT SIZE="-1"><B>DER</B></FONT><B></B>, binary encoding) can only contain
one certificate or private key, consequently 
<I>SSL_CTX_use_certificate_chain_file()</I> is only applicable to <FONT SIZE="-1">PEM</FONT> formatting.
Files of type <FONT SIZE="-1">SSL_FILETYPE_PEM</FONT> can contain more than one item.
<P>

<I>SSL_CTX_use_certificate_chain_file()</I> adds the first certificate found
in the file to the certificate store. The other certificates are added
to the store of chain certificates using
<I><A HREF="/manpages/index.html?3+SSL_CTX_add_extra_chain_cert">SSL_CTX_add_extra_chain_cert</A></I>(3).
There exists only one extra chain store, so that the same chain is appended
to both types of certificates, <FONT SIZE="-1">RSA</FONT> and <FONT SIZE="-1">DSA</FONT>! If it is not intended to use
both type of certificate at the same time, it is recommended to use the
<I>SSL_CTX_use_certificate_chain_file()</I> instead of the
<I>SSL_CTX_use_certificate_file()</I> function in order to allow the use of
complete certificate chains even when no trusted <FONT SIZE="-1">CA</FONT> storage is used or
when the <FONT SIZE="-1">CA</FONT> issuing the certificate shall not be added to the trusted
<FONT SIZE="-1">CA</FONT> storage.
<P>

If additional certificates are needed to complete the chain during the
<FONT SIZE="-1">TLS</FONT> negotiation, <FONT SIZE="-1">CA</FONT> certificates are additionally looked up in the
locations of trusted <FONT SIZE="-1">CA</FONT> certificates, see
<I><A HREF="/manpages/index.html?3+SSL_CTX_load_verify_locations">SSL_CTX_load_verify_locations</A></I>(3).
<P>

The private keys loaded from file can be encrypted. In order to successfully
load encrypted keys, a function returning the passphrase must have been
supplied, see
<I><A HREF="/manpages/index.html?3+SSL_CTX_set_default_passwd_cb">SSL_CTX_set_default_passwd_cb</A></I>(3).
(Certificate files might be encrypted as well from the technical point
of view, it however does not make sense as the data in the certificate
is considered public anyway.)
<A NAME="lbAF">&nbsp;</A>
<H2>RETURN VALUES</H2>

<A NAME="ixAAF"></A>
On success, the functions return 1.
Otherwise check out the error stack to find out the reason.
<A NAME="lbAG">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAAG"></A>
<I><A HREF="/manpages/index.html?3+ssl">ssl</A></I>(3), <I><A HREF="http://localhost/cgi-bin/man/man2html?3+SSL_new">SSL_new</A></I>(3), <I><A HREF="http://localhost/cgi-bin/man/man2html?3+SSL_clear">SSL_clear</A></I>(3),
<I><A HREF="/manpages/index.html?3+SSL_CTX_load_verify_locations">SSL_CTX_load_verify_locations</A></I>(3),
<I><A HREF="/manpages/index.html?3+SSL_CTX_set_default_passwd_cb">SSL_CTX_set_default_passwd_cb</A></I>(3),
<I><A HREF="/manpages/index.html?3+SSL_CTX_set_cipher_list">SSL_CTX_set_cipher_list</A></I>(3),
<I><A HREF="/manpages/index.html?3+SSL_CTX_set_client_cert_cb">SSL_CTX_set_client_cert_cb</A></I>(3),
<I><A HREF="/manpages/index.html?3+SSL_CTX_add_extra_chain_cert">SSL_CTX_add_extra_chain_cert</A></I>(3)
<A NAME="lbAH">&nbsp;</A>
<H2>HISTORY</H2>

<A NAME="ixAAH"></A>
Support for <FONT SIZE="-1">DER</FONT> encoded private keys (<FONT SIZE="-1">SSL_FILETYPE_ASN1</FONT>) in
<I>SSL_CTX_use_PrivateKey_file()</I> and <I>SSL_use_PrivateKey_file()</I> was added
in 0.9.8 .
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">NOTES</A><DD>
<DT><A HREF="#lbAF">RETURN VALUES</A><DD>
<DT><A HREF="#lbAG">SEE ALSO</A><DD>
<DT><A HREF="#lbAH">HISTORY</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:41 GMT, December 24, 2015
</div></div>
</body>
</HTML>
