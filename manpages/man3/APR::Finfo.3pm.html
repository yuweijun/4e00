<!DOCTYPE html>

<HTML><head><TITLE>Manpage of docs::api::APR::Finfo</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux manpages</a></div>
 <div class="site-description">{"type":"documentation"}</div>
 </div>
 </header>
 <div class="page-content"><div class="wrap">
<H1>docs::api::APR::Finfo</H1>
Section: User Contributed Perl Documentation (3)<BR>Updated: 2007-11-12<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

APR::Finfo - Perl API for APR fileinfo structure
<A NAME="lbAC">&nbsp;</A>
<H2>Synopsis</H2>

<A NAME="ixAAC"></A>


<PRE>
  use APR::Finfo ();
  use APR::Const -compile =&gt; qw(FINFO_NORM);
  my $finfo = APR::Finfo::stat(&quot;/tmp/test&quot;, APR::Const::FINFO_NORM, $pool);
  
  $device = $finfo-&gt;device;     # (stat $file)[0]
  $inode  = $finfo-&gt;inode;      # (stat $file)[1]
  $prot   = $finfo-&gt;protection; # (stat $file)[2]
  $nlink  = $finfo-&gt;nlink;      # (stat $file)[3]
  $gid    = $finfo-&gt;group;      # (stat $file)[4]
  $uid    = $finfo-&gt;user;       # (stat $file)[5]
  $size   = $finfo-&gt;size;       # (stat $file)[7]
  $atime  = $finfo-&gt;atime;      # (stat $file)[8]
  $mtime  = $finfo-&gt;mtime;      # (stat $file)[9]
  $ctime  = $finfo-&gt;ctime;      # (stat $file)[10]
  
  $csize = $finfo-&gt;csize; # consumed size: not portable!
  
  $filetype = $finfo-&gt;filetype; # file/dir/socket/etc
  
  $fname = $finfo-&gt;fname;
  $name  = $finfo-&gt;name;  # in filesystem case:
  
  # valid fields that can be queried
  $valid = $finfo-&gt;valid;

</PRE>


<A NAME="lbAD">&nbsp;</A>
<H2>Description</H2>

<A NAME="ixAAD"></A>
<FONT SIZE="-1">APR</FONT> fileinfo structure provides somewhat similar information to Perl's
<TT>&quot;stat()&quot;</TT> call, but you will want to use this module's <FONT SIZE="-1">API</FONT> to query an
already <TT>&quot;stat()'ed&quot;</TT> filehandle to avoid an extra system call or to
query attributes specific to <FONT SIZE="-1">APR</FONT> file handles.
<P>

During the <FONT SIZE="-1">HTTP</FONT> request handlers coming after
<TT>&quot;PerlMapToStorageHandler&quot;</TT>,
<TT>&quot;$r-&gt;finfo&quot;</TT>
already contains the cached values from the apr's <TT>&quot;stat()&quot;</TT> call. So
you don't want to perform it again, but instead get the <TT>&quot;ARP::Finfo&quot;</TT>
object via:
<P>



<PRE>
  my $finfo = $r-&gt;finfo;

</PRE>


<A NAME="lbAE">&nbsp;</A>
<H2>API</H2>

<A NAME="ixAAE"></A>
<TT>&quot;APR::Finfo&quot;</TT> provides the following functions and/or methods:
<A NAME="lbAF">&nbsp;</A>
<H3>atime</H3>



<A NAME="ixAAF"></A>
Get the time the file was last accessed:
<P>



<PRE>
  $atime = $finfo-&gt;atime;

</PRE>


<DL COMPACT>
<DT>obj: $finfo ( APR::Finfo object )<DD>


<A NAME="ixAAG"></A>

<DT>return: $atime ( integer )<DD>


<A NAME="ixAAH"></A>

Last access time in seconds since the epoch
<DT>since: 2.0.00<DD>
<A NAME="ixAAI"></A>
</DL>
<P>

This method returns the same value as Perl's:
<P>



<PRE>
  (stat $filename)[8]

</PRE>


<P>

Note that this method may not be reliable on all platforms, most
notably Win32 --- <FONT SIZE="-1">FAT32</FONT> filesystems appear to work properly, but <FONT SIZE="-1">NTFS</FONT>
filesystems do not.
<A NAME="lbAG">&nbsp;</A>
<H3>csize</H3>



<A NAME="ixAAJ"></A>
Get the storage size consumed by the file
<P>



<PRE>
  $csize = $finfo-&gt;csize;

</PRE>


<DL COMPACT>
<DT>obj: $finfo ( APR::Finfo object )<DD>


<A NAME="ixAAK"></A>

<DT>return: $csize ( integer )<DD>


<A NAME="ixAAL"></A>
<DT>since: 2.0.00<DD>
<A NAME="ixAAM"></A>

</DL>
<P>

Chances are that you don't want to use this method, since its
functionality is not supported on most platforms (in which case it
always returns 0).
<A NAME="lbAH">&nbsp;</A>
<H3>ctime</H3>



<A NAME="ixAAN"></A>
Get the time the file was last changed
<P>



<PRE>
  $ctime = $finfo-&gt;ctime;

</PRE>


<DL COMPACT>
<DT>obj: $finfo ( APR::Finfo object )<DD>


<A NAME="ixAAO"></A>

<DT>return: $ctime ( integer )<DD>


<A NAME="ixAAP"></A>

Inode change time in seconds since the epoch
<DT>since: 2.0.00<DD>
<A NAME="ixAAQ"></A>
</DL>
<P>

This method returns the same value as Perl's:
<P>



<PRE>
  (stat $filename)[10]

</PRE>


<P>

The ctime field is non-portable.  In particular, you cannot expect it
to be a ``creation time'', see ``Files and Filesystems'' in the
<I>perlport</I> manpage for details.
<A NAME="lbAI">&nbsp;</A>
<H3>device</H3>



<A NAME="ixAAR"></A>
Get the id of the device the file is on.
<P>



<PRE>
  $device = $finfo-&gt;device;

</PRE>


<DL COMPACT>
<DT>obj: $finfo ( APR::Finfo object )<DD>


<A NAME="ixAAS"></A>

<DT>return: $device ( integer )<DD>


<A NAME="ixAAT"></A>
<DT>since: 2.0.00<DD>
<A NAME="ixAAU"></A>

</DL>
<P>

This method returns the same value as Perl's:
<P>



<PRE>
  (stat $filename)[0]

</PRE>


<P>

Note that this method is non-portable. It doesn't work on all
platforms, most notably Win32.
<A NAME="lbAJ">&nbsp;</A>
<H3>filetype</H3>



<A NAME="ixAAV"></A>
Get the type of file.
<P>



<PRE>
  $filetype = $finfo-&gt;filetype;

</PRE>


<DL COMPACT>
<DT>obj: $finfo ( APR::Finfo object )<DD>


<A NAME="ixAAW"></A>

<DT>return: $filetype ( :filetype constant )<DD>


<A NAME="ixAAX"></A>
<DT>since: 2.0.00<DD>
<A NAME="ixAAY"></A>

</DL>
<P>

For example:
<P>



<PRE>
  use APR::Pool;
  use APR::Finfo;
  use APR::Const -compile =&gt; qw(FILETYPE_DIR FILETYPE_REG FINFO_NORM);
  my $pool  = APR::Pool-&gt;new();
  my $finfo = APR::Finfo::stat(&quot;/tmp&quot;, APR::Const::FINFO_NORM, $pool);
  my $finfo = $finfo-&gt;filetype;
  if ($finfo == APR::Const::FILETYPE_REG) {
      print &quot;regular file&quot;;
  }
  elsif ($finfo == APR::Const::FILETYPE_REG) {
      print &quot;directory&quot;;
  }
  else {
      print &quot;other file&quot;;
  }

</PRE>


<P>

Since <I>/tmp</I> is a directory, this will print:
<P>



<PRE>
  directory

</PRE>


<A NAME="lbAK">&nbsp;</A>
<H3>fname</H3>



<A NAME="ixAAZ"></A>
Get the pathname of the file (possibly unrooted)
<P>



<PRE>
  $fname = $finfo-&gt;fname;

</PRE>


<DL COMPACT>
<DT>obj: $finfo ( APR::Finfo object )<DD>


<A NAME="ixABA"></A>

<DT>return: $filetype ( string )<DD>


<A NAME="ixABB"></A>
<DT>since: 2.0.00<DD>
<A NAME="ixABC"></A>

</DL>
<A NAME="lbAL">&nbsp;</A>
<H3>group</H3>



<A NAME="ixABD"></A>
Get the group id that owns the file:
<P>



<PRE>
  $gid = $finfo-&gt;group;

</PRE>


<DL COMPACT>
<DT>obj: $finfo ( APR::Finfo object )<DD>


<A NAME="ixABE"></A>

<DT>return: $gid ( number )<DD>


<A NAME="ixABF"></A>
<DT>since: 2.0.00<DD>
<A NAME="ixABG"></A>

</DL>
<P>

This method returns the same value as Perl's:
<P>



<PRE>
  (stat $filename)[5]

</PRE>


<P>

Note that this method may not be meaningful on all platforms, most
notably Win32.  Incorrect results have also been reported on some
versions of <FONT SIZE="-1">OSX</FONT>.
<A NAME="lbAM">&nbsp;</A>
<H3>inode</H3>



<A NAME="ixABH"></A>
Get the inode of the file.
<P>



<PRE>
  $inode = $finfo-&gt;inode;

</PRE>


<DL COMPACT>
<DT>obj: $finfo ( APR::Finfo object )<DD>


<A NAME="ixABI"></A>

<DT>return: $inode ( integer )<DD>


<A NAME="ixABJ"></A>
<DT>since: 2.0.00<DD>
<A NAME="ixABK"></A>

</DL>
<P>

This method returns the same value as Perl's:
<P>



<PRE>
  (stat $filename)[1]

</PRE>


<P>

Note that this method may not be meaningful on all platforms, most
notably Win32.
<A NAME="lbAN">&nbsp;</A>
<H3>mtime</H3>



<A NAME="ixABL"></A>
The time the file was last modified
<P>



<PRE>
  $mtime = $finfo-&gt;mtime;

</PRE>


<DL COMPACT>
<DT>obj: $finfo ( APR::Finfo object )<DD>


<A NAME="ixABM"></A>

<DT>return: $mtime ( integer )<DD>


<A NAME="ixABN"></A>

Last modify time in seconds since the epoch
<DT>since: 2.0.00<DD>
<A NAME="ixABO"></A>
</DL>
<P>

This method returns the same value as Perl's:
<P>



<PRE>
  (stat $filename)[9]

</PRE>


<A NAME="lbAO">&nbsp;</A>
<H3>name</H3>



<A NAME="ixABP"></A>
Get the file's name (no path) in filesystem case:
<P>



<PRE>
  $name = $finfo-&gt;name;

</PRE>


<DL COMPACT>
<DT>obj: $finfo ( APR::Finfo object )<DD>


<A NAME="ixABQ"></A>

<DT>return: $device ( string )<DD>


<A NAME="ixABR"></A>
<DT>since: 2.0.00<DD>
<A NAME="ixABS"></A>

</DL>
<A NAME="lbAP">&nbsp;</A>
<H3>nlink</H3>



<A NAME="ixABT"></A>
Get the number of hard links to the file.
<P>



<PRE>
  $nlink = $finfo-&gt;nlink;

</PRE>


<DL COMPACT>
<DT>obj: $finfo ( APR::Finfo object )<DD>


<A NAME="ixABU"></A>

<DT>return: $nlink ( integer )<DD>


<A NAME="ixABV"></A>
<DT>since: 2.0.00<DD>
<A NAME="ixABW"></A>

</DL>
<P>

This method returns the same value as Perl's:
<P>



<PRE>
  (stat $filename)[3]

</PRE>


<A NAME="lbAQ">&nbsp;</A>
<H3>protection</H3>



<A NAME="ixABX"></A>
Get the access permissions of the file.  Mimics Unix access rights.
<P>



<PRE>
  $prot = $finfo-&gt;protection;

</PRE>


<DL COMPACT>
<DT>obj: $finfo ( APR::Finfo object )<DD>


<A NAME="ixABY"></A>

<DT>return: $prot ( :fprot constant )<DD>


<A NAME="ixABZ"></A>
<DT>since: 2.0.00<DD>
<A NAME="ixACA"></A>

</DL>
<P>

This method returns the same value as Perl's:
<P>



<PRE>
  (stat $filename)[2]

</PRE>


<A NAME="lbAR">&nbsp;</A>
<H3>size</H3>



<A NAME="ixACB"></A>
Get the size of the file
<P>



<PRE>
  $size = $finfo-&gt;size;

</PRE>


<DL COMPACT>
<DT>obj: $finfo ( APR::Finfo object )<DD>


<A NAME="ixACC"></A>

<DT>return: $size ( integer )<DD>


<A NAME="ixACD"></A>

Total size of file, in bytes
<DT>since: 2.0.00<DD>
<A NAME="ixACE"></A>
</DL>
<P>

This method returns the same value as Perl's:
<P>



<PRE>
  (stat $filename)[7]

</PRE>


<A NAME="lbAS">&nbsp;</A>
<H3>stat</H3>



<A NAME="ixACF"></A>
Get the specified file's stats.
<P>



<PRE>
  $finfo = APR::Finfo::stat($fname, $wanted_fields, $p);

</PRE>


<DL COMPACT>
<DT>arg1: $fname ( string )<DD>


<A NAME="ixACG"></A>
The path to the file to <TT>&quot;stat()&quot;</TT>.
<DT>arg2: $wanted_fields ( :finfo constant )<DD>


<A NAME="ixACH"></A>
The desired fields, as a bitmask flag of
<TT>&quot;APR::FINFO_*&quot;</TT> constants.


<P>


Notice that you can also use the constants that already combine
several elements in one. For example
<TT>&quot;APR::Const::FINFO_PROT&quot;</TT>
asks for all protection bits,
<TT>&quot;APR::Const::FINFO_MIN&quot;</TT> asks
for the following fields: type, mtime, ctime, atime, size and
<TT>&quot;APR::Const::FINFO_NORM&quot;</TT>
asks for all atomic unix <TT>&quot;apr_stat()&quot;</TT> fields (similar to perl's
<TT>&quot;stat()&quot;</TT>).
<DT>arg3: $p ( APR::Pool object )<DD>


<A NAME="ixACI"></A>
the pool to use to allocate the file stat structure.
<DT>ret: $finfo ( APR::Finfo object )<DD>


<A NAME="ixACJ"></A>

<DT>since: 2.0.00<DD>
<A NAME="ixACK"></A>

</DL>
<P>

For example, here is how to get most of the <TT>&quot;stat&quot;</TT> fields:
<P>



<PRE>
  use APR::Pool ();
  use APR::Finfo ();
  use APR::Const -compile =&gt; qw(FINFO_NORM);
  my $pool = APR::Pool-&gt;new();
  my $finfo = APR::Finfo::stat(&quot;/tmp/test&quot;, APR::Const::FINFO_NORM, $pool);

</PRE>


<A NAME="lbAT">&nbsp;</A>
<H3>user</H3>



<A NAME="ixACL"></A>
Get the user id that owns the file:
<P>



<PRE>
  $uid = $finfo-&gt;user;

</PRE>


<DL COMPACT>
<DT>obj: $finfo ( APR::Finfo object )<DD>


<A NAME="ixACM"></A>

<DT>return: $uid ( number )<DD>


<A NAME="ixACN"></A>
<DT>since: 2.0.00<DD>
<A NAME="ixACO"></A>

</DL>
<P>

This method returns the same value as Perl's:
<P>



<PRE>
  (stat $filename)[4]

</PRE>


<P>

Note that this method may not be meaningful on all platforms,
most notably Win32.
<A NAME="lbAU">&nbsp;</A>
<H3>valid</H3>



<A NAME="ixACP"></A>
The bitmask describing valid fields of this apr_finfo_t structure
including all available 'wanted' fields and potentially more
<P>



<PRE>
  $valid = $finfo-&gt;valid;

</PRE>


<DL COMPACT>
<DT>obj: $finfo ( APR::Finfo object )<DD>


<A NAME="ixACQ"></A>

<DT>arg1: $valid ( bitmask )<DD>


<A NAME="ixACR"></A>

This bitmask flag should be bit-OR'ed against <TT>&quot;:finfo
constant&quot;</TT> constants.
<DT>since: 2.0.00<DD>
<A NAME="ixACS"></A>
</DL>
<A NAME="lbAV">&nbsp;</A>
<H2>See Also</H2>

<A NAME="ixACT"></A>
mod_perl 2.0 documentation.
<A NAME="lbAW">&nbsp;</A>
<H2>Copyright</H2>

<A NAME="ixACU"></A>
mod_perl 2.0 and its core modules are copyrighted under
The Apache Software License, Version 2.0.
<A NAME="lbAX">&nbsp;</A>
<H2>Authors</H2>

<A NAME="ixACV"></A>
The mod_perl development team and numerous
contributors.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">Synopsis</A><DD>
<DT><A HREF="#lbAD">Description</A><DD>
<DT><A HREF="#lbAE">API</A><DD>
<DL>
<DT><A HREF="#lbAF">atime</A><DD>
<DT><A HREF="#lbAG">csize</A><DD>
<DT><A HREF="#lbAH">ctime</A><DD>
<DT><A HREF="#lbAI">device</A><DD>
<DT><A HREF="#lbAJ">filetype</A><DD>
<DT><A HREF="#lbAK">fname</A><DD>
<DT><A HREF="#lbAL">group</A><DD>
<DT><A HREF="#lbAM">inode</A><DD>
<DT><A HREF="#lbAN">mtime</A><DD>
<DT><A HREF="#lbAO">name</A><DD>
<DT><A HREF="#lbAP">nlink</A><DD>
<DT><A HREF="#lbAQ">protection</A><DD>
<DT><A HREF="#lbAR">size</A><DD>
<DT><A HREF="#lbAS">stat</A><DD>
<DT><A HREF="#lbAT">user</A><DD>
<DT><A HREF="#lbAU">valid</A><DD>
</DL>
<DT><A HREF="#lbAV">See Also</A><DD>
<DT><A HREF="#lbAW">Copyright</A><DD>
<DT><A HREF="#lbAX">Authors</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:11 GMT, December 24, 2015
</div></div>
</body>
</HTML>
