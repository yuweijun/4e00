<!DOCTYPE html>

<HTML><head><TITLE>Manpage of SSLeay</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux manpages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content"><div class="wrap">
<H1>SSLeay</H1>
Section: User Contributed Perl Documentation (3)<BR>Updated: 2007-09-17<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

Crypt::SSLeay - OpenSSL support for LWP
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAC"></A>


<PRE>
  lwp-request <A HREF="https://www.example.com">https://www.example.com</A>

  use LWP::UserAgent;
  my $ua  = LWP::UserAgent-&gt;new;
  my $req = HTTP::Request-&gt;new('GET', '<A HREF="https://www.example.com/');">https://www.example.com/');</A>
  my $res = $ua-&gt;request($req);
  print $res-&gt;content, &quot;\n&quot;;

</PRE>


<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>
This document describes <TT>&quot;Crypt::SSLeay&quot;</TT> version 0.57, released
2007-09-17.
<P>

This perl module provides support for the https protocol under <FONT SIZE="-1">LWP</FONT>,
to allow an <TT>&quot;LWP::UserAgent&quot;</TT> object to perform <FONT SIZE="-1">GET</FONT>, <FONT SIZE="-1">HEAD</FONT> and <FONT SIZE="-1">POST</FONT>
requests. Please see <FONT SIZE="-1">LWP</FONT> for more information on <FONT SIZE="-1">POST</FONT> requests.
<P>

The <TT>&quot;Crypt::SSLeay&quot;</TT> package provides <TT>&quot;Net::SSL&quot;</TT>, which is loaded
by <TT>&quot;LWP::Protocol::https&quot;</TT> for https requests and provides the
necessary <FONT SIZE="-1">SSL</FONT> glue.
<P>

This distribution also makes following deprecated modules available:
<P>



<PRE>
  Crypt::SSLeay::CTX
  Crypt::SSLeay::Conn
  Crypt::SSLeay::X509

</PRE>


<P>

Work on Crypt::SSLeay has been continued only to provide https
support for the <FONT SIZE="-1">LWP</FONT> (libwww-perl) libraries.
<A NAME="lbAE">&nbsp;</A>
<H2>ENVIRONMENT VARIABLES</H2>

<A NAME="ixAAE"></A>
The following environment variables change the way
<TT>&quot;Crypt::SSLeay&quot;</TT> and <TT>&quot;Net::SSL&quot;</TT> behave.
<P>



<PRE>
  # proxy support
  $ENV{HTTPS_PROXY} = '<A HREF="http://proxy_hostname_or_ip:port';">http://proxy_hostname_or_ip:port';</A>

  # proxy_basic_auth
  $ENV{HTTPS_PROXY_USERNAME} = 'username';
  $ENV{HTTPS_PROXY_PASSWORD} = 'password';  

  # debugging (SSL diagnostics)
  $ENV{HTTPS_DEBUG} = 1;

  # default ssl version
  $ENV{HTTPS_VERSION} = '3';

  # client certificate support
  $ENV{HTTPS_CERT_FILE} = 'certs/notacacert.pem';
  $ENV{HTTPS_KEY_FILE}  = 'certs/notacakeynopass.pem';

  # CA cert peer verification
  $ENV{HTTPS_CA_FILE}   = 'certs/ca-bundle.crt';
  $ENV{HTTPS_CA_DIR}    = 'certs/';

  # Client PKCS12 cert support
  $ENV{HTTPS_PKCS12_FILE}     = 'certs/pkcs12.pkcs12';
  $ENV{HTTPS_PKCS12_PASSWORD} = 'PKCS12_PASSWORD';

</PRE>


<A NAME="lbAF">&nbsp;</A>
<H2>INSTALL</H2>

<A NAME="ixAAF"></A>
<A NAME="lbAG">&nbsp;</A>
<H3>OpenSSL</H3>

<A NAME="ixAAG"></A>
You must have OpenSSL or SSLeay installed before compiling 
this module. You can get the latest OpenSSL package from:
<P>



<PRE>
  <A HREF="http://www.openssl.org/">http://www.openssl.org/</A>

</PRE>


<P>

On Debian systems, you will need to install the libssl-dev package,
at least for the duration of the build (it may be removed afterwards).
<P>

Other package-based systems may require something similar. The key
is that Crypt::SSLeay makes calls to the OpenSSL library, and how
to do so is specified in the C header files that come with the
library.  Some systems break out the header files into a separate
package from that of the libraries. Once the program has been built,
you don't need the headers any more.
<P>

When installing openssl make sure your config looks like:
<P>



<PRE>
  ./config --openssldir=/usr/local/openssl
 or
  ./config --openssldir=/usr/local/ssl

</PRE>


<P>

If you are planning on upgrading the default OpenSSL libraries on
a system like RedHat, (not recommended), then try something like:
<P>



<PRE>
  ./config --openssldir=/usr --shared

</PRE>


<P>

The --shared option to config will set up building the .so 
shared libraries which is important for such systems. This is
followed by:
<P>



<PRE>
  make
  make test
  make install

</PRE>


<P>

This way Crypt::SSLeay will pick up the includes and 
libraries automatically. If your includes end up
going into a separate directory like /usr/local/include,
then you may need to symlink /usr/local/openssl/include
to /usr/local/include
<A NAME="lbAH">&nbsp;</A>
<H3>Crypt::SSLeay</H3>

<A NAME="ixAAH"></A>
The latest Crypt::SSLeay can be found at your nearest <FONT SIZE="-1">CPAN</FONT>,
as well as:
<P>



<PRE>
  <A HREF="http://search.cpan.org/dist/Crypt-SSLeay/">http://search.cpan.org/dist/Crypt-SSLeay/</A>

</PRE>


<P>

Once you have downloaded it, Crypt::SSLeay installs easily 
using the <TT>&quot;make&quot;</TT> * commands as shown below.
<P>



<PRE>
  perl Makefile.PL
  make
  make test
  make install

  * use nmake or dmake on Win32

</PRE>


<P>

For unattended (batch) installations, to be absolutely certain that
<I>Makefile.PL</I> does not prompt for questions on <FONT SIZE="-1">STDIN</FONT>, set the
following environment variable beforehand:
<P>



<PRE>
  PERL_MM_USE_DEFAULT=1

</PRE>


<P>

(This is true for any <FONT SIZE="-1">CPAN</FONT> module that uses <TT>&quot;ExtUtils::MakeMaker&quot;</TT>).
<P>

<I>Windows</I>
<A NAME="ixAAI"></A>
<P>

<TT>&quot;Crypt::SSLeay&quot;</TT> builds correctly with Strawberry Perl.
<P>

For Activestate users, the ActiveState company does not have a
permit from the Canadian Federal Government to distribute cryptographic
software. This prevents <TT>&quot;Crypt::SSLeay&quot;</TT> from being distributed as
a <FONT SIZE="-1">PPM</FONT> package from their repository. See
&lt;<A HREF="http://aspn.activestate.com/ASPN/docs/ActivePerl/5.8/faq/ActivePerl-faq2.html#crypto_packages">http://aspn.activestate.com/ASPN/docs/ActivePerl/5.8/faq/ActivePerl-faq2.html#crypto_packages</A>&gt;
for more information on this issue.
<P>

You may download it from Randy Kobes's <FONT SIZE="-1">PPM</FONT> repository by using
the following command:
<P>



<PRE>
  ppm install <A HREF="http://theoryx5.uwinnipeg.ca/ppms/Crypt-SSLeay.ppd">http://theoryx5.uwinnipeg.ca/ppms/Crypt-SSLeay.ppd</A>

</PRE>


<P>

An alternative is to add the uwinnipeg.ca <FONT SIZE="-1">PPM</FONT> repository to your
local installation. See &lt;<A HREF="http://cpan.uwinnipeg.ca/htdocs/faqs/ppm.html">http://cpan.uwinnipeg.ca/htdocs/faqs/ppm.html</A>&gt;
for more details.
<P>

<I></I><FONT SIZE="-1"><I>VMS</I></FONT><I></I>
<A NAME="ixAAJ"></A>
<P>

It is assumed that the OpenSSL installation is located at
<TT>&quot;/ssl$root&quot;</TT>. Define this logical to point to the appropriate
place in the filesystem.
<A NAME="lbAI">&nbsp;</A>
<H2>PROXY SUPPORT</H2>

<A NAME="ixAAK"></A>
LWP::UserAgent and Crypt::SSLeay have their own versions of 
proxy support. Please read these sections to see which one
is appropriate.
<A NAME="lbAJ">&nbsp;</A>
<H3>LWP::UserAgent proxy support</H3>

<A NAME="ixAAL"></A>
LWP::UserAgent has its own methods of proxying which may work for
you and is likely to be incompatible with Crypt::SSLeay proxy support.
To use LWP::UserAgent proxy support, try something like:
<P>



<PRE>
  my $ua = new LWP::UserAgent;
  $ua-&gt;proxy([qw( https http )], &quot;$proxy_ip:$proxy_port&quot;);

</PRE>


<P>

At the time of this writing, libwww v5.6 seems to proxy https 
requests fine with an Apache mod_proxy server.  It sends a line like:
<P>



<PRE>
  GET <A HREF="https://www.example.com">https://www.example.com</A> HTTP/1.1

</PRE>


<P>

to the proxy server, which is not the <FONT SIZE="-1">CONNECT</FONT> request that
some proxies would expect, so this may not work with other
proxy servers than mod_proxy. The <FONT SIZE="-1">CONNECT</FONT> method is used
by Crypt::SSLeay's internal proxy support.
<A NAME="lbAK">&nbsp;</A>
<H3>Crypt::SSLeay proxy support</H3>

<A NAME="ixAAM"></A>
For native Crypt::SSLeay proxy support of https requests,
you need to set the environment variable <TT>&quot;HTTPS_PROXY&quot;</TT> to your 
proxy server and port, as in:
<P>



<PRE>
  # proxy support
  $ENV{HTTPS_PROXY} = '<A HREF="http://proxy_hostname_or_ip:port';">http://proxy_hostname_or_ip:port';</A>
  $ENV{HTTPS_PROXY} = '127.0.0.1:8080';

</PRE>


<P>

Use of the <TT>&quot;HTTPS_PROXY&quot;</TT> environment variable in this way 
is similar to <TT>&quot;LWP::UserAgent-&quot;</TT><I>env_proxy()</I>&gt; usage, but calling
that method will likely override or break the Crypt::SSLeay
support, so do not mix the two.
<P>

Basic auth credentials to the proxy server can be provided 
this way:
<P>



<PRE>
  # proxy_basic_auth
  $ENV{HTTPS_PROXY_USERNAME} = 'username';
  $ENV{HTTPS_PROXY_PASSWORD} = 'password';

</PRE>


<P>

For an example of <FONT SIZE="-1">LWP</FONT> scripting with <TT>&quot;Crypt::SSLeay&quot;</TT> native proxy
support, please look at the <I>eg/lwp-ssl-test</I> script in the 
<TT>&quot;Crypt::SSLeay&quot;</TT> distribution.
<A NAME="lbAL">&nbsp;</A>
<H2>CLIENT CERTIFICATE SUPPORT</H2>

<A NAME="ixAAN"></A>
Client certificates are supported. PEM0encoded certificate and
private key files may be used like this:
<P>



<PRE>
  $ENV{HTTPS_CERT_FILE} = 'certs/notacacert.pem';
  $ENV{HTTPS_KEY_FILE}  = 'certs/notacakeynopass.pem';

</PRE>


<P>

You may test your files with the <I>eg/net-ssl-test</I> program,
bundled with the distribution, by issuing a command like:
<P>



<PRE>
  perl eg/net-ssl-test -cert=certs/notacacert.pem \
    -key=certs/notacakeynopass.pem -d GET $HOST_NAME

</PRE>


<P>

Additionally, if you would like to tell the client where
the <FONT SIZE="-1">CA</FONT> file is, you may set these.
<P>



<PRE>
  $ENV{HTTPS_CA_FILE} = &quot;some_file&quot;;
  $ENV{HTTPS_CA_DIR}  = &quot;some_dir&quot;;

</PRE>


<P>

There is no sample <FONT SIZE="-1">CA</FONT> cert file at this time for testing,
but you may configure <I>eg/net-ssl-test</I> to use your <FONT SIZE="-1">CA</FONT> cert
with the -CAfile option. (<FONT SIZE="-1">TODO:</FONT> then what is the ./certs
directory in the distribution?)
<A NAME="lbAM">&nbsp;</A>
<H3>Creating a test certificate</H3>

<A NAME="ixAAO"></A>
To create simple test certificates with OpenSSL, you may
run the following command:
<P>



<PRE>
  openssl req -config /usr/local/openssl/openssl.cnf \
    -new -days 365 -newkey rsa:1024 -x509 \
    -keyout notacakey.pem -out notacacert.pem

</PRE>


<P>

To remove the pass phrase from the key file, run:
<P>



<PRE>
  openssl rsa -in notacakey.pem -out notacakeynopass.pem

</PRE>


<A NAME="lbAN">&nbsp;</A>
<H3><FONT SIZE="-1">PKCS12</FONT> support</H3>

<A NAME="ixAAP"></A>
The directives for enabling use of <FONT SIZE="-1">PKCS12</FONT> certificates is:
<P>



<PRE>
  $ENV{HTTPS_PKCS12_FILE}     = 'certs/pkcs12.pkcs12';
  $ENV{HTTPS_PKCS12_PASSWORD} = 'PKCS12_PASSWORD';

</PRE>


<P>

Use of this type of certificate takes precedence over previous
certificate settings described. (<FONT SIZE="-1">TODO:</FONT> unclear? Meaning &quot;the
presence of this type of certificate??)
<A NAME="lbAO">&nbsp;</A>
<H2>SSL versions</H2>

<A NAME="ixAAQ"></A>
Crypt::SSLeay tries very hard to connect to <I>any</I> <FONT SIZE="-1">SSL</FONT> web server
accomodating servers that are buggy, old or simply
not standards-compliant. To this effect, this module will
try <FONT SIZE="-1">SSL</FONT> connections in this order:
<P>



<PRE>
  SSL v23 - should allow v2 and v3 servers to pick their best type
  SSL v3  - best connection type
  SSL v2  - old connection type

</PRE>


<P>

Unfortunately, some servers seem not to handle a reconnect
to <FONT SIZE="-1">SSL</FONT> v3 after a failed connect of <FONT SIZE="-1">SSL</FONT> v23 is tried,
so you may set before using <FONT SIZE="-1">LWP</FONT> or Net::SSL:
<P>



<PRE>
  $ENV{HTTPS_VERSION} = 3;

</PRE>


<P>

to force a version 3 <FONT SIZE="-1">SSL</FONT> connection first. At this time only a
version 2 <FONT SIZE="-1">SSL</FONT> connection will be tried after this, as the connection
attempt order remains unchanged by this setting.
<A NAME="lbAP">&nbsp;</A>
<H2>ACKNOWLEDGEMENTS</H2>

<A NAME="ixAAR"></A>
Many thanks to Gisle Aas for writing this module and many others
including libwww, for perl. The web will never be the same :)
<P>

Ben Laurie deserves kudos for his excellent patches for better error
handling, <FONT SIZE="-1">SSL</FONT> information inspection, and random seeding.
<P>

Thanks to Dongqiang Bai for host name resolution fix when using a
proxy.
<P>

Thanks to Stuart Horner of Core Communications, Inc. who found the
need for building --shared OpenSSL libraries.
<P>

Thanks to Pavel Hlavnicka for a patch for freeing memory when using
a pkcs12 file, and for inspiring more robust <I>read()</I> behavior.
<P>

James Woodyatt is a champ for finding a ridiculous memory leak that
has been the bane of many a Crypt::SSLeay user.
<P>

Thanks to Bryan Hart for his patch adding proxy support,
and thanks to Tobias Manthey for submitting another approach.
<P>

Thanks to Alex Rhomberg for Alpha linux ccc patch.
<P>

Thanks to Tobias Manthey for his patches for client certificate
support.
<P>

Thanks to Daisuke Kuroda for adding <FONT SIZE="-1">PKCS12</FONT> certificate support.
<P>

Thanks to Gamid Isayev for <FONT SIZE="-1">CA</FONT> cert support and insights into error
messaging.
<P>

Thanks to Jeff Long for working through a tricky <FONT SIZE="-1">CA</FONT> cert SSLClientVerify
issue.
<P>

Thanks to Chip Turner for patch to build under perl 5.8.0.
<P>

Thanks to Joshua Chamas for the time he spent maintaining the
module.
<P>

Thanks to Jeff Lavallee for help with alarms on read failures (<FONT SIZE="-1">CPAN</FONT>
bug #12444).
<P>

Thanks to Guenter Knauf for significant improvements in configuring
things in Win32 and Netware lands and Jan Dubois for various
suggestions for improvements.
<A NAME="lbAQ">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAAS"></A>
<DL COMPACT>
<DT>Net::SSL<DD>
<A NAME="ixAAT"></A>
If you have downloaded this distribution as of a dependency
of another distribution, it's probably due to this module
(which is included in this distribution).
<DT>Net::SSLeay<DD>
<A NAME="ixAAU"></A>
A module that offers access to the OpenSSL <FONT SIZE="-1">API</FONT> directly from Perl.


<P>




<PRE>
  <A HREF="http://search.cpan.org/dist/Net_SSLeay.pm/">http://search.cpan.org/dist/Net_SSLeay.pm/</A>

</PRE>


<DT><A HREF="http://www.openssl.org/related/binaries.html">http://www.openssl.org/related/binaries.html</A><DD>
<A NAME="ixAAV"></A>
Pointers on where to find OpenSSL binary packages (Windows).
</DL>
<A NAME="lbAR">&nbsp;</A>
<H2>SUPPORT</H2>

<A NAME="ixAAW"></A>
For use of Crypt::SSLeay &amp; Net::SSL with perl's <FONT SIZE="-1">LWP</FONT>, please
send email to <TT>&quot;<A HREF="mailto:libwww@perl.org">libwww@perl.org</A>&quot;</TT>.
<P>

For OpenSSL or general <FONT SIZE="-1">SSL</FONT> support please email the 
openssl user mailing list at <TT>&quot;<A HREF="mailto:openssl-users@openssl.org">openssl-users@openssl.org</A>&quot;</TT>.
This includes issues associated with building and installing
OpenSSL on one's system.
<P>

Please report all bugs at
&lt;<A HREF="http://rt.cpan.org/NoAuth/Bugs.html?Dist=Crypt-SSLeay">http://rt.cpan.org/NoAuth/Bugs.html?Dist=Crypt-SSLeay</A>&gt;.
<P>

This module was originally written by Gisle Aas, and was subsequently
maintained by Joshua Chamas. It is currently maintained by David
Landgren.
<A NAME="lbAS">&nbsp;</A>
<H2>COPYRIGHT</H2>

<A NAME="ixAAX"></A>


<PRE>
 Copyright (c) 2006-2007 David Landgren.
 Copyright (c) 1999-2003 Joshua Chamas.
 Copyright (c) 1998 Gisle Aas.

</PRE>


<P>

This program is free software; you can redistribute 
it and/or modify it under the same terms as Perl itself.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">ENVIRONMENT VARIABLES</A><DD>
<DT><A HREF="#lbAF">INSTALL</A><DD>
<DL>
<DT><A HREF="#lbAG">OpenSSL</A><DD>
<DT><A HREF="#lbAH">Crypt::SSLeay</A><DD>
</DL>
<DT><A HREF="#lbAI">PROXY SUPPORT</A><DD>
<DL>
<DT><A HREF="#lbAJ">LWP::UserAgent proxy support</A><DD>
<DT><A HREF="#lbAK">Crypt::SSLeay proxy support</A><DD>
</DL>
<DT><A HREF="#lbAL">CLIENT CERTIFICATE SUPPORT</A><DD>
<DL>
<DT><A HREF="#lbAM">Creating a test certificate</A><DD>
<DT><A HREF="#lbAN"><FONT SIZE="-1">PKCS12</FONT> support</A><DD>
</DL>
<DT><A HREF="#lbAO">SSL versions</A><DD>
<DT><A HREF="#lbAP">ACKNOWLEDGEMENTS</A><DD>
<DT><A HREF="#lbAQ">SEE ALSO</A><DD>
<DT><A HREF="#lbAR">SUPPORT</A><DD>
<DT><A HREF="#lbAS">COPYRIGHT</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:17 GMT, December 24, 2015
</div></div>
</body>
</HTML>
