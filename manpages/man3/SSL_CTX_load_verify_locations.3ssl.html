<!DOCTYPE html>

<HTML><head><TITLE>Manpage of SSL_CTX_load_verify_locations</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux manpages</a></div>
 <div class="site-description">{"type":"documentation"}</div>
 </div>
 </header>
 <div class="page-content"><div class="wrap">
<H1>SSL_CTX_load_verify_locations</H1>
Section: OpenSSL (3)<BR>Updated: 2001-09-07<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

SSL_CTX_load_verify_locations - set default locations for trusted CA
certificates
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAC"></A>


<PRE>
 #include &lt;<A HREF="file:/usr/include/openssl/ssl.h">openssl/ssl.h</A>&gt;

 int SSL_CTX_load_verify_locations(SSL_CTX *ctx, const char *CAfile,
                                   const char *CApath);

</PRE>


<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>
<I>SSL_CTX_load_verify_locations()</I> specifies the locations for <B>ctx</B>, at
which <FONT SIZE="-1">CA</FONT> certificates for verification purposes are located. The certificates
available via <B>CAfile</B> and <B>CApath</B> are trusted.
<A NAME="lbAE">&nbsp;</A>
<H2>NOTES</H2>

<A NAME="ixAAE"></A>
If <B>CAfile</B> is not <FONT SIZE="-1">NULL</FONT>, it points to a file of <FONT SIZE="-1">CA</FONT> certificates in <FONT SIZE="-1">PEM</FONT>
format. The file can contain several <FONT SIZE="-1">CA</FONT> certificates identified by
<P>



<PRE>
 -----BEGIN CERTIFICATE-----
 ... (CA certificate in base64 encoding) ...
 -----END CERTIFICATE-----

</PRE>


<P>

sequences. Before, between, and after the certificates text is allowed
which can be used e.g. for descriptions of the certificates.
<P>

The <B>CAfile</B> is processed on execution of the <I>SSL_CTX_load_verify_locations()</I>
function.
<P>

If <B>CApath</B> is not <FONT SIZE="-1">NULL</FONT>, it points to a directory containing <FONT SIZE="-1">CA</FONT> certificates
in <FONT SIZE="-1">PEM</FONT> format. The files each contain one <FONT SIZE="-1">CA</FONT> certificate. The files are
looked up by the <FONT SIZE="-1">CA</FONT> subject name hash value, which must hence be available.
If more than one <FONT SIZE="-1">CA</FONT> certificate with the same name hash value exist, the
extension must be different (e.g. 9d66eef0.0, 9d66eef0.1 etc). The search
is performed in the ordering of the extension number, regardless of other
properties of the certificates.
Use the <B>c_rehash</B> utility to create the necessary links.
<P>

The certificates in <B>CApath</B> are only looked up when required, e.g. when
building the certificate chain or when actually performing the verification
of a peer certificate.
<P>

When looking up <FONT SIZE="-1">CA</FONT> certificates, the OpenSSL library will first search the
certificates in <B>CAfile</B>, then those in <B>CApath</B>. Certificate matching
is done based on the subject name, the key identifier (if present), and the
serial number as taken from the certificate to be verified. If these data
do not match, the next certificate will be tried. If a first certificate
matching the parameters is found, the verification process will be performed;
no other certificates for the same parameters will be searched in case of
failure.
<P>

In server mode, when requesting a client certificate, the server must send
the list of CAs of which it will accept client certificates. This list
is not influenced by the contents of <B>CAfile</B> or <B>CApath</B> and must
explicitly be set using the
<I><A HREF="/manpages/index.html?3+SSL_CTX_set_client_CA_list">SSL_CTX_set_client_CA_list</A></I>(3)
family of functions.
<P>

When building its own certificate chain, an OpenSSL client/server will
try to fill in missing certificates from <B>CAfile</B>/<B>CApath</B>, if the
certificate chain was not explicitly specified (see
<I><A HREF="/manpages/index.html?3+SSL_CTX_add_extra_chain_cert">SSL_CTX_add_extra_chain_cert</A></I>(3),
<I><A HREF="/manpages/index.html?3+SSL_CTX_use_certificate">SSL_CTX_use_certificate</A></I>(3).
<A NAME="lbAF">&nbsp;</A>
<H2>WARNINGS</H2>

<A NAME="ixAAF"></A>
If several <FONT SIZE="-1">CA</FONT> certificates matching the name, key identifier, and serial
number condition are available, only the first one will be examined. This
may lead to unexpected results if the same <FONT SIZE="-1">CA</FONT> certificate is available
with different expiration dates. If a ``certificate expired'' verification
error occurs, no other certificate will be searched. Make sure to not
have expired certificates mixed with valid ones.
<A NAME="lbAG">&nbsp;</A>
<H2>EXAMPLES</H2>

<A NAME="ixAAG"></A>
Generate a <FONT SIZE="-1">CA</FONT> certificate file with descriptive text from the <FONT SIZE="-1">CA</FONT> certificates
ca1.pem ca2.pem ca3.pem:
<P>



<PRE>
 #!/bin/sh
 rm CAfile.pem
 for i in ca1.pem ca2.pem ca3.pem ; do
   openssl x509 -in $i -text &gt;&gt; CAfile.pem
 done

</PRE>


<P>

Prepare the directory /some/where/certs containing several <FONT SIZE="-1">CA</FONT> certificates
for use as <B>CApath</B>:
<P>



<PRE>
 cd /some/where/certs
 c_rehash .

</PRE>


<A NAME="lbAH">&nbsp;</A>
<H2>RETURN VALUES</H2>

<A NAME="ixAAH"></A>
The following return values can occur:
<DL COMPACT>
<DT>0<DD>
The operation failed because <B>CAfile</B> and <B>CApath</B> are <FONT SIZE="-1">NULL</FONT> or the
processing at one of the locations specified failed. Check the error
stack to find out the reason.
<DT>1<DD>
<A NAME="ixAAI"></A>
The operation succeeded.
</DL>
<A NAME="lbAI">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAAJ"></A>
<I><A HREF="/manpages/index.html?3+ssl">ssl</A></I>(3),
<I><A HREF="/manpages/index.html?3+SSL_CTX_set_client_CA_list">SSL_CTX_set_client_CA_list</A></I>(3),
<I><A HREF="/manpages/index.html?3+SSL_get_client_CA_list">SSL_get_client_CA_list</A></I>(3),
<I><A HREF="/manpages/index.html?3+SSL_CTX_use_certificate">SSL_CTX_use_certificate</A></I>(3),
<I><A HREF="/manpages/index.html?3+SSL_CTX_add_extra_chain_cert">SSL_CTX_add_extra_chain_cert</A></I>(3),
<I><A HREF="/manpages/index.html?3+SSL_CTX_set_cert_store">SSL_CTX_set_cert_store</A></I>(3)
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">NOTES</A><DD>
<DT><A HREF="#lbAF">WARNINGS</A><DD>
<DT><A HREF="#lbAG">EXAMPLES</A><DD>
<DT><A HREF="#lbAH">RETURN VALUES</A><DD>
<DT><A HREF="#lbAI">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:40 GMT, December 24, 2015
</div></div>
</body>
</HTML>
