<!DOCTYPE html>

<HTML><head><TITLE>Manpage of autodie::exception</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux manpages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>autodie::exception</H1>
Section: Perl Programmers Reference Guide (3pm)<BR>Updated: 2009-07-25<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

autodie::exception - Exceptions from autodying functions.
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAC"></A>


<PRE>
    eval {
        use autodie;

        open(my $fh, '&lt;', 'some_file.txt');

        ...
    };

    if (my $E = $@) {
        say &quot;Ooops!  &quot;,$E-&gt;caller,&quot; had problems: $@&quot;;
    }

</PRE>


<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>
When an autodie enabled function fails, it generates an
<TT>&quot;autodie::exception&quot;</TT> object.  This can be interrogated to
determine further information about the error that occurred.
<P>

This document is broken into two sections; those methods that
are most useful to the end-developer, and those methods for
anyone wishing to subclass or get very familiar with
<TT>&quot;autodie::exception&quot;</TT>.
<A NAME="lbAE">&nbsp;</A>
<H3>Common Methods</H3>

<A NAME="ixAAE"></A>
These methods are intended to be used in the everyday dealing
of exceptions.
<P>

The following assume that the error has been copied into
a separate scalar:
<P>



<PRE>
    if ($E = $@) {
        ...
    }

</PRE>


<P>

This is not required, but is recommended in case any code
is called which may reset or alter <TT>$@</TT>.
<P>

<I>args</I>
<A NAME="ixAAF"></A>
<P>



<PRE>
    my $array_ref = $E-&gt;args;

</PRE>


<P>

Provides a reference to the arguments passed to the subroutine
that died.
<P>

<I>function</I>
<A NAME="ixAAG"></A>
<P>



<PRE>
    my $sub = $E-&gt;function;

</PRE>


<P>

The subroutine (including package) that threw the exception.
<P>

<I>file</I>
<A NAME="ixAAH"></A>
<P>



<PRE>
    my $file = $E-&gt;file;

</PRE>


<P>

The file in which the error occurred (eg, <TT>&quot;myscript.pl&quot;</TT> or
<TT>&quot;MyTest.pm&quot;</TT>).
<P>

<I>package</I>
<A NAME="ixAAI"></A>
<P>



<PRE>
    my $package = $E-&gt;package;

</PRE>


<P>

The package from which the exceptional subroutine was called.
<P>

<I>caller</I>
<A NAME="ixAAJ"></A>
<P>



<PRE>
    my $caller = $E-&gt;caller;

</PRE>


<P>

The subroutine that <I>called</I> the exceptional code.
<P>

<I>line</I>
<A NAME="ixAAK"></A>
<P>



<PRE>
    my $line = $E-&gt;line;

</PRE>


<P>

The line in <TT>&quot;$E-&gt;file&quot;</TT> where the exceptional code was called.
<P>

<I>context</I>
<A NAME="ixAAL"></A>
<P>



<PRE>
    my $context = $E-&gt;context;

</PRE>


<P>

The context in which the subroutine was called.  This can be
'list', 'scalar', or undefined (unknown).  It will never be 'void', as
<TT>&quot;autodie&quot;</TT> always captures the return value in one way or another.
<P>

<I>return</I>
<A NAME="ixAAM"></A>
<P>



<PRE>
    my $return_value = $E-&gt;return;

</PRE>


<P>

The value(s) returned by the failed subroutine.  When the subroutine
was called in a list context, this will always be a reference to an
array containing the results.  When the subroutine was called in
a scalar context, this will be the actual scalar returned.
<P>

<I>errno</I>
<A NAME="ixAAN"></A>
<P>



<PRE>
    my $errno = $E-&gt;errno;

</PRE>


<P>

The value of <TT>$!</TT> at the time when the exception occurred.
<P>

<B></B><FONT SIZE="-1"><B>NOTE</B></FONT><B></B>: This method will leave the main <TT>&quot;autodie::exception&quot;</TT> class
and become part of a role in the future.  You should only call
<TT>&quot;errno&quot;</TT> for exceptions where <TT>$!</TT> would reasonably have been
set on failure.
<P>

<I>eval_error</I>
<A NAME="ixAAO"></A>
<P>



<PRE>
    my $old_eval_error = $E-&gt;eval_error;

</PRE>


<P>

The contents of <TT>$@</TT> immediately after autodie triggered an
exception.  This may be useful when dealing with modules such
as Text::Balanced that set (but do not throw) <TT>$@</TT> on error.
<P>

<I>matches</I>
<A NAME="ixAAP"></A>
<P>



<PRE>
    if ( $e-&gt;matches('open') ) { ... }

    if ( $e ~~ 'open' ) { ... }

</PRE>


<P>

<TT>&quot;matches&quot;</TT> is used to determine whether a
given exception matches a particular role.  On Perl 5.10,
using smart-match (<TT>&quot;~~&quot;</TT>) with an <TT>&quot;autodie::exception&quot;</TT> object
will use <TT>&quot;matches&quot;</TT> underneath.
<P>

An exception is considered to match a string if:
<DL COMPACT>
<DT>*<DD>
For a string not starting with a colon, the string exactly matches the
package and subroutine that threw the exception.  For example,
<TT>&quot;MyModule::log&quot;</TT>.  If the string does not contain a package name,
<TT>&quot;CORE::&quot;</TT> is assumed.
<DT>*<DD>
For a string that does start with a colon, if the subroutine
throwing the exception <I>does</I> that behaviour.  For example, the
<TT>&quot;CORE::open&quot;</TT> subroutine does <TT>&quot;:file&quot;</TT>, <TT>&quot;:io&quot;</TT> and <TT>&quot;:all&quot;</TT>.


<P>


See ``<FONT SIZE="-1">CATEGORIES</FONT>'' in autodie for futher information.
</DL>
<A NAME="lbAF">&nbsp;</A>
<H3>Advanced methods</H3>

<A NAME="ixAAQ"></A>
The following methods, while usable from anywhere, are primarily
intended for developers wishing to subclass <TT>&quot;autodie::exception&quot;</TT>,
write code that registers custom error messages, or otherwise
work closely with the <TT>&quot;autodie::exception&quot;</TT> model.
<P>

<I>register</I>
<A NAME="ixAAR"></A>
<P>



<PRE>
    autodie::exception-&gt;register( 'CORE::open' =&gt; \&amp;mysub );

</PRE>


<P>

The <TT>&quot;register&quot;</TT> method allows for the registration of a message
handler for a given subroutine.  The full subroutine name including
the package should be used.
<P>

Registered message handlers will receive the <TT>&quot;autodie::exception&quot;</TT>
object as the first parameter.
<P>

<I>add_file_and_line</I>
<A NAME="ixAAS"></A>
<P>



<PRE>
    say &quot;Problem occurred&quot;,$@-&gt;add_file_and_line;

</PRE>


<P>

Returns the string <TT>&quot; at %s line %d&quot;</TT>, where <TT>%s</TT> is replaced with
the filename, and <TT>%d</TT> is replaced with the line number.
<P>

Primarily intended for use by format handlers.
<P>

<I>stringify</I>
<A NAME="ixAAT"></A>
<P>



<PRE>
    say &quot;The error was: &quot;,$@-&gt;stringify;

</PRE>


<P>

Formats the error as a human readable string.  Usually there's no
reason to call this directly, as it is used automatically if an
<TT>&quot;autodie::exception&quot;</TT> object is ever used as a string.
<P>

Child classes can override this method to change how they're
stringified.
<P>

<I>format_default</I>
<A NAME="ixAAU"></A>
<P>



<PRE>
    my $error_string = $E-&gt;format_default;

</PRE>


<P>

This produces the default error string for the given exception,
<I>without using any registered message handlers</I>.  It is primarily
intended to be called from a message handler when they have
been passed an exception they don't want to format.
<P>

Child classes can override this method to change how default
messages are formatted.
<P>

<I>new</I>
<A NAME="ixAAV"></A>
<P>



<PRE>
    my $error = autodie::exception-&gt;new(
        args =&gt; \@_,
        function =&gt; &quot;CORE::open&quot;,
        errno =&gt; $!,
        context =&gt; 'scalar',
        return =&gt; undef,
    );

</PRE>


<P>

Creates a new <TT>&quot;autodie::exception&quot;</TT> object.  Normally called
directly from an autodying function.  The <TT>&quot;function&quot;</TT> argument
is required, its the function we were trying to call that
generated the exception.  The <TT>&quot;args&quot;</TT> parameter is optional.
<P>

The <TT>&quot;errno&quot;</TT> value is optional.  In versions of <TT>&quot;autodie::exception&quot;</TT>
1.99 and earlier the code would try to automatically use the
current value of <TT>$!</TT>, but this was unreliable and is no longer
supported.
<P>

Atrributes such as package, file, and caller are determined
automatically, and cannot be specified.
<A NAME="lbAG">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAAW"></A>
autodie, autodie::exception::system
<A NAME="lbAH">&nbsp;</A>
<H2>LICENSE</H2>

<A NAME="ixAAX"></A>
Copyright (C)2008 Paul Fenwick
<P>

This is free software.  You may modify and/or redistribute this
code under the same terms as Perl 5.10 itself, or, at your option,
any later version of Perl 5.
<A NAME="lbAI">&nbsp;</A>
<H2>AUTHOR</H2>

<A NAME="ixAAY"></A>
Paul Fenwick &lt;<A HREF="mailto:pjf@perltraining.com.au">pjf@perltraining.com.au</A>&gt;
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DL>
<DT><A HREF="#lbAE">Common Methods</A><DD>
<DT><A HREF="#lbAF">Advanced methods</A><DD>
</DL>
<DT><A HREF="#lbAG">SEE ALSO</A><DD>
<DT><A HREF="#lbAH">LICENSE</A><DD>
<DT><A HREF="#lbAI">AUTHOR</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:12 GMT, December 24, 2015
</div></body>
</HTML>
