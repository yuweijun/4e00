<!DOCTYPE html>

<HTML><head><TITLE>Manpage of security_load_policy</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux man pages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>security_load_policy</H1>
Section: SELinux API documentation (3)<BR>Updated: 3 November 2009<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

security_load_policy - load a new SELinux policy
<P>
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>#include &lt;<A HREF="file:/usr/include/selinux/selinux.h">selinux/selinux.h</A>&gt;</B>

<P>
<B>int security_load_policy(void *</B><I>data</I><B>, size_t len</B><I>);</I>

<P>
<B>int selinux_mkload_policy(int </B><I>preservebools</I><B>);</B>

<P>
<B>int selinux_init_load_policy(int *</B><I>enforce</I><B>);</B>

<P>
<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<B>security_load_policy</B>

loads a new policy, returns 0 for success and -1 for error.
<P>
<B>selinux_mkload_policy</B>

makes a policy image and loads it. This function provides a higher level
interface for loading policy than
<B>security_load_policy,</B>

internally determining the right policy version, locating and opening
the policy file, mapping it into memory, manipulating it as needed for
current boolean settings and/or local definitions, and then calling
security_load_policy to load it.
<I>preservebools</I>

is a boolean flag indicating whether current policy boolean values should
be preserved into the new policy (if 1) or reset to the saved policy
settings (if 0). The former case is the default for policy reloads, while
the latter case is an option for policy reloads but is primarily used for
the initial policy load.
<B>selinux_init_load_policy</B>

performs the initial policy load. This function determines the desired
enforcing mode, sets the
<I>enforce</I>

argument accordingly for the caller to use, sets the SELinux kernel
enforcing status to match it, and loads the policy. It also internally
handles the initial selinuxfs mount required to perform these actions.
<P>
It should also be noted that after the initial policy load, the SELinux
kernel code cannot anymore be disabled and the selinuxfs cannot be
unmounted using a call to
<B><A HREF="/manpages/index.html?3+security_disable">security_disable</A>(3).</B>

Therefore, after the initial policy load, the only operational changes
are those permitted by
<B><A HREF="/manpages/index.html?3+setenforce">setenforce</A>(3)</B>

(i.e. eventually setting the framework in permissive mode rather than
in enforcing one).
<P>
<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUE</H2>

returns zero on success or -1 on error.
<P>
<A NAME="lbAF">&nbsp;</A>
<H2>AUTHOR</H2>

This manual page has been written by Guido Trentalancia &lt;<A HREF="mailto:guido@trentalancia.com">guido@trentalancia.com</A>&gt;
<P>
<A NAME="lbAG">&nbsp;</A>
<H2>SEE ALSO</H2>

<B><A HREF="/manpages/index.html?8+selinux">selinux</A></B>(8), <B><A HREF="http://localhost/cgi-bin/man/man2html?3+security_disable">security_disable</A></B>(3), <B><A HREF="http://localhost/cgi-bin/man/man2html?1+setenforce">setenforce</A></B>(1)

<P>
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">RETURN VALUE</A><DD>
<DT><A HREF="#lbAF">AUTHOR</A><DD>
<DT><A HREF="#lbAG">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:39 GMT, December 24, 2015
</div></body>
</HTML>
