<!DOCTYPE html>

<HTML><head><TITLE>Manpage of BN_mod_mul_montgomery</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux manpages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content"><div class="wrap">
<H1>BN_mod_mul_montgomery</H1>
Section: OpenSSL (3)<BR>Updated: 2002-09-25<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

BN_mod_mul_montgomery, BN_MONT_CTX_new, BN_MONT_CTX_init,
BN_MONT_CTX_free, BN_MONT_CTX_set, BN_MONT_CTX_copy,
BN_from_montgomery, BN_to_montgomery - Montgomery multiplication
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAC"></A>


<PRE>
 #include &lt;<A HREF="file:/usr/include/openssl/bn.h">openssl/bn.h</A>&gt;

 BN_MONT_CTX *BN_MONT_CTX_new(void);
 void BN_MONT_CTX_init(BN_MONT_CTX *ctx);
 void BN_MONT_CTX_free(BN_MONT_CTX *mont);

 int BN_MONT_CTX_set(BN_MONT_CTX *mont, const BIGNUM *m, BN_CTX *ctx);
 BN_MONT_CTX *BN_MONT_CTX_copy(BN_MONT_CTX *to, BN_MONT_CTX *from);

 int BN_mod_mul_montgomery(BIGNUM *r, BIGNUM *a, BIGNUM *b,
         BN_MONT_CTX *mont, BN_CTX *ctx);

 int BN_from_montgomery(BIGNUM *r, BIGNUM *a, BN_MONT_CTX *mont,
         BN_CTX *ctx);

 int BN_to_montgomery(BIGNUM *r, BIGNUM *a, BN_MONT_CTX *mont,
         BN_CTX *ctx);

</PRE>


<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>
These functions implement Montgomery multiplication. They are used
automatically when <I><A HREF="/manpages/index.html?3+BN_mod_exp">BN_mod_exp</A></I>(3) is called with suitable input,
but they may be useful when several operations are to be performed
using the same modulus.
<P>

<I>BN_MONT_CTX_new()</I> allocates and initializes a <B></B><FONT SIZE="-1"><B>BN_MONT_CTX</B></FONT><B></B> structure.
<I>BN_MONT_CTX_init()</I> initializes an existing uninitialized <B></B><FONT SIZE="-1"><B>BN_MONT_CTX</B></FONT><B></B>.
<P>

<I>BN_MONT_CTX_set()</I> sets up the <I>mont</I> structure from the modulus <I>m</I>
by precomputing its inverse and a value R.
<P>

<I>BN_MONT_CTX_copy()</I> copies the <B></B><FONT SIZE="-1"><B>BN_MONT_CTX</B></FONT><B></B> <I>from</I> to <I>to</I>.
<P>

<I>BN_MONT_CTX_free()</I> frees the components of the <B></B><FONT SIZE="-1"><B>BN_MONT_CTX</B></FONT><B></B>, and, if
it was created by <I>BN_MONT_CTX_new()</I>, also the structure itself.
<P>

<I>BN_mod_mul_montgomery()</I> computes Mont(<I>a</I>,<I>b</I>):=<I>a</I>*<I>b</I>*R^-1 and places
the result in <I>r</I>.
<P>

<I>BN_from_montgomery()</I> performs the Montgomery reduction <I>r</I> = <I>a</I>*R^-1.
<P>

<I>BN_to_montgomery()</I> computes Mont(<I>a</I>,R^2), i.e. <I>a</I>*R.
Note that <I>a</I> must be non-negative and smaller than the modulus.
<P>

For all functions, <I>ctx</I> is a previously allocated <B></B><FONT SIZE="-1"><B>BN_CTX</B></FONT><B></B> used for
temporary variables.
<P>

The <B></B><FONT SIZE="-1"><B>BN_MONT_CTX</B></FONT><B></B> structure is defined as follows:
<P>



<PRE>
 typedef struct bn_mont_ctx_st
        {
        int ri;         /* number of bits in R */
        BIGNUM RR;      /* R^2 (used to convert to Montgomery form) */
        BIGNUM N;       /* The modulus */
        BIGNUM Ni;      /* R*(1/R mod N) - N*Ni = 1
                         * (Ni is only stored for bignum algorithm) */
        BN_ULONG n0;    /* least significant word of Ni */
        int flags;
        } BN_MONT_CTX;

</PRE>


<P>

<I>BN_to_montgomery()</I> is a macro.
<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUES</H2>

<A NAME="ixAAE"></A>
<I>BN_MONT_CTX_new()</I> returns the newly allocated <B></B><FONT SIZE="-1"><B>BN_MONT_CTX</B></FONT><B></B>, and <FONT SIZE="-1">NULL</FONT>
on error.
<P>

<I>BN_MONT_CTX_init()</I> and <I>BN_MONT_CTX_free()</I> have no return values.
<P>

For the other functions, 1 is returned for success, 0 on error.
The error codes can be obtained by <I><A HREF="/manpages/index.html?3+ERR_get_error">ERR_get_error</A></I>(3).
<A NAME="lbAF">&nbsp;</A>
<H2>WARNING</H2>

<A NAME="ixAAF"></A>
The inputs must be reduced modulo <B>m</B>, otherwise the result will be
outside the expected range.
<A NAME="lbAG">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAAG"></A>
<I><A HREF="/manpages/index.html?3+bn">bn</A></I>(3), <I><A HREF="http://localhost/cgi-bin/man/man2html?3+ERR_get_error">ERR_get_error</A></I>(3), <I><A HREF="http://localhost/cgi-bin/man/man2html?3+BN_add">BN_add</A></I>(3),
<I><A HREF="/manpages/index.html?3+BN_CTX_new">BN_CTX_new</A></I>(3)
<A NAME="lbAH">&nbsp;</A>
<H2>HISTORY</H2>

<A NAME="ixAAH"></A>
<I>BN_MONT_CTX_new()</I>, <I>BN_MONT_CTX_free()</I>, <I>BN_MONT_CTX_set()</I>,
<I>BN_mod_mul_montgomery()</I>, <I>BN_from_montgomery()</I> and <I>BN_to_montgomery()</I>
are available in all versions of SSLeay and OpenSSL.
<P>

<I>BN_MONT_CTX_init()</I> and <I>BN_MONT_CTX_copy()</I> were added in SSLeay 0.9.1b.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">RETURN VALUES</A><DD>
<DT><A HREF="#lbAF">WARNING</A><DD>
<DT><A HREF="#lbAG">SEE ALSO</A><DD>
<DT><A HREF="#lbAH">HISTORY</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:15 GMT, December 24, 2015
</div></div>
</body>
</HTML>
