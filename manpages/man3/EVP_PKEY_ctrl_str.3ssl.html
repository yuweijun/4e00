<!DOCTYPE html>

<HTML><head><TITLE>Manpage of EVP_PKEY_CTX_ctrl</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux manpages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content"><div class="wrap">
<H1>EVP_PKEY_CTX_ctrl</H1>
Section: OpenSSL (3)<BR>Updated: 2009-09-30<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

EVP_PKEY_ctrl, EVP_PKEY_ctrl_str - algorithm specific control operations
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAC"></A>


<PRE>
 #include &lt;<A HREF="file:/usr/include/openssl/evp.h">openssl/evp.h</A>&gt;

 int EVP_PKEY_CTX_ctrl(EVP_PKEY_CTX *ctx, int keytype, int optype,
                                int cmd, int p1, void *p2);
 int EVP_PKEY_CTX_ctrl_str(EVP_PKEY_CTX *ctx, const char *type,
                                                const char *value);

 int EVP_PKEY_get_default_digest_nid(EVP_PKEY *pkey, int *pnid);

 #include &lt;<A HREF="file:/usr/include/openssl/rsa.h">openssl/rsa.h</A>&gt;

 int EVP_PKEY_CTX_set_signature_md(EVP_PKEY_CTX *ctx, const EVP_MD *md);

 int EVP_PKEY_CTX_set_rsa_padding(EVP_PKEY_CTX *ctx, int pad);
 int EVP_PKEY_CTX_set_rsa_pss_saltlen(EVP_PKEY_CTX *ctx, int len);
 int EVP_PKEY_CTX_set_rsa_rsa_keygen_bits(EVP_PKEY_CTX *ctx, int mbits);
 int EVP_PKEY_CTX_set_rsa_keygen_pubexp(EVP_PKEY_CTX *ctx, BIGNUM *pubexp);

 #include &lt;<A HREF="file:/usr/include/openssl/dsa.h">openssl/dsa.h</A>&gt;
 int EVP_PKEY_CTX_set_dsa_paramgen_bits(EVP_PKEY_CTX *ctx, int nbits);

 #include &lt;<A HREF="file:/usr/include/openssl/dh.h">openssl/dh.h</A>&gt;
 int EVP_PKEY_CTX_set_dh_paramgen_prime_len(EVP_PKEY_CTX *ctx, int len);
 int EVP_PKEY_CTX_set_dh_paramgen_generator(EVP_PKEY_CTX *ctx, int gen);

 #include &lt;<A HREF="file:/usr/include/openssl/ec.h">openssl/ec.h</A>&gt;
 int EVP_PKEY_CTX_set_ec_paramgen_curve_nid(EVP_PKEY_CTX *ctx, int nid);

</PRE>


<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>
The function <I>EVP_PKEY_CTX_ctrl()</I> sends a control operation to the context
<B>ctx</B>. The key type used must match <B>keytype</B> if it is not -1. The parameter
<B>optype</B> is a mask indicating which operations the control can be applied to.
The control command is indicated in <B>cmd</B> and any additional arguments in
<B>p1</B> and <B>p2</B>.
<P>

Applications will not normally call <I>EVP_PKEY_CTX_ctrl()</I> directly but will
instead call one of the algorithm specific macros below.
<P>

The function <I>EVP_PKEY_ctrl_str()</I> allows an application to send an algorithm
specific control operation to a context <B>ctx</B> in string form. This is
intended to be used for options specified on the command line or in text
files. The commands supported are documented in the openssl utility
command line pages for the option <B>-pkeyopt</B> which is supported by the
<B>pkeyutl</B>, <B>genpkey</B> and <B>req</B> commands.
<P>

All the remaining ``functions'' are implemented as macros.
<P>

The <I>EVP_PKEY_CTX_set_signature_md()</I> macro sets the message digest type used
in a signature. It can be used with any public key algorithm supporting
signature operations.
<P>

The macro <I>EVP_PKEY_CTX_set_rsa_padding()</I> sets the <FONT SIZE="-1">RSA</FONT> padding mode for <B>ctx</B>.
The <B>pad</B> parameter can take the value <FONT SIZE="-1">RSA_PKCS1_PADDING</FONT> for PKCS#1 padding,
<FONT SIZE="-1">RSA_SSLV23_PADDING</FONT> for SSLv23 padding, <FONT SIZE="-1">RSA_NO_PADDING</FONT> for no padding,
<FONT SIZE="-1">RSA_PKCS1_OAEP_PADDING</FONT> for <FONT SIZE="-1">OAEP</FONT> padding (encrypt and decrypt only),
<FONT SIZE="-1">RSA_X931_PADDING</FONT> for X9.31 padding (signature operations only) and 
<FONT SIZE="-1">RSA_PKCS1_PSS_PADDING</FONT> (sign and verify only).
<P>

Two <FONT SIZE="-1">RSA</FONT> padding modes behave differently if <I>EVP_PKEY_CTX_set_signature_md()</I>
is used. If this macro is called for PKCS#1 padding the plaintext buffer is
an actual digest value and is encapsulated in a DigestInfo structure according
to PKCS#1 when signing and this structure is expected (and stripped off) when
verifying. If this control is not used with <FONT SIZE="-1">RSA</FONT> and PKCS#1 padding then the
supplied data is used directly and not encapsulated. In the case of X9.31
padding for <FONT SIZE="-1">RSA</FONT> the algorithm identifier byte is added or checked and removed
if this control is called. If it is not called then the first byte of the plaintext buffer is expected to be the algorithm identifier byte.
<P>

The <I>EVP_PKEY_CTX_set_rsa_pss_saltlen()</I> macro sets the <FONT SIZE="-1">RSA</FONT> <FONT SIZE="-1">PSS</FONT> salt length to
<B>len</B> as its name implies it is only supported for <FONT SIZE="-1">PSS</FONT> padding.  Two special
values are supported: -1 sets the salt length to the digest length. When
signing -2 sets the salt length to the maximum permissible value. When
verifying -2 causes the salt length to be automatically determined based on the
<B></B><FONT SIZE="-1"><B>PSS</B></FONT><B></B> block structure. If this macro is not called a salt length value of -2
is used by default.
<P>

The <I>EVP_PKEY_CTX_set_rsa_rsa_keygen_bits()</I> macro sets the <FONT SIZE="-1">RSA</FONT> key length for
<FONT SIZE="-1">RSA</FONT> key genration to <B>bits</B>. If not specified 1024 bits is used.
<P>

The <I>EVP_PKEY_CTX_set_rsa_keygen_pubexp()</I> macro sets the public exponent value
for <FONT SIZE="-1">RSA</FONT> key generation to <B>pubexp</B> currently it should be an odd integer. The
<B>pubexp</B> pointer is used internally by this function so it should not be 
modified or free after the call. If this macro is not called then 65537 is used.
<P>

The macro <I>EVP_PKEY_CTX_set_dsa_paramgen_bits()</I> sets the number of bits used
for <FONT SIZE="-1">DSA</FONT> parameter generation to <B>bits</B>. If not specified 1024 is used.
<P>

The macro <I>EVP_PKEY_CTX_set_dh_paramgen_prime_len()</I> sets the length of the <FONT SIZE="-1">DH</FONT>
prime parameter <B>p</B> for <FONT SIZE="-1">DH</FONT> parameter generation. If this macro is not called
then 1024 is used.
<P>

The <I>EVP_PKEY_CTX_set_dh_paramgen_generator()</I> macro sets <FONT SIZE="-1">DH</FONT> generator to <B>gen</B>
for <FONT SIZE="-1">DH</FONT> parameter generation. If not specified 2 is used.
<P>

The <I>EVP_PKEY_CTX_set_ec_paramgen_curve_nid()</I> sets the <FONT SIZE="-1">EC</FONT> curve for <FONT SIZE="-1">EC</FONT> parameter
generation to <B>nid</B>. For <FONT SIZE="-1">EC</FONT> parameter generation this macro must be called
or an error occurs because there is no default curve.
<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUES</H2>

<A NAME="ixAAE"></A>
<I>EVP_PKEY_CTX_ctrl()</I> and its macros return a positive value for success and 0
or a negative value for failure. In particular a return value of -2
indicates the operation is not supported by the public key algorithm.
<A NAME="lbAF">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAAF"></A>
<I><A HREF="/manpages/index.html?3+EVP_PKEY_CTX_new">EVP_PKEY_CTX_new</A></I>(3),
<I><A HREF="/manpages/index.html?3+EVP_PKEY_encrypt">EVP_PKEY_encrypt</A></I>(3),
<I><A HREF="/manpages/index.html?3+EVP_PKEY_decrypt">EVP_PKEY_decrypt</A></I>(3),
<I><A HREF="/manpages/index.html?3+EVP_PKEY_sign">EVP_PKEY_sign</A></I>(3),
<I><A HREF="/manpages/index.html?3+EVP_PKEY_verify">EVP_PKEY_verify</A></I>(3),
<I><A HREF="/manpages/index.html?3+EVP_PKEY_verifyrecover">EVP_PKEY_verifyrecover</A></I>(3),
<I><A HREF="/manpages/index.html?3+EVP_PKEY_derive">EVP_PKEY_derive</A></I>(3) 
<I><A HREF="/manpages/index.html?3+EVP_PKEY_keygen">EVP_PKEY_keygen</A></I>(3)
<A NAME="lbAG">&nbsp;</A>
<H2>HISTORY</H2>

<A NAME="ixAAG"></A>
These functions were first added to OpenSSL 1.0.0.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">RETURN VALUES</A><DD>
<DT><A HREF="#lbAF">SEE ALSO</A><DD>
<DT><A HREF="#lbAG">HISTORY</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:25 GMT, December 24, 2015
</div></div>
</body>
</HTML>
