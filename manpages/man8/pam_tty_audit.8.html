<!DOCTYPE html>

<HTML><head><TITLE>Manpage of PAM_TTY_AUDIT</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/manpages/index.html">linux manpages</a></div>
 <div class="site-description">{"type":"documentation"}</div>
 </div>
 </header>
 <div class="page-content"><div class="wrap">
<H1>PAM_TTY_AUDIT</H1>
Section: Linux\-PAM Manual (8)<BR>Updated: 11/04/2009<BR><A HREF="#index">Index</A>
<A HREF="/manpages/index.html">Return to Main Contents</A><HR>











<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

pam_tty_audit - Enable or disable TTY auditing for specified users
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<DL COMPACT>
<DT>
<B>pam_tty_audit.so</B> [disable=<I>patterns</I>] [enable=<I>patterns</I>]
</DL>
<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<P>

<DD>The pam_tty_audit PAM module is used to enable or disable TTY auditing. By default, the kernel does not audit input on any TTY.
<A NAME="lbAE">&nbsp;</A>
<H2>OPTIONS</H2>

<P>

<B>disable=</B><B></B><I>patterns</I>
<DL COMPACT><DT><DD>
For each user matching one of comma-separated glob
<B></B><I>patterns</I>, disable TTY auditing. This overrides any previous
<B>enable</B>
option matching the same user name on the command line.
</DL>

<P>

<B>enable=</B><B></B><I>patterns</I>
<DL COMPACT><DT><DD>
For each user matching one of comma-separated glob
<B></B><I>patterns</I>, enable TTY auditing. This overrides any previous
<B>disable</B>
option matching the same user name on the command line.
</DL>

<P>

<B>open_only</B>
<DL COMPACT><DT><DD>
Set the TTY audit flag when opening the session, but do not restore it when closing the session. Using this option is necessary for some services that don't
<B>fork()</B>
to run the authenticated session, such as
<B>sudo</B>.
</DL>

<A NAME="lbAF">&nbsp;</A>
<H2>MODULE TYPES PROVIDED</H2>

<P>

Only the
<B>session</B>
type is supported.
<A NAME="lbAG">&nbsp;</A>
<H2>RETURN VALUES</H2>

<P>

PAM_SESSION_ERR
<DL COMPACT><DT><DD>
Error reading or modifying the TTY audit flag. See the system log for more details.
</DL>

<P>

PAM_SUCCESS
<DL COMPACT><DT><DD>
Success.
</DL>

<A NAME="lbAH">&nbsp;</A>
<H2>NOTES</H2>

<P>

When TTY auditing is enabled, it is inherited by all processes started by that user. In particular, daemons restarted by an user will still have TTY auditing enabled, and audit TTY input even by other users unless auditing for these users is explicitly disabled. Therefore, it is recommended to use
<B>disable=*</B>
as the first option for most daemons using PAM.
<P>

To view the data that was logged by the kernel to audit use the command
<B>aureport --tty</B>.
<A NAME="lbAI">&nbsp;</A>
<H2>EXAMPLES</H2>

<P>

Audit all administrative actions.
<P>
<DL COMPACT><DT><DD>



<PRE>
session required pam_tty_audit.so disable=* enable=root
      
</PRE>

</DL>




<P>
<A NAME="lbAJ">&nbsp;</A>
<H2>SEE ALSO</H2>

<P>

<P>
<B><A HREF="/manpages/index.html?8+aureport">aureport</A></B>(8),
<B><A HREF="/manpages/index.html?5+pam.conf">pam.conf</A></B>(5),
<B><A HREF="/manpages/index.html?5+pam.d">pam.d</A></B>(5),
<B><A HREF="/manpages/index.html?8+pam">pam</A></B>(8)
<A NAME="lbAK">&nbsp;</A>
<H2>AUTHOR</H2>

<P>

pam_tty_audit was written by Miloslav Trmaƒç &lt;<A HREF="mailto:mitr@redhat.com">mitr@redhat.com</A>&gt;.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">OPTIONS</A><DD>
<DT><A HREF="#lbAF">MODULE TYPES PROVIDED</A><DD>
<DT><A HREF="#lbAG">RETURN VALUES</A><DD>
<DT><A HREF="#lbAH">NOTES</A><DD>
<DT><A HREF="#lbAI">EXAMPLES</A><DD>
<DT><A HREF="#lbAJ">SEE ALSO</A><DD>
<DT><A HREF="#lbAK">AUTHOR</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/manpages/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:34:28 GMT, December 24, 2015
</div></div>
</body>
</HTML>
