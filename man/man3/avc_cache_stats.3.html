<!DOCTYPE html>

<HTML><head><TITLE>Manpage of avc_cache_stats</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/man/index.html">linux man pages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>avc_cache_stats</H1>
Section: SELinux API documentation (3)<BR>Updated: 27 May 2004<BR><A HREF="#index">Index</A>
<A HREF="/man/index.html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

avc_cache_stats, avc_av_stats, avc_sid_stats - obtain userspace SELinux AVC statistics.
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>#include &lt;<A HREF="file:/usr/include/selinux/selinux.h">selinux/selinux.h</A>&gt;</B>

<P>
<B>#include &lt;<A HREF="file:/usr/include/selinux/avc.h">selinux/avc.h</A>&gt;</B>

<P>
<B>void avc_av_stats(void);</B>

<P>
<B>void avc_sid_stats(void);</B>

<P>
<B>void avc_cache_stats(struct avc_cache_stats *</B><I>stats</I><B>);</B>

<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

The userspace AVC maintains two internal hash tables, one to store security ID's and one to cache access decisions.
<P>
<B>avc_av_stats</B>

and
<B>avc_sid_stats</B>

produce log messages indicating the status of the access decision and SID tables, respectively.  The messages contain the number of entries in the table, number of hash buckets and number of buckets used, and maximum number of entries in a single bucket.
<P>
<B>avc_cache_stats</B>

populates a structure whose fields reflect cache activity:
<P>
<DL COMPACT><DT><DD>


<PRE>
struct avc_cache_stats {
    unsigned  entry_lookups;
    unsigned  entry_hits;
    unsigned  entry_misses;
    unsigned  entry_discards;
    unsigned  cav_lookups;
    unsigned  cav_hits;
    unsigned  cav_probes;
    unsigned  cav_misses;
};
</PRE>



</DL>

<P>
<DL COMPACT>
<DT><I>entry_lookups</I>

<DD>
Number of queries made.
<DT><I>entry_hits</I>

<DD>
Number of times a decision was found in the
<I>aeref</I>

argument.
<DT><I>entry_misses</I>

<DD>
Number of times a decision was not found in the
<I>aeref</I>

argument.
<DT><I>entry_discards</I>

<DD>
Number of times a decision was not found in the
<I>aeref</I>

argument and the
<I>aeref</I>

argument was non-NULL.
<DT><I>cav_lookups</I>

<DD>
Number of cache lookups.
<DT><I>cav_hits</I>

<DD>
Number of cache hits.
<DT><I>cav_misses</I>

<DD>
Number of cache misses.
<DT><I>cav_probes</I>

<DD>
Number of entries examined while searching the cache.
<P>
</DL>
<A NAME="lbAE">&nbsp;</A>
<H2>NOTES</H2>

When the cache is flushed as a result of a call to
<B>avc_reset</B>

or a policy change notification,
the statistics returned by
<B>avc_cache_stats</B>

are reset to zero.  The SID table, however, is left
unchanged.
<P>
When a policy change notification is received, a call to
<B>avc_av_stats</B>

is made before the cache is flushed.
<P>
<A NAME="lbAF">&nbsp;</A>
<H2>AUTHOR</H2>

Eamon Walsh &lt;<A HREF="mailto:ewalsh@tycho.nsa.gov">ewalsh@tycho.nsa.gov</A>&gt;
<P>
<A NAME="lbAG">&nbsp;</A>
<H2>SEE ALSO</H2>

<B><A HREF="/man/index.html?3+avc_init">avc_init</A></B>(3),

<B><A HREF="/man/index.html?3+avc_has_perm">avc_has_perm</A></B>(3),

<B><A HREF="/man/index.html?3+avc_context_to_sid">avc_context_to_sid</A></B>(3),

<B><A HREF="/man/index.html?3+avc_add_callback">avc_add_callback</A></B>(3)

<B><A HREF="/man/index.html?8+selinux">selinux</A></B>(8)

<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">NOTES</A><DD>
<DT><A HREF="#lbAF">AUTHOR</A><DD>
<DT><A HREF="#lbAG">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/man/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:12 GMT, December 24, 2015
</div></body>
</HTML>
