<!DOCTYPE html>

<HTML><head><TITLE>Manpage of EVP_SealInit</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/man/index.html">linux man pages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>EVP_SealInit</H1>
Section: OpenSSL (3)<BR>Updated: 2005-03-29<BR><A HREF="#index">Index</A>
<A HREF="/man/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

EVP_SealInit, EVP_SealUpdate, EVP_SealFinal - EVP envelope encryption
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAC"></A>


<PRE>
 #include &lt;<A HREF="file:/usr/include/openssl/evp.h">openssl/evp.h</A>&gt;

 int EVP_SealInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *type,
                  unsigned char **ek, int *ekl, unsigned char *iv,
                  EVP_PKEY **pubk, int npubk);
 int EVP_SealUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out,
         int *outl, unsigned char *in, int inl);
 int EVP_SealFinal(EVP_CIPHER_CTX *ctx, unsigned char *out,
         int *outl);

</PRE>


<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>
The <FONT SIZE="-1">EVP</FONT> envelope routines are a high level interface to envelope
encryption. They generate a random key and <FONT SIZE="-1">IV</FONT> (if required) then
``envelope'' it by using public key encryption. Data can then be
encrypted using this key.
<P>

<I>EVP_SealInit()</I> initializes a cipher context <B>ctx</B> for encryption
with cipher <B>type</B> using a random secret key and <FONT SIZE="-1">IV</FONT>. <B>type</B> is normally
supplied by a function such as <I>EVP_des_cbc()</I>. The secret key is encrypted
using one or more public keys, this allows the same encrypted data to be
decrypted using any of the corresponding private keys. <B>ek</B> is an array of
buffers where the public key encrypted secret key will be written, each buffer
must contain enough room for the corresponding encrypted key: that is
<B>ek[i]</B> must have room for <B>EVP_PKEY_size(pubk[i])</B> bytes. The actual
size of each encrypted secret key is written to the array <B>ekl</B>. <B>pubk</B> is
an array of <B>npubk</B> public keys.
<P>

The <B>iv</B> parameter is a buffer where the generated <FONT SIZE="-1">IV</FONT> is written to. It must
contain enough room for the corresponding cipher's <FONT SIZE="-1">IV</FONT>, as determined by (for
example) EVP_CIPHER_iv_length(type).
<P>

If the cipher does not require an <FONT SIZE="-1">IV</FONT> then the <B>iv</B> parameter is ignored
and can be <B></B><FONT SIZE="-1"><B>NULL</B></FONT><B></B>.
<P>

<I>EVP_SealUpdate()</I> and <I>EVP_SealFinal()</I> have exactly the same properties
as the <I>EVP_EncryptUpdate()</I> and <I>EVP_EncryptFinal()</I> routines, as 
documented on the <I><A HREF="/man/index.html?3+EVP_EncryptInit">EVP_EncryptInit</A></I>(3) manual
page.
<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUES</H2>

<A NAME="ixAAE"></A>
<I>EVP_SealInit()</I> returns 0 on error or <B>npubk</B> if successful.
<P>

<I>EVP_SealUpdate()</I> and <I>EVP_SealFinal()</I> return 1 for success and 0 for
failure.
<A NAME="lbAF">&nbsp;</A>
<H2>NOTES</H2>

<A NAME="ixAAF"></A>
Because a random secret key is generated the random number generator
must be seeded before calling <I>EVP_SealInit()</I>.
<P>

The public key must be <FONT SIZE="-1">RSA</FONT> because it is the only OpenSSL public key
algorithm that supports key transport.
<P>

Envelope encryption is the usual method of using public key encryption
on large amounts of data, this is because public key encryption is slow
but symmetric encryption is fast. So symmetric encryption is used for
bulk encryption and the small random symmetric key used is transferred
using public key encryption.
<P>

It is possible to call <I>EVP_SealInit()</I> twice in the same way as
<I>EVP_EncryptInit()</I>. The first call should have <B>npubk</B> set to 0
and (after setting any cipher parameters) it should be called again
with <B>type</B> set to <FONT SIZE="-1">NULL</FONT>.
<A NAME="lbAG">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAAG"></A>
<I><A HREF="/man/index.html?3+evp">evp</A></I>(3), <I><A HREF="http://localhost/cgi-bin/man/man2html?3+rand">rand</A></I>(3),
<I><A HREF="/man/index.html?3+EVP_EncryptInit">EVP_EncryptInit</A></I>(3),
<I><A HREF="/man/index.html?3+EVP_OpenInit">EVP_OpenInit</A></I>(3)
<A NAME="lbAH">&nbsp;</A>
<H2>HISTORY</H2>

<A NAME="ixAAH"></A>
<I>EVP_SealFinal()</I> did not return a value before OpenSSL 0.9.7.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">RETURN VALUES</A><DD>
<DT><A HREF="#lbAF">NOTES</A><DD>
<DT><A HREF="#lbAG">SEE ALSO</A><DD>
<DT><A HREF="#lbAH">HISTORY</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/man/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:25 GMT, December 24, 2015
</div></body>
</HTML>
