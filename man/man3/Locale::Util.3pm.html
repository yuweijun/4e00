<!DOCTYPE html>

<HTML><head><TITLE>Manpage of Locale::Util</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/man/index.html">linux man pages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>Locale::Util</H1>
Section: User Contributed Perl Documentation (3)<BR>Updated: 2010-08-21<BR><A HREF="#index">Index</A>
<A HREF="/man/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

Locale::Util - Portable l10n and i10n functions
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAC"></A>


<PRE>
  use Locale::Util;

  my @linguas = parse_http_accept_language $ENV{HTTP_ACCEPT_LANGUAGE};

  my @charsets = parse_http_accept_charset $ENV{HTTP_ACCEPT_CHARSET};

  # Trie to set the locale to Brasilian Portuguese in UTF-8.
  my $set_locale = set_locale LC_ALL, 'pt', 'BR', 'utf-8';

  set_locale_cache $last_cache;
  
  my $cache = get_locale_cache;

  web_set_locale ($ENV{HTTP_ACCEPT_LANGUAGE}, $ENV_ACCEPT_CHARSET);

  web_set_locale (['fr-BE', 'fr', 'it'], ['cp1252', 'utf-8']);

</PRE>


<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>
This module provides portable functions dealing with localization
(l10n) and internationalization(i10n).  It doesn't export anything
by default, you have to specify each function you need in the import
list, or use the fully qualified name.
<P>

The functions here have a focus on web development, although they 
are general enough to have them in the Locale:: namespace.
<P>

This module is considered alpha code.  The interface is not stable.
Please contact the author if you want to use it in production code.
<P>

This module was introduced in libintl-perl 1.17.
<A NAME="lbAE">&nbsp;</A>
<H2>FUNCTIONS</H2>

<A NAME="ixAAE"></A>
<DL COMPACT>
<DT><B>parse_http_accept_language </B><FONT SIZE="-1"><B>STRING</B></FONT><B></B><DD>
<A NAME="ixAAF"></A>
Parses a string as passed in the <FONT SIZE="-1">HTTP</FONT> header ``Accept-Language''.
It returns a list of tokens sorted by the quality value, see <FONT SIZE="-1">RFC</FONT> 2616 
for details.


<P>


Example:


<P>




<PRE>
  parse_http_accept (&quot;fr-fr, fr; q=0.7, de; q=0.3&quot;);

</PRE>




<P>


This means: Give me French for France with a quality value of 1.0
(the maximum).  Otherwise I will take any other French version 
(quality 0.7), German has a quality of 0.3 for me.


<P>


The function will return a list of tokens in the order of their quality
values, in this case ``fr-fr'', ``fr'' and ``de''.


<P>


The function is more forgiving than <FONT SIZE="-1">RFC</FONT> 2616.  It accepts quality
values greater than 1.0 and with more than 3 decimal places.  It
also accepts languages and country names with more than 8 characters.
The language ``*'' is translated into ``C''.
<DT><B>parse_http_accept_charset </B><FONT SIZE="-1"><B>STRING</B></FONT><B></B><DD>
<A NAME="ixAAG"></A>
Parses a string as passed in the <FONT SIZE="-1">HTTP</FONT> header ``Accept-Charset''.
It returns a list of tokens sorted by the quality value, see <FONT SIZE="-1">RFC</FONT> 2616 
for details.


<P>


The special character set ``*'' (means all character sets) will be
translated to the undefined value.
<DT><B>set_locale </B><FONT SIZE="-1"><B>CATEGORY</B></FONT><B>, LANGUAGE[, </B><FONT SIZE="-1"><B>COUNTRY</B></FONT><B>, </B><FONT SIZE="-1"><B>CHARSET</B></FONT><B>]</B><DD>
<A NAME="ixAAH"></A>
Tries to set the user locale by means of <I>POSIX::setlocale()</I>.  The latter
function has the disadvantage, that its second argument (the locale
description string) is completely non-standard and system-dependent.
This function tries its best at guessing the system's notion of a locale
dientifier, with the arguments supplied:
<DL COMPACT><DT><DD>
<DL COMPACT>
<DT><B></B><FONT SIZE="-1"><B>CATEGORY</B></FONT><B></B><DD>
<A NAME="ixAAI"></A>
An integer argument for a valid locale category.  These are the
LC_* constants (<FONT SIZE="-1">LC_ALL</FONT>, <FONT SIZE="-1">LC_CTIME</FONT>, <FONT SIZE="-1">LC_COLLATE</FONT>, ...) defined in both
<I><A HREF="/man/index.html?3pm+Locale::Messages">Locale::Messages</A></I>(3pm) and <FONT SIZE="-1"><I><A HREF="http://localhost/cgi-bin/man/man2html?3pm+POSIX">POSIX</A></I></FONT><I></I>(3pm).
<DT><B></B><FONT SIZE="-1"><B>LANGUAGE</B></FONT><B></B><DD>
<A NAME="ixAAJ"></A>
A 2-letter language identifier as per <FONT SIZE="-1">ISO</FONT> 639.  Case doesn't matter,
but an unchanged version (ie. not lower-cased) of the language you
provided will always be tried to.
<DT><B></B><FONT SIZE="-1"><B>COUNTRY</B></FONT><B></B><DD>
<A NAME="ixAAK"></A>
A 2-letter language identifier as per <FONT SIZE="-1">ISO</FONT> 639.  Case doesn't matter,
but an unchanged version (ie. not lower-cased) of the language you
provided will always be tried to.


<P>


This parameter is optional.  If it is not defined, the function will
try to guess an appropriate country, otherwise leave it to the 
operating system.
<DT><B></B><FONT SIZE="-1"><B>CHARSET</B></FONT><B></B><DD>
<A NAME="ixAAL"></A>
A valid charset name.  Valid means valid!  The charset ``utf8'' is not
valid (it is ``utf-8'').  Charset names that are accepted by the
guessing algorithms in <I><A HREF="/man/index.html?3pm+Encode">Encode</A></I>(3pm) are also not necessarily valid.


<P>


If the parameter is undefined, it is ignored.  It is always ignored
under Windows.
</DL>
</DL>

<DL COMPACT><DT><DD>


<P>


The function tries to approach the desired locale in loops, refining
it on every success.  It will first try to set the language (for 
any country), then try to select the correct language, and finally
try to select the correct charset.


<P>


The return value is false in case of failure, or the return value
of the underlying <I>POSIX::setlocale()</I> call in case of success.


<P>


In array context, the function returns the country name 
that was passed in the successful
call to <I>POSIX::setlocale()</I>.  If this string is equal to the country
name you passed as an argument, you can be reasonably sure that
the settings for this country are really used.  If it is not
equal, the function has taken a guess at the country (it has a list
of ``default'' countries for each language).  It seems that under
Windows, <I>POSIX::setlocale()</I> also succeeds, if you pass a country
name that is actually not supported.  Therefore, the information
is not completely reliable.


<P>


Please note that this function is intended for server processes 
(especially web applications) that need to switch in a portable
way to a certain locale.  It is <B>not</B> the recommended way to set 
the program locale for a regular application.  In a regular application
you should do the following:


<P>




<PRE>
    use POSIX qw (setlocale LC_ALL);
    setlocale LC_ALL, '';

</PRE>




<P>


The empty string as the second argument means, that the system
should switch to the user's default locale.
</DL>

<DT><B>get_locale_cache</B><DD>
<A NAME="ixAAM"></A>
The function <I>set_locale()</I> is potentially expansive, especially when
it fails, because it can try a lot of different combinations, and 
the system may have to load a lot of locale definitions from its
internal database.


<P>


In order to speed up things, results are internally cached in a 
hash, keys are the languages, subkeys countries, subsubkeys the
charsets.  You can get a reference to this hash with <I>get_locale_cache()</I>.


<P>


The function cannot fail.
<DT><B>set_locale_cache </B><FONT SIZE="-1"><B>HASH</B></FONT><B></B><DD>
<A NAME="ixAAN"></A>
Sets the internal cache.  You can either pass a hash or a hash reference.
The function will use this as its cache, discarding its old cache.
This allows you to keep the hash persistent.


<P>


The function cannot fail.
<DT><B>web_set_locale (</B><FONT SIZE="-1"><B>ACCEPT_LANGUAGE</B></FONT><B>, </B><FONT SIZE="-1"><B>ACCEPT_CHARSET</B></FONT><B>, </B><FONT SIZE="-1"><B>CATEGORY</B></FONT><B>, </B><FONT SIZE="-1"><B>AVAILABLE</B></FONT><B>)</B><DD>
<A NAME="ixAAO"></A>
Try to change the locale to the settings described by <FONT SIZE="-1">ACCEPT_LANGUAGE</FONT>
and <FONT SIZE="-1">ACCEPT_CHARSET</FONT>.  For each argument you can either pass a string
as in the corresponding http header, or a reference to an array
of language resp. charset identifiers.


<P>


Currently only the first charset passed is used as an argument.
You are strongly encouraged to pass a hard-coded value here, so
that you have control about your output.


<P>


The argument <B></B><FONT SIZE="-1"><B>CATEGORY</B></FONT><B></B> specifies the category (one of the LC_*
constants as defined in <I><A HREF="/man/index.html?3pm+Locale::Messages">Locale::Messages</A></I>(3pm) or in <FONT SIZE="-1"><I><A HREF="http://localhost/cgi-bin/man/man2html?3pm+POSIX">POSIX</A></I></FONT><I></I>(3pm)).
The category defaults to <FONT SIZE="-1">LC_ALL</FONT>.


<P>


You can pass an optional reference to a list of locales in 
<FONT SIZE="-1">XPG4</FONT> format that are available in your application.  This is
useful if you know which languages are supported by your application.
In fact, only the language part of the values in the list are
considered (for example for ``en_US'', only ``en'' is used).  The
country or other parts are ignored.


<P>


The function returns the return value of the underlying <I>set_locale()</I>
call, or false on failure.


<P>


The function returns false on failure.  On success it returns the 
return value of the underlying <I>set_locale()</I> call.  This value can
be used directly in subsequent calls to <I>POSIX::setlocale()</I>.  In 
array context, it additionally returns the identifiers for the language, 
the country, and the charset actually used.
</DL>
<A NAME="lbAF">&nbsp;</A>
<H2>BUGS</H2>

<A NAME="ixAAP"></A>
The function <I>set_locale()</I> probably fails to guess the correct locale
identifier on a lot of systems.  If you have found such a case,
please submit it as a bug report.
<P>

The bug tracking system for this packags is at
<A HREF="http://rt.cpan.org/NoAuth/Bugs.html?libintl-perl">http://rt.cpan.org/NoAuth/Bugs.html?libintl-perl</A>
<P>

Please note that this module is considered alpha code, and the interface
is not stable.  Please contact the author, if you want to use it in
production code.
<A NAME="lbAG">&nbsp;</A>
<H2>AUTHOR</H2>

<A NAME="ixAAQ"></A>
Copyright (C) 2002-2009, Guido Flohr &lt;<A HREF="mailto:guido@imperia.net">guido@imperia.net</A>&gt;, all
rights reserved.  See the source code for details.
<P>

This software is contributed to the Perl community by Imperia 
(&lt;<A HREF="http://www.imperia.net/">http://www.imperia.net/</A>&gt;).
<A NAME="lbAH">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAAR"></A>
<FONT SIZE="-1"><I><A HREF="/man/index.html?3pm+POSIX">POSIX</A></I></FONT><I></I>(3pm), <I><A HREF="http://localhost/cgi-bin/man/man2html?1+perl">perl</A></I>(1)
<A NAME="lbAI">&nbsp;</A>
<H2>POD ERRORS</H2>

<A NAME="ixAAS"></A>
Hey! <B>The above document had some coding errors, which are explained below:</B>
<DL COMPACT>
<DT>Around line 1207:<DD>
<A NAME="ixAAT"></A>
=cut found outside a pod block.  Skipping to next block.
<P>
</DL>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">FUNCTIONS</A><DD>
<DT><A HREF="#lbAF">BUGS</A><DD>
<DT><A HREF="#lbAG">AUTHOR</A><DD>
<DT><A HREF="#lbAH">SEE ALSO</A><DD>
<DT><A HREF="#lbAI">POD ERRORS</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/man/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:33 GMT, December 24, 2015
</div></body>
</HTML>
