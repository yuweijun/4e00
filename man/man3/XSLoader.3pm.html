<!DOCTYPE html>

<HTML><head><TITLE>Manpage of XSLoader</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/man/index.html">linux man pages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>XSLoader</H1>
Section: Perl Programmers Reference Guide (3pm)<BR>Updated: 2012-06-22<BR><A HREF="#index">Index</A>
<A HREF="/man/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

XSLoader - Dynamically load C libraries into Perl code
<A NAME="lbAC">&nbsp;</A>
<H2>VERSION</H2>

<A NAME="ixAAC"></A>
Version 0.10
<A NAME="lbAD">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAD"></A>


<PRE>
    package YourPackage;
    use XSLoader;

    XSLoader::load 'YourPackage', $YourPackage::VERSION;

</PRE>


<A NAME="lbAE">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAE"></A>
This module defines a standard <I>simplified</I> interface to the dynamic
linking mechanisms available on many platforms.  Its primary purpose is
to implement cheap automatic dynamic loading of Perl modules.
<P>

For a more complicated interface, see DynaLoader.  Many (most)
features of <TT>&quot;DynaLoader&quot;</TT> are not implemented in <TT>&quot;XSLoader&quot;</TT>, like for
example the <TT>&quot;dl_load_flags&quot;</TT>, not honored by <TT>&quot;XSLoader&quot;</TT>.
<A NAME="lbAF">&nbsp;</A>
<H3>Migration from DynaLoader</H3>



<A NAME="ixAAF"></A>
A typical module using DynaLoader starts like this:
<P>



<PRE>
    package YourPackage;
    require DynaLoader;

    our @ISA = qw( OnePackage OtherPackage DynaLoader );
    our $VERSION = '0.01';
    bootstrap YourPackage $VERSION;

</PRE>


<P>

Change this to
<P>



<PRE>
    package YourPackage;
    use XSLoader;

    our @ISA = qw( OnePackage OtherPackage );
    our $VERSION = '0.01';
    XSLoader::load 'YourPackage', $VERSION;

</PRE>


<P>

In other words: replace <TT>&quot;require DynaLoader&quot;</TT> by <TT>&quot;use XSLoader&quot;</TT>, remove
<TT>&quot;DynaLoader&quot;</TT> from <TT>@ISA</TT>, change <TT>&quot;bootstrap&quot;</TT> by <TT>&quot;XSLoader::load&quot;</TT>.  Do not
forget to quote the name of your package on the <TT>&quot;XSLoader::load&quot;</TT> line,
and add comma (<TT>&quot;,&quot;</TT>) before the arguments (<TT>$VERSION</TT> above).
<P>

Of course, if <TT>@ISA</TT> contained only <TT>&quot;DynaLoader&quot;</TT>, there is no need to have
the <TT>@ISA</TT> assignment at all; moreover, if instead of <TT>&quot;our&quot;</TT> one uses the
more backward-compatible
<P>



<PRE>
    use vars qw($VERSION @ISA);

</PRE>


<P>

one can remove this reference to <TT>@ISA</TT> together with the <TT>@ISA</TT> assignment.
<P>

If no <TT>$VERSION</TT> was specified on the <TT>&quot;bootstrap&quot;</TT> line, the last line becomes
<P>



<PRE>
    XSLoader::load 'YourPackage';

</PRE>


<A NAME="lbAG">&nbsp;</A>
<H3>Backward compatible boilerplate</H3>

<A NAME="ixAAG"></A>
If you want to have your cake and eat it too, you need a more complicated
boilerplate.
<P>



<PRE>
    package YourPackage;
    use vars qw($VERSION @ISA);

    @ISA = qw( OnePackage OtherPackage );
    $VERSION = '0.01';
    eval {
       require XSLoader;
       XSLoader::load('YourPackage', $VERSION);
       1;
    } or do {
       require DynaLoader;
       push @ISA, 'DynaLoader';
       bootstrap YourPackage $VERSION;
    };

</PRE>


<P>

The parentheses about <TT>&quot;XSLoader::load()&quot;</TT> arguments are needed since we replaced
<TT>&quot;use XSLoader&quot;</TT> by <TT>&quot;require&quot;</TT>, so the compiler does not know that a function
<TT>&quot;XSLoader::load()&quot;</TT> is present.
<P>

This boilerplate uses the low-overhead <TT>&quot;XSLoader&quot;</TT> if present; if used with
an antic Perl which has no <TT>&quot;XSLoader&quot;</TT>, it falls back to using <TT>&quot;DynaLoader&quot;</TT>.
<A NAME="lbAH">&nbsp;</A>
<H2>Order of initialization: early <I>load()</I></H2>

<A NAME="ixAAH"></A>
<I>Skip this section if the </I><FONT SIZE="-1"><I>XSUB</I></FONT><I> functions are supposed to be called from other
modules only; read it only if you call your XSUBs from the code in your module,
or have a </I>&quot;BOOT:&quot;<I> section in your </I><FONT SIZE="-1"><I>XS</I></FONT><I> file (see ``The </I><FONT SIZE="-1"><I>BOOT:</I></FONT><I> Keyword'' in perlxs).
What is described here is equally applicable to the DynaLoader
interface.</I>
<P>

A sufficiently complicated module using <FONT SIZE="-1">XS</FONT> would have both Perl code (defined
in <I>YourPackage.pm</I>) and <FONT SIZE="-1">XS</FONT> code (defined in <I>YourPackage.xs</I>).  If this
Perl code makes calls into this <FONT SIZE="-1">XS</FONT> code, and/or this <FONT SIZE="-1">XS</FONT> code makes calls to
the Perl code, one should be careful with the order of initialization.
<P>

The call to <TT>&quot;XSLoader::load()&quot;</TT> (or <TT>&quot;bootstrap()&quot;</TT>) has three side effects:
<DL COMPACT>
<DT>*<DD>
if <TT>$VERSION</TT> was specified, a sanity check is done to ensure that the
versions of the <I>.pm</I> and the (compiled) <I>.xs</I> parts are compatible;
<DT>*<DD>
the XSUBs are made accessible from Perl;
<DT>*<DD>
if a <TT>&quot;BOOT:&quot;</TT> section was present in the <I>.xs</I> file, the code there is called.
</DL>
<P>

Consequently, if the code in the <I>.pm</I> file makes calls to these XSUBs, it is
convenient to have XSUBs installed before the Perl code is defined; for
example, this makes prototypes for XSUBs visible to this Perl code.
Alternatively, if the <TT>&quot;BOOT:&quot;</TT> section makes calls to Perl functions (or
uses Perl variables) defined in the <I>.pm</I> file, they must be defined prior to
the call to <TT>&quot;XSLoader::load()&quot;</TT> (or <TT>&quot;bootstrap()&quot;</TT>).
<P>

The first situation being much more frequent, it makes sense to rewrite the
boilerplate as
<P>



<PRE>
    package YourPackage;
    use XSLoader;
    use vars qw($VERSION @ISA);

    BEGIN {
       @ISA = qw( OnePackage OtherPackage );
       $VERSION = '0.01';

       # Put Perl code used in the BOOT: section here

       XSLoader::load 'YourPackage', $VERSION;
    }

    # Put Perl code making calls into XSUBs here

</PRE>


<A NAME="lbAI">&nbsp;</A>
<H3>The most hairy case</H3>

<A NAME="ixAAI"></A>
If the interdependence of your <TT>&quot;BOOT:&quot;</TT> section and Perl code is
more complicated than this (e.g., the <TT>&quot;BOOT:&quot;</TT> section makes calls to Perl
functions which make calls to XSUBs with prototypes), get rid of the <TT>&quot;BOOT:&quot;</TT>
section altogether.  Replace it with a function <TT>&quot;onBOOT()&quot;</TT>, and call it like
this:
<P>



<PRE>
    package YourPackage;
    use XSLoader;
    use vars qw($VERSION @ISA);

    BEGIN {
       @ISA = qw( OnePackage OtherPackage );
       $VERSION = '0.01';
       XSLoader::load 'YourPackage', $VERSION;
    }

    # Put Perl code used in onBOOT() function here; calls to XSUBs are
    # prototype-checked.

    onBOOT;

    # Put Perl initialization code assuming that XS is initialized here

</PRE>


<A NAME="lbAJ">&nbsp;</A>
<H2>DIAGNOSTICS</H2>

<A NAME="ixAAJ"></A>
<DL COMPACT>
<DT>Can't find '%s' symbol in %s<DD>


<A NAME="ixAAK"></A>
<B>(F)</B> The bootstrap symbol could not be found in the extension module.
<DT>Can't load '%s' for module %s: %s<DD>


<A NAME="ixAAL"></A>
<B>(F)</B> The loading or initialisation of the extension module failed.
The detailed error follows.
<DT>Undefined symbols present after loading %s: %s<DD>


<A NAME="ixAAM"></A>
<B>(W)</B> As the message says, some symbols stay undefined although the
extension module was correctly loaded and initialised. The list of undefined
symbols follows.
<DT>XSLoader::load('Your::Module', $Your::Module::VERSION)<DD>


<A NAME="ixAAN"></A>
<B>(F)</B> You tried to invoke <TT>&quot;load()&quot;</TT> without any argument. You must supply
a module name, and optionally its version.
</DL>
<A NAME="lbAK">&nbsp;</A>
<H2>LIMITATIONS</H2>

<A NAME="ixAAO"></A>
To reduce the overhead as much as possible, only one possible location
is checked to find the extension <FONT SIZE="-1">DLL</FONT> (this location is where <TT>&quot;make install&quot;</TT>
would put the <FONT SIZE="-1">DLL</FONT>).  If not found, the search for the <FONT SIZE="-1">DLL</FONT> is transparently
delegated to <TT>&quot;DynaLoader&quot;</TT>, which looks for the <FONT SIZE="-1">DLL</FONT> along the <TT>@INC</TT> list.
<P>

In particular, this is applicable to the structure of <TT>@INC</TT> used for testing
not-yet-installed extensions.  This means that running uninstalled extensions
may have much more overhead than running the same extensions after
<TT>&quot;make install&quot;</TT>.
<A NAME="lbAL">&nbsp;</A>
<H2>BUGS</H2>

<A NAME="ixAAP"></A>
Please report any bugs or feature requests via the <I><A HREF="/man/index.html?1+perlbug">perlbug</A></I>(1) utility.
<A NAME="lbAM">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAAQ"></A>
DynaLoader
<A NAME="lbAN">&nbsp;</A>
<H2>AUTHORS</H2>

<A NAME="ixAAR"></A>
Ilya Zakharevich originally extracted <TT>&quot;XSLoader&quot;</TT> from <TT>&quot;DynaLoader&quot;</TT>.
<P>

<FONT SIZE="-1">CPAN</FONT> version is currently maintained by Sebastien Aperghis-Tramoni
&lt;<A HREF="mailto:sebastien@aperghis.net">sebastien@aperghis.net</A>&gt;.
<P>

Previous maintainer was Michael G Schwern &lt;<A HREF="mailto:schwern@pobox.com">schwern@pobox.com</A>&gt;.
<A NAME="lbAO">&nbsp;</A>
<H2>COPYRIGHT &amp; LICENSE</H2>

<A NAME="ixAAS"></A>
Copyright (C) 1990-2007 by Larry Wall and others.
<P>

This program is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">VERSION</A><DD>
<DT><A HREF="#lbAD">SYNOPSIS</A><DD>
<DT><A HREF="#lbAE">DESCRIPTION</A><DD>
<DL>
<DT><A HREF="#lbAF">Migration from DynaLoader</A><DD>
<DT><A HREF="#lbAG">Backward compatible boilerplate</A><DD>
</DL>
<DT><A HREF="#lbAH">Order of initialization: early <I>load()</I></A><DD>
<DL>
<DT><A HREF="#lbAI">The most hairy case</A><DD>
</DL>
<DT><A HREF="#lbAJ">DIAGNOSTICS</A><DD>
<DT><A HREF="#lbAK">LIMITATIONS</A><DD>
<DT><A HREF="#lbAL">BUGS</A><DD>
<DT><A HREF="#lbAM">SEE ALSO</A><DD>
<DT><A HREF="#lbAN">AUTHORS</A><DD>
<DT><A HREF="#lbAO">COPYRIGHT &amp; LICENSE</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/man/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:46 GMT, December 24, 2015
</div></body>
</HTML>
