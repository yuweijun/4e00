<!DOCTYPE html>

<HTML><head><TITLE>Manpage of X509_VERIFY_PARAM_set_flags</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/man/index.html">linux man pages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>X509_VERIFY_PARAM_set_flags</H1>
Section: OpenSSL (3)<BR>Updated: 2009-10-18<BR><A HREF="#index">Index</A>
<A HREF="/man/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

X509_VERIFY_PARAM_set_flags, X509_VERIFY_PARAM_clear_flags, X509_VERIFY_PARAM_get_flags, X509_VERIFY_PARAM_set_purpose, X509_VERIFY_PARAM_set_trust, X509_VERIFY_PARAM_set_depth, X509_VERIFY_PARAM_get_depth, X509_VERIFY_PARAM_set_time, X509_VERIFY_PARAM_add0_policy, X509_VERIFY_PARAM_set1_policies - X509 verification parameters
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAC"></A>


<PRE>
 #include &lt;<A HREF="file:/usr/include/openssl/x509_vfy.h">openssl/x509_vfy.h</A>&gt;

 int X509_VERIFY_PARAM_set_flags(X509_VERIFY_PARAM *param, unsigned long flags);
 int X509_VERIFY_PARAM_clear_flags(X509_VERIFY_PARAM *param,
                                                        unsigned long flags);
 unsigned long X509_VERIFY_PARAM_get_flags(X509_VERIFY_PARAM *param);

 int X509_VERIFY_PARAM_set_purpose(X509_VERIFY_PARAM *param, int purpose);
 int X509_VERIFY_PARAM_set_trust(X509_VERIFY_PARAM *param, int trust);

 void X509_VERIFY_PARAM_set_time(X509_VERIFY_PARAM *param, time_t t);

 int X509_VERIFY_PARAM_add0_policy(X509_VERIFY_PARAM *param,
                                                ASN1_OBJECT *policy);
 int X509_VERIFY_PARAM_set1_policies(X509_VERIFY_PARAM *param, 
                                        STACK_OF(ASN1_OBJECT) *policies);

 void X509_VERIFY_PARAM_set_depth(X509_VERIFY_PARAM *param, int depth);
 int X509_VERIFY_PARAM_get_depth(const X509_VERIFY_PARAM *param);

</PRE>


<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>
These functions manipulate the <B>X509_VERIFY_PARAM</B> structure associated with
a certificate verification operation.
<P>

The <I>X509_VERIFY_PARAM_set_flags()</I> function sets the flags in <B>param</B> by oring
it with <B>flags</B>. See the <B></B><FONT SIZE="-1"><B>VERIFICATION</B></FONT><B> </B><FONT SIZE="-1"><B>FLAGS</B></FONT><B></B> section for a complete
description of values the <B>flags</B> parameter can take.
<P>

<I>X509_VERIFY_PARAM_get_flags()</I> returns the flags in <B>param</B>.
<P>

<I>X509_VERIFY_PARAM_clear_flags()</I> clears the flags <B>flags</B> in <B>param</B>.
<P>

<I>X509_VERIFY_PARAM_set_purpose()</I> sets the verification purpose in <B>param</B>
to <B>purpose</B>. This determines the acceptable purpose of the certificate
chain, for example <FONT SIZE="-1">SSL</FONT> client or <FONT SIZE="-1">SSL</FONT> server.
<P>

<I>X509_VERIFY_PARAM_set_trust()</I> sets the trust setting in <B>param</B> to 
<B>trust</B>.
<P>

<I>X509_VERIFY_PARAM_set_time()</I> sets the verification time in <B>param</B> to
<B>t</B>. Normally the current time is used.
<P>

<I>X509_VERIFY_PARAM_add0_policy()</I> enables policy checking (it is disabled
by default) and adds <B>policy</B> to the acceptable policy set.
<P>

<I>X509_VERIFY_PARAM_set1_policies()</I> enables policy checking (it is disabled
by default) and sets the acceptable policy set to <B>policies</B>. Any existing
policy set is cleared. The <B>policies</B> parameter can be <B></B><FONT SIZE="-1"><B>NULL</B></FONT><B></B> to clear
an existing policy set.
<P>

<I>X509_VERIFY_PARAM_set_depth()</I> sets the maximum verification depth to <B>depth</B>.
That is the maximum number of untrusted <FONT SIZE="-1">CA</FONT> certificates that can appear in a
chain.
<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUES</H2>

<A NAME="ixAAE"></A>
<I>X509_VERIFY_PARAM_set_flags()</I>, <I>X509_VERIFY_PARAM_clear_flags()</I>, 
<I>X509_VERIFY_PARAM_set_purpose()</I>, <I>X509_VERIFY_PARAM_set_trust()</I>,
<I>X509_VERIFY_PARAM_add0_policy()</I> and <I>X509_VERIFY_PARAM_set1_policies()</I> return 1
for success and 0 for failure.
<P>

<I>X509_VERIFY_PARAM_get_flags()</I> returns the current verification flags.
<P>

<I>X509_VERIFY_PARAM_set_time()</I> and <I>X509_VERIFY_PARAM_set_depth()</I> do not return
values.
<P>

<I>X509_VERIFY_PARAM_get_depth()</I> returns the current verification depth.
<A NAME="lbAF">&nbsp;</A>
<H2>VERIFICATION FLAGS</H2>

<A NAME="ixAAF"></A>
The verification flags consists of zero or more of the following flags
ored together.
<P>

<B>X509_V_FLAG_CRL_CHECK</B> enables <FONT SIZE="-1">CRL</FONT> checking for the certificate chain leaf
certificate. An error occurs if a suitable <FONT SIZE="-1">CRL</FONT> cannot be found.
<P>

<B>X509_V_FLAG_CRL_CHECK_ALL</B> enables <FONT SIZE="-1">CRL</FONT> checking for the entire certificate
chain.
<P>

<B>X509_V_FLAG_IGNORE_CRITICAL</B> disabled critical extension checking. By default
any unhandled critical extensions in certificates or (if checked) CRLs results
in a fatal error. If this flag is set unhandled critical extensions are
ignored. <B></B><FONT SIZE="-1"><B>WARNING</B></FONT><B></B> setting this option for anything other than debugging
purposes can be a security risk. Finer control over which extensions are
supported can be performed in the verification callback.
<P>

THe <B>X509_V_FLAG_X509_STRICT</B> flag disables workarounds for some broken
certificates and makes the verification strictly apply <B>X509</B> rules.
<P>

<B>X509_V_FLAG_ALLOW_PROXY_CERTS</B> enables proxy certificate verification.
<P>

<B>X509_V_FLAG_POLICY_CHECK</B> enables certificate policy checking, by default
no policy checking is peformed. Additional information is sent to the 
verification callback relating to policy checking.
<P>

<B>X509_V_FLAG_EXPLICIT_POLICY</B>, <B>X509_V_FLAG_INHIBIT_ANY</B> and
<B>X509_V_FLAG_INHIBIT_MAP</B> set the <B>require explicit policy</B>, <B>inhibit any
policy</B> and <B>inhibit policy mapping</B> flags respectively as defined in
<B></B><FONT SIZE="-1"><B>RFC3280</B></FONT><B></B>. Policy checking is automatically enabled if any of these flags
are set.
<P>

If <B>X509_V_FLAG_NOTIFY_POLICY</B> is set and the policy checking is successful
a special status code is set to the verification callback. This permits it
to examine the valid policy tree and perform additional checks or simply
log it for debugging purposes.
<P>

By default some addtional features such as indirect CRLs and CRLs signed by
different keys are disabled. If <B>X509_V_FLAG_EXTENDED_CRL_SUPPORT</B> is set
they are enabled.
<P>

If <B>X509_V_FLAG_USE_DELTAS</B> ise set delta CRLs (if present) are used to
determine certificate status. If not set deltas are ignored.
<P>

<B>X509_V_FLAG_CHECK_SS_SIGNATURE</B> enables checking of the root <FONT SIZE="-1">CA</FONT> self signed
cerificate signature. By default this check is disabled because it doesn't
add any additional security but in some cases applications might want to
check the signature anyway. A side effect of not checking the root <FONT SIZE="-1">CA</FONT>
signature is that disabled or unsupported message digests on the root <FONT SIZE="-1">CA</FONT>
are not treated as fatal errors.
<P>

The <B>X509_V_FLAG_CB_ISSUER_CHECK</B> flag enables debugging of certificate
issuer checks. It is <B>not</B> needed unless you are logging certificate
verification. If this flag is set then additional status codes will be sent
to the verification callback and it <B>must</B> be prepared to handle such cases
without assuming they are hard errors.
<A NAME="lbAG">&nbsp;</A>
<H2>NOTES</H2>

<A NAME="ixAAG"></A>
The above functions should be used to manipulate verification parameters
instead of legacy functions which work in specific structures such as
<I>X509_STORE_CTX_set_flags()</I>.
<A NAME="lbAH">&nbsp;</A>
<H2>BUGS</H2>

<A NAME="ixAAH"></A>
Delta <FONT SIZE="-1">CRL</FONT> checking is currently primitive. Only a single delta can be used and
(partly due to limitations of <B>X509_STORE</B>) constructed CRLs are not 
maintained.
<P>

If CRLs checking is enable CRLs are expected to be available in the
corresponding <B>X509_STORE</B> structure. No attempt is made to download
CRLs from the <FONT SIZE="-1">CRL</FONT> distribution points extension.
<A NAME="lbAI">&nbsp;</A>
<H2>EXAMPLE</H2>

<A NAME="ixAAI"></A>
Enable <FONT SIZE="-1">CRL</FONT> checking when performing certificate verification during <FONT SIZE="-1">SSL</FONT> 
connections associated with an <B></B><FONT SIZE="-1"><B>SSL_CTX</B></FONT><B></B> structure <B>ctx</B>:
<P>



<PRE>
  X509_VERIFY_PARAM *param;
  param = X509_VERIFY_PARAM_new();
  X509_VERIFY_PARAM_set_flags(param, X509_V_FLAG_CRL_CHECK);
  SSL_CTX_set1_param(ctx, param);
  X509_VERIFY_PARAM_free(param);

</PRE>


<A NAME="lbAJ">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAAJ"></A>
<I><A HREF="/man/index.html?3+X509_verify_cert">X509_verify_cert</A></I>(3)
<A NAME="lbAK">&nbsp;</A>
<H2>HISTORY</H2>

<A NAME="ixAAK"></A>
<FONT SIZE="-1">TBA</FONT>
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">RETURN VALUES</A><DD>
<DT><A HREF="#lbAF">VERIFICATION FLAGS</A><DD>
<DT><A HREF="#lbAG">NOTES</A><DD>
<DT><A HREF="#lbAH">BUGS</A><DD>
<DT><A HREF="#lbAI">EXAMPLE</A><DD>
<DT><A HREF="#lbAJ">SEE ALSO</A><DD>
<DT><A HREF="#lbAK">HISTORY</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/man/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:45 GMT, December 24, 2015
</div></body>
</HTML>
