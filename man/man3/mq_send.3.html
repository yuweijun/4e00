<!DOCTYPE html>

<HTML><head><TITLE>Manpage of MQ_SEND</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/man/index.html">linux man pages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>MQ_SEND</H1>
Section: Linux Programmer's Manual (3)<BR>Updated: 2008-09-29<BR><A HREF="#index">Index</A>
<A HREF="/man/index.html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

mq_send, mq_timedsend - send a message to a message queue
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<PRE>
<B>#include &lt;<A HREF="file:/usr/include/mqueue.h">mqueue.h</A>&gt;</B>

<B>mqd_t mq_send(mqd_t </B><I>mqdes</I><B>, const char *</B><I>msg_ptr</I><B>,</B>
<B>              size_t </B><I>msg_len</I><B>, unsigned </B><I>msg_prio</I><B>);</B>

<B>#define _XOPEN_SOURCE 600</B>
<B>#include &lt;<A HREF="file:/usr/include/time.h">time.h</A>&gt;</B>
<B>#include &lt;<A HREF="file:/usr/include/mqueue.h">mqueue.h</A>&gt;</B>

<B>mqd_t mq_timedsend(mqd_t </B><I>mqdes</I><B>, const char *</B><I>msg_ptr</I><B>,</B>
<B>              size_t </B><I>msg_len</I><B>, unsigned </B><I>msg_prio</I><B>,</B>
<B>              const struct timespec *</B><I>abs_timeout</I><B>);</B>
</PRE>

<P>
Link with <I>-lrt</I>.
<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<B>mq_send</B>()

adds the message pointed to by
<I>msg_ptr</I>

to the message queue referred to by the descriptor
<I>mqdes</I>.

The
<I>msg_len</I>

argument specifies the length of the message pointed to by
<I>msg_ptr</I>;

this length must be less than or equal to the queue's
<I>mq_msgsize</I>

attribute.
Zero-length messages are allowed.
<P>
The
<I>msg_prio</I>

argument is a non-negative integer that specifies the priority
of this message.
Messages are placed on the queue in decreasing order of priority,
with newer messages of the same priority being placed after
older messages with the same priority.
<P>
If the message queue is already full
(i.e., the number of messages on the queue equals the queue's
<I>mq_maxmsg</I>

attribute), then, by default,
<B>mq_send</B>()

blocks until sufficient space becomes available to allow the message
to be queued, or until the call is interrupted by a signal handler.
If the
<B>O_NONBLOCK</B>

flag is enabled for the message queue description,
then the call instead fails immediately with the error
<B>EAGAIN</B>.

<P>
<B>mq_timedsend</B>()

behaves just like
<B>mq_send</B>(),

except that if the queue is full and the
<B>O_NONBLOCK</B>

flag is not enabled for the message queue description, then
<I>abs_timeout</I>

points to a structure which specifies a ceiling on the time for which
the call will block.
This ceiling is an absolute timeout in seconds and nanoseconds
since the Epoch (midnight on the morning of 1 January 1970),
specified in the following structure:
<P>

<PRE>
struct timespec {
    time_t tv_sec;        /* seconds */
    long   tv_nsec;       /* nanoseconds */
};

</PRE>


If the message queue is full,
and the timeout has already expired by the time of the call,
<B>mq_timedsend</B>()

returns immediately.
<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUE</H2>

On success,
<B>mq_send</B>()

and
<B>mq_timedsend</B>()

return zero; on error, -1 is returned, with
<I>errno</I>

set to indicate the error.
<A NAME="lbAF">&nbsp;</A>
<H2>ERRORS</H2>

<DL COMPACT>
<DT><B>EAGAIN</B>

<DD>
The queue was empty, and the
<B>O_NONBLOCK</B>

flag was set for the message queue description referred to by
<I>mqdes</I>.

<DT><B>EBADF</B>

<DD>
The descriptor specified in
<I>mqdes</I>

was invalid.
<DT><B>EINTR</B>

<DD>
The call was interrupted by a signal handler; see
<B><A HREF="/man/index.html?7+signal">signal</A></B>(7).

<DT><B>EINVAL</B>

<DD>
The call would have blocked, and
<I>abs_timeout</I>

was invalid, either because
<I>tv_sec</I>

was less than zero, or because
<I>tv_nsec</I>

was less than zero or greater than 1000 million.
<DT><B>EMSGSIZE</B>

<DD>
<I>msg_len</I>

was greater than the
<I>mq_msgsize</I>

attribute of the message queue.
<DT><B>ETIMEDOUT</B>

<DD>
The call timed out before a message could be transferred.
</DL>
<A NAME="lbAG">&nbsp;</A>
<H2>CONFORMING TO</H2>

POSIX.1-2001.
<A NAME="lbAH">&nbsp;</A>
<H2>NOTES</H2>

On Linux,
<B>mq_timedsend</B>()

is a system call, and
<B>mq_send</B>()

is a library function layered on top of that system call.
<A NAME="lbAI">&nbsp;</A>
<H2>SEE ALSO</H2>

<B><A HREF="/man/index.html?3+mq_close">mq_close</A></B>(3),

<B><A HREF="/man/index.html?3+mq_getattr">mq_getattr</A></B>(3),

<B><A HREF="/man/index.html?3+mq_notify">mq_notify</A></B>(3),

<B><A HREF="/man/index.html?3+mq_open">mq_open</A></B>(3),

<B><A HREF="/man/index.html?3+mq_receive">mq_receive</A></B>(3),

<B><A HREF="/man/index.html?3+mq_unlink">mq_unlink</A></B>(3),

<B><A HREF="/man/index.html?7+feature_test_macros">feature_test_macros</A></B>(7),

<B><A HREF="/man/index.html?7+mq_overview">mq_overview</A></B>(7),

<B><A HREF="/man/index.html?7+time">time</A></B>(7)

<A NAME="lbAJ">&nbsp;</A>
<H2>COLOPHON</H2>

This page is part of release 3.22 of the Linux
<I>man-pages</I>

project.
A description of the project,
and information about reporting bugs,
can be found at
<A HREF="http://www.kernel.org/doc/man-pages/.">http://www.kernel.org/doc/man-pages/.</A>
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">RETURN VALUE</A><DD>
<DT><A HREF="#lbAF">ERRORS</A><DD>
<DT><A HREF="#lbAG">CONFORMING TO</A><DD>
<DT><A HREF="#lbAH">NOTES</A><DD>
<DT><A HREF="#lbAI">SEE ALSO</A><DD>
<DT><A HREF="#lbAJ">COLOPHON</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/man/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:35 GMT, December 24, 2015
</div></body>
</HTML>
