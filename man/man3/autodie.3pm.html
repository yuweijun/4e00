<!DOCTYPE html>

<HTML><head><TITLE>Manpage of autodie</TITLE>
<meta charset="utf-8">
<link rel="stylesheet" href="/css/main.css" type="text/css">
</head>
<body>
 <header class="site-header">
 <div class="wrap"> <div class="site-title"><a href="/man/index.html">linux man pages</a></div>
 <div class="site-description">{"type":"programming"}</div>
 </div>
 </header>
 <div class="page-content">
<H1>autodie</H1>
Section: Perl Programmers Reference Guide (3pm)<BR>Updated: 2009-07-25<BR><A HREF="#index">Index</A>
<A HREF="/man/index.html">Return to Main Contents</A><HR>






<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

autodie - Replace functions with ones that succeed or die with lexical scope
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<A NAME="ixAAC"></A>


<PRE>
    use autodie;            # Recommended: implies 'use autodie qw(:default)'

    use autodie qw(:all);   # Recommended more: defaults and system/exec.

    use autodie qw(open close);   # open/close succeed or die

    open(my $fh, &quot;&lt;&quot;, $filename); # No need to check!

    {
        no autodie qw(open);          # open failures won't die
        open(my $fh, &quot;&lt;&quot;, $filename); # Could fail silently!
        no autodie;                   # disable all autodies
    }

</PRE>


<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<A NAME="ixAAD"></A>


<PRE>
        bIlujDI' yIchegh()Qo'; yIHegh()!

        It is better to die() than to return() in failure.

                -- Klingon programming proverb.

</PRE>


<P>

The <TT>&quot;autodie&quot;</TT> pragma provides a convenient way to replace functions
that normally return false on failure with equivalents that throw
an exception on failure.
<P>

The <TT>&quot;autodie&quot;</TT> pragma has <I>lexical scope</I>, meaning that functions
and subroutines altered with <TT>&quot;autodie&quot;</TT> will only change their behaviour
until the end of the enclosing block, file, or <TT>&quot;eval&quot;</TT>.
<P>

If <TT>&quot;system&quot;</TT> is specified as an argument to <TT>&quot;autodie&quot;</TT>, then it
uses IPC::System::Simple to do the heavy lifting.  See the
description of that module for more information.
<A NAME="lbAE">&nbsp;</A>
<H2>EXCEPTIONS</H2>

<A NAME="ixAAE"></A>
Exceptions produced by the <TT>&quot;autodie&quot;</TT> pragma are members of the
autodie::exception class.  The preferred way to work with
these exceptions under Perl 5.10 is as follows:
<P>



<PRE>
    use feature qw(switch);

    eval {
        use autodie;

        open(my $fh, '&lt;', $some_file);

        my @records = &lt;$fh&gt;;

        # Do things with @records...

        close($fh);

    };

    given ($@) {
        when (undef)   { say &quot;No error&quot;;                    }
        when ('open')  { say &quot;Error from open&quot;;             }
        when (':io')   { say &quot;Non-open, IO error.&quot;;         }
        when (':all')  { say &quot;All other autodie errors.&quot;    }
        default        { say &quot;Not an autodie error at all.&quot; }
    }

</PRE>


<P>

Under Perl 5.8, the <TT>&quot;given/when&quot;</TT> structure is not available, so the
following structure may be used:
<P>



<PRE>
    eval {
        use autodie;

        open(my $fh, '&lt;', $some_file);

        my @records = &lt;$fh&gt;;

        # Do things with @records...

        close($fh);
    };

    if ($@ and $@-&gt;isa('autodie::exception')) {
        if ($@-&gt;matches('open')) { print &quot;Error from open\n&quot;;   }
        if ($@-&gt;matches(':io' )) { print &quot;Non-open, IO error.&quot;; }
    } elsif ($@) {
        # A non-autodie exception.
    }

</PRE>


<P>

See autodie::exception for further information on interrogating
exceptions.
<A NAME="lbAF">&nbsp;</A>
<H2>CATEGORIES</H2>

<A NAME="ixAAF"></A>
Autodie uses a simple set of categories to group together similar
built-ins.  Requesting a category type (starting with a colon) will
enable autodie for all built-ins beneath that category.  For example,
requesting <TT>&quot;:file&quot;</TT> will enable autodie for <TT>&quot;close&quot;</TT>, <TT>&quot;fcntl&quot;</TT>,
<TT>&quot;fileno&quot;</TT>, <TT>&quot;open&quot;</TT> and <TT>&quot;sysopen&quot;</TT>.
<P>

The categories are currently:
<P>



<PRE>
    :all
        :default
            :io
                read
                seek
                sysread
                sysseek
                syswrite
                :dbm
                    dbmclose
                    dbmopen
                :file
                    binmode
                    close
                    fcntl
                    fileno
                    flock
                    ioctl
                    open
                    sysopen
                    truncate
                :filesys
                    chdir
                    closedir
                    opendir
                    link
                    mkdir
                    readlink
                    rename
                    rmdir
                    symlink
                    unlink
                :ipc
                    pipe
                    :msg
                        msgctl
                        msgget
                        msgrcv
                        msgsnd
                    :semaphore
                        semctl
                        semget
                        semop
                    :shm
                        shmctl
                        shmget
                        shmread
                :socket
                    accept
                    bind
                    connect
                    getsockopt
                    listen
                    recv
                    send
                    setsockopt
                    shutdown
                    socketpair
            :threads
                fork
        :system
            system
            exec

</PRE>


<P>

Note that while the above category system is presently a strict
hierarchy, this should not be assumed.
<P>

A plain <TT>&quot;use autodie&quot;</TT> implies <TT>&quot;use autodie qw(:default)&quot;</TT>.  Note that
<TT>&quot;system&quot;</TT> and <TT>&quot;exec&quot;</TT> are not enabled by default.  <TT>&quot;system&quot;</TT> requires
the optional IPC::System::Simple module to be installed, and enabling
<TT>&quot;system&quot;</TT> or <TT>&quot;exec&quot;</TT> will invalidate their exotic forms.  See ``<FONT SIZE="-1">BUGS</FONT>''
below for more details.
<P>

The syntax:
<P>



<PRE>
    use autodie qw(:1.994);

</PRE>


<P>

allows the <TT>&quot;:default&quot;</TT> list from a particular version to be used.  This
provides the convenience of using the default methods, but the surety
that no behavorial changes will occur if the <TT>&quot;autodie&quot;</TT> module is
upgraded.
<P>

<TT>&quot;autodie&quot;</TT> can be enabled for all of Perl's built-ins, including
<TT>&quot;system&quot;</TT> and <TT>&quot;exec&quot;</TT> with:
<P>



<PRE>
    use autodie qw(:all);

</PRE>


<A NAME="lbAG">&nbsp;</A>
<H2>FUNCTION SPECIFIC NOTES</H2>

<A NAME="ixAAG"></A>
<A NAME="lbAH">&nbsp;</A>
<H3>flock</H3>

<A NAME="ixAAH"></A>
It is not considered an error for <TT>&quot;flock&quot;</TT> to return false if it fails
to an <TT>&quot;EWOULDBLOCK&quot;</TT> (or equivalent) condition.  This means one can
still use the common convention of testing the return value of
<TT>&quot;flock&quot;</TT> when called with the <TT>&quot;LOCK_NB&quot;</TT> option:
<P>



<PRE>
    use autodie;

    if ( flock($fh, LOCK_EX | LOCK_NB) ) {
        # We have a lock
    }

</PRE>


<P>

Autodying <TT>&quot;flock&quot;</TT> will generate an exception if <TT>&quot;flock&quot;</TT> returns
false with any other error.
<A NAME="lbAI">&nbsp;</A>
<H3>system/exec</H3>

<A NAME="ixAAI"></A>
The <TT>&quot;system&quot;</TT> built-in is considered to have failed in the following
circumstances:
<DL COMPACT>
<DT>*<DD>
The command does not start.
<DT>*<DD>
The command is killed by a signal.
<DT>*<DD>
The command returns a non-zero exit value (but see below).
</DL>
<P>

On success, the autodying form of <TT>&quot;system&quot;</TT> returns the <I>exit value</I>
rather than the contents of <TT>$?</TT>.
<P>

Additional allowable exit values can be supplied as an optional first
argument to autodying <TT>&quot;system&quot;</TT>:
<P>



<PRE>
    system( [ 0, 1, 2 ], $cmd, @args);  # 0,1,2 are good exit values

</PRE>


<P>

<TT>&quot;autodie&quot;</TT> uses the IPC::System::Simple module to change <TT>&quot;system&quot;</TT>.
See its documentation for further information.
<P>

Applying <TT>&quot;autodie&quot;</TT> to <TT>&quot;system&quot;</TT> or <TT>&quot;exec&quot;</TT> causes the exotic
forms <TT>&quot;system { $cmd } @args &quot;</TT> or <TT>&quot;exec { $cmd } @args&quot;</TT>
to be considered a syntax error until the end of the lexical scope.
If you really need to use the exotic form, you can call <TT>&quot;CORE::system&quot;</TT>
or <TT>&quot;CORE::exec&quot;</TT> instead, or use <TT>&quot;no autodie qw(system exec)&quot;</TT> before
calling the exotic form.
<A NAME="lbAJ">&nbsp;</A>
<H2>GOTCHAS</H2>

<A NAME="ixAAJ"></A>
Functions called in list context are assumed to have failed if they
return an empty list, or a list consisting only of a single undef
element.
<A NAME="lbAK">&nbsp;</A>
<H2>DIAGNOSTICS</H2>

<A NAME="ixAAK"></A>
<DL COMPACT>
<DT>:void cannot be used with lexical scope<DD>
<A NAME="ixAAL"></A>
The <TT>&quot;:void&quot;</TT> option is supported in Fatal, but not
<TT>&quot;autodie&quot;</TT>.  To workaround this, <TT>&quot;autodie&quot;</TT> may be explicitly disabled until
the end of the current block with <TT>&quot;no autodie&quot;</TT>.
To disable autodie for only a single function (eg, open)
use <TT>&quot;no autodie qw(open)&quot;</TT>.
<DT>No user hints defined for %s<DD>


<A NAME="ixAAM"></A>
You've insisted on hints for user-subroutines, either by pre-pending
a <TT>&quot;!&quot;</TT> to the subroutine name itself, or earlier in the list of arguments
to <TT>&quot;autodie&quot;</TT>.  However the subroutine in question does not have
any hints available.
</DL>
<P>

See also ``<FONT SIZE="-1">DIAGNOSTICS</FONT>'' in Fatal.
<A NAME="lbAL">&nbsp;</A>
<H2>BUGS</H2>

<A NAME="ixAAN"></A>
``Used only once'' warnings can be generated when <TT>&quot;autodie&quot;</TT> or <TT>&quot;Fatal&quot;</TT>
is used with package filehandles (eg, <TT>&quot;FILE&quot;</TT>).  Scalar filehandles are
strongly recommended instead.
<P>

When using <TT>&quot;autodie&quot;</TT> or <TT>&quot;Fatal&quot;</TT> with user subroutines, the
declaration of those subroutines must appear before the first use of
<TT>&quot;Fatal&quot;</TT> or <TT>&quot;autodie&quot;</TT>, or have been exported from a module.
Attempting to use <TT>&quot;Fatal&quot;</TT> or <TT>&quot;autodie&quot;</TT> on other user subroutines will
result in a compile-time error.
<P>

Due to a bug in Perl, <TT>&quot;autodie&quot;</TT> may ``lose'' any format which has the
same name as an autodying built-in or function.
<P>

<TT>&quot;autodie&quot;</TT> may not work correctly if used inside a file with a
name that looks like a string eval, such as <I>eval (3)</I>.
<A NAME="lbAM">&nbsp;</A>
<H3>autodie and string eval</H3>

<A NAME="ixAAO"></A>
Due to the current implementation of <TT>&quot;autodie&quot;</TT>, unexpected results
may be seen when used near or with the string version of eval.
<I>None of these bugs exist when using block eval</I>.
<P>

Under Perl 5.8 only, <TT>&quot;autodie&quot;</TT> <I>does not</I> propagate into string <TT>&quot;eval&quot;</TT>
statements, although it can be explicitly enabled inside a string
<TT>&quot;eval&quot;</TT>.
<P>

Under Perl 5.10 only, using a string eval when <TT>&quot;autodie&quot;</TT> is in
effect can cause the autodie behaviour to leak into the surrounding
scope.  This can be worked around by using a <TT>&quot;no autodie&quot;</TT> at the
end of the scope to explicitly remove autodie's effects, or by
avoiding the use of string eval.
<P>

<I>None of these bugs exist when using block eval</I>.  The use of
<TT>&quot;autodie&quot;</TT> with block eval is considered good practice.
<A NAME="lbAN">&nbsp;</A>
<H3><FONT SIZE="-1">REPORTING</FONT> <FONT SIZE="-1">BUGS</FONT></H3>

<A NAME="ixAAP"></A>
Please report bugs via the <FONT SIZE="-1">CPAN</FONT> Request Tracker at
&lt;<A HREF="http://rt.cpan.org/NoAuth/Bugs.html?Dist=autodie">http://rt.cpan.org/NoAuth/Bugs.html?Dist=autodie</A>&gt;.
<A NAME="lbAO">&nbsp;</A>
<H2>FEEDBACK</H2>

<A NAME="ixAAQ"></A>
If you find this module useful, please consider rating it on the
<FONT SIZE="-1">CPAN</FONT> Ratings service at
&lt;<A HREF="http://cpanratings.perl.org/rate?distribution=autodie">http://cpanratings.perl.org/rate?distribution=autodie</A>&gt; .
<P>

The module author loves to hear how <TT>&quot;autodie&quot;</TT> has made your life
better (or worse).  Feedback can be sent to
&lt;<A HREF="mailto:pjf@perltraining.com.au">pjf@perltraining.com.au</A>&gt;.
<A NAME="lbAP">&nbsp;</A>
<H2>AUTHOR</H2>

<A NAME="ixAAR"></A>
Copyright 2008-2009, Paul Fenwick &lt;<A HREF="mailto:pjf@perltraining.com.au">pjf@perltraining.com.au</A>&gt;
<A NAME="lbAQ">&nbsp;</A>
<H2>LICENSE</H2>

<A NAME="ixAAS"></A>
This module is free software.  You may distribute it under the
same terms as Perl itself.
<A NAME="lbAR">&nbsp;</A>
<H2>SEE ALSO</H2>

<A NAME="ixAAT"></A>
Fatal, autodie::exception, autodie::hints, IPC::System::Simple
<P>

<I>Perl tips, autodie</I> at
&lt;<A HREF="http://perltraining.com.au/tips/2008-08-20.html">http://perltraining.com.au/tips/2008-08-20.html</A>&gt;
<A NAME="lbAS">&nbsp;</A>
<H2>ACKNOWLEDGEMENTS</H2>

<A NAME="ixAAU"></A>
Mark Reed and Roland Giersig --- Klingon translators.
<P>

See the <I></I><FONT SIZE="-1"><I>AUTHORS</I></FONT><I></I> file for full credits.  The latest version of this
file can be found at
&lt;<A HREF="http://github.com/pfenwick/autodie/tree/master/AUTHORS">http://github.com/pfenwick/autodie/tree/master/AUTHORS</A>&gt; .
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">EXCEPTIONS</A><DD>
<DT><A HREF="#lbAF">CATEGORIES</A><DD>
<DT><A HREF="#lbAG">FUNCTION SPECIFIC NOTES</A><DD>
<DL>
<DT><A HREF="#lbAH">flock</A><DD>
<DT><A HREF="#lbAI">system/exec</A><DD>
</DL>
<DT><A HREF="#lbAJ">GOTCHAS</A><DD>
<DT><A HREF="#lbAK">DIAGNOSTICS</A><DD>
<DT><A HREF="#lbAL">BUGS</A><DD>
<DL>
<DT><A HREF="#lbAM">autodie and string eval</A><DD>
<DT><A HREF="#lbAN"><FONT SIZE="-1">REPORTING</FONT> <FONT SIZE="-1">BUGS</FONT></A><DD>
</DL>
<DT><A HREF="#lbAO">FEEDBACK</A><DD>
<DT><A HREF="#lbAP">AUTHOR</A><DD>
<DT><A HREF="#lbAQ">LICENSE</A><DD>
<DT><A HREF="#lbAR">SEE ALSO</A><DD>
<DT><A HREF="#lbAS">ACKNOWLEDGEMENTS</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/man/index.html">man2html</A>,
using the manual pages.<BR>
Time: 05:33:12 GMT, December 24, 2015
</div></body>
</HTML>
